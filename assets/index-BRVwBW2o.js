function gD(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function _D(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aA={exports:{}},Hh={},lA={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zu=Symbol.for("react.element"),yD=Symbol.for("react.portal"),vD=Symbol.for("react.fragment"),ED=Symbol.for("react.strict_mode"),TD=Symbol.for("react.profiler"),wD=Symbol.for("react.provider"),ID=Symbol.for("react.context"),SD=Symbol.for("react.forward_ref"),AD=Symbol.for("react.suspense"),CD=Symbol.for("react.memo"),RD=Symbol.for("react.lazy"),oT=Symbol.iterator;function xD(t){return t===null||typeof t!="object"?null:(t=oT&&t[oT]||t["@@iterator"],typeof t=="function"?t:null)}var uA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cA=Object.assign,dA={};function Va(t,e,n){this.props=t,this.context=e,this.refs=dA,this.updater=n||uA}Va.prototype.isReactComponent={};Va.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Va.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function hA(){}hA.prototype=Va.prototype;function m_(t,e,n){this.props=t,this.context=e,this.refs=dA,this.updater=n||uA}var g_=m_.prototype=new hA;g_.constructor=m_;cA(g_,Va.prototype);g_.isPureReactComponent=!0;var aT=Array.isArray,fA=Object.prototype.hasOwnProperty,__={current:null},pA={key:!0,ref:!0,__self:!0,__source:!0};function mA(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)fA.call(e,r)&&!pA.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Zu,type:t,key:s,ref:o,props:i,_owner:__.current}}function PD(t,e){return{$$typeof:Zu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function y_(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zu}function ND(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var lT=/\/+/g;function Sp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ND(""+t.key):e.toString(36)}function yd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Zu:case yD:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Sp(o,0):r,aT(i)?(n="",t!=null&&(n=t.replace(lT,"$&/")+"/"),yd(i,e,n,"",function(u){return u})):i!=null&&(y_(i)&&(i=PD(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(lT,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",aT(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Sp(s,a);o+=yd(s,e,n,l,i)}else if(l=xD(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Sp(s,a++),o+=yd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Bc(t,e,n){if(t==null)return t;var r=[],i=0;return yd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function bD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ln={current:null},vd={transition:null},kD={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:vd,ReactCurrentOwner:__};function gA(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:Bc,forEach:function(t,e,n){Bc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bc(t,function(){e++}),e},toArray:function(t){return Bc(t,function(e){return e})||[]},only:function(t){if(!y_(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=Va;he.Fragment=vD;he.Profiler=TD;he.PureComponent=m_;he.StrictMode=ED;he.Suspense=AD;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kD;he.act=gA;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cA({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=__.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)fA.call(e,l)&&!pA.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Zu,type:t.type,key:i,ref:s,props:r,_owner:o}};he.createContext=function(t){return t={$$typeof:ID,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:wD,_context:t},t.Consumer=t};he.createElement=mA;he.createFactory=function(t){var e=mA.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:SD,render:t}};he.isValidElement=y_;he.lazy=function(t){return{$$typeof:RD,_payload:{_status:-1,_result:t},_init:bD}};he.memo=function(t,e){return{$$typeof:CD,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=vd.transition;vd.transition={};try{t()}finally{vd.transition=e}};he.unstable_act=gA;he.useCallback=function(t,e){return ln.current.useCallback(t,e)};he.useContext=function(t){return ln.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return ln.current.useDeferredValue(t)};he.useEffect=function(t,e){return ln.current.useEffect(t,e)};he.useId=function(){return ln.current.useId()};he.useImperativeHandle=function(t,e,n){return ln.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return ln.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return ln.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return ln.current.useMemo(t,e)};he.useReducer=function(t,e,n){return ln.current.useReducer(t,e,n)};he.useRef=function(t){return ln.current.useRef(t)};he.useState=function(t){return ln.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return ln.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return ln.current.useTransition()};he.version="18.3.1";lA.exports=he;var O=lA.exports;const _A=_D(O),DD=gD({__proto__:null,default:_A},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MD=O,VD=Symbol.for("react.element"),LD=Symbol.for("react.fragment"),UD=Object.prototype.hasOwnProperty,FD=MD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,OD={key:!0,ref:!0,__self:!0,__source:!0};function yA(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)UD.call(e,r)&&!OD.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:VD,type:t,key:s,ref:o,props:i,_owner:FD.current}}Hh.Fragment=LD;Hh.jsx=yA;Hh.jsxs=yA;aA.exports=Hh;var y=aA.exports,vm={},vA={exports:{}},bn={},EA={exports:{}},TA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,ie){var se=Q.length;Q.push(ie);e:for(;0<se;){var Ce=se-1>>>1,Ee=Q[Ce];if(0<i(Ee,ie))Q[Ce]=ie,Q[se]=Ee,se=Ce;else break e}}function n(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var ie=Q[0],se=Q.pop();if(se!==ie){Q[0]=se;e:for(var Ce=0,Ee=Q.length,Pe=Ee>>>1;Ce<Pe;){var cn=2*(Ce+1)-1,Kt=Q[cn],ee=cn+1,ue=Q[ee];if(0>i(Kt,se))ee<Ee&&0>i(ue,Kt)?(Q[Ce]=ue,Q[ee]=se,Ce=ee):(Q[Ce]=Kt,Q[cn]=se,Ce=cn);else if(ee<Ee&&0>i(ue,se))Q[Ce]=ue,Q[ee]=se,Ce=ee;else break e}}return ie}function i(Q,ie){var se=Q.sortIndex-ie.sortIndex;return se!==0?se:Q.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,p=null,m=3,_=!1,E=!1,C=!1,A=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Q){for(var ie=n(u);ie!==null;){if(ie.callback===null)r(u);else if(ie.startTime<=Q)r(u),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=n(u)}}function D(Q){if(C=!1,S(Q),!E)if(n(l)!==null)E=!0,dt(L);else{var ie=n(u);ie!==null&&At(D,ie.startTime-Q)}}function L(Q,ie){E=!1,C&&(C=!1,w(I),I=-1),_=!0;var se=m;try{for(S(ie),p=n(l);p!==null&&(!(p.expirationTime>ie)||Q&&!k());){var Ce=p.callback;if(typeof Ce=="function"){p.callback=null,m=p.priorityLevel;var Ee=Ce(p.expirationTime<=ie);ie=t.unstable_now(),typeof Ee=="function"?p.callback=Ee:p===n(l)&&r(l),S(ie)}else r(l);p=n(l)}if(p!==null)var Pe=!0;else{var cn=n(u);cn!==null&&At(D,cn.startTime-ie),Pe=!1}return Pe}finally{p=null,m=se,_=!1}}var M=!1,R=null,I=-1,P=5,N=-1;function k(){return!(t.unstable_now()-N<P)}function V(){if(R!==null){var Q=t.unstable_now();N=Q;var ie=!0;try{ie=R(!0,Q)}finally{ie?b():(M=!1,R=null)}}else M=!1}var b;if(typeof T=="function")b=function(){T(V)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,Mt=Te.port2;Te.port1.onmessage=V,b=function(){Mt.postMessage(null)}}else b=function(){A(V,0)};function dt(Q){R=Q,M||(M=!0,b())}function At(Q,ie){I=A(function(){Q(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){E||_||(E=!0,dt(L))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Q){switch(m){case 1:case 2:case 3:var ie=3;break;default:ie=m}var se=m;m=ie;try{return Q()}finally{m=se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,ie){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var se=m;m=Q;try{return ie()}finally{m=se}},t.unstable_scheduleCallback=function(Q,ie,se){var Ce=t.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?Ce+se:Ce):se=Ce,Q){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=se+Ee,Q={id:d++,callback:ie,priorityLevel:Q,startTime:se,expirationTime:Ee,sortIndex:-1},se>Ce?(Q.sortIndex=se,e(u,Q),n(l)===null&&Q===n(u)&&(C?(w(I),I=-1):C=!0,At(D,se-Ce))):(Q.sortIndex=Ee,e(l,Q),E||_||(E=!0,dt(L))),Q},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(Q){var ie=m;return function(){var se=m;m=ie;try{return Q.apply(this,arguments)}finally{m=se}}}})(TA);EA.exports=TA;var BD=EA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qD=O,Pn=BD;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wA=new Set,du={};function ro(t,e){ca(t,e),ca(t+"Capture",e)}function ca(t,e){for(du[t]=e,t=0;t<e.length;t++)wA.add(e[t])}var $r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Em=Object.prototype.hasOwnProperty,GD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uT={},cT={};function $D(t){return Em.call(cT,t)?!0:Em.call(uT,t)?!1:GD.test(t)?cT[t]=!0:(uT[t]=!0,!1)}function HD(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zD(t,e,n,r){if(e===null||typeof e>"u"||HD(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kt[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kt[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kt[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kt[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kt[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kt[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kt[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kt[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kt[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var v_=/[\-:]([a-z])/g;function E_(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(v_,E_);kt[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(v_,E_);kt[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(v_,E_);kt[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kt[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});kt.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kt[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function T_(t,e,n,r){var i=kt.hasOwnProperty(e)?kt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zD(e,n,i,r)&&(n=null),r||i===null?$D(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Zr=qD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qc=Symbol.for("react.element"),Mo=Symbol.for("react.portal"),Vo=Symbol.for("react.fragment"),w_=Symbol.for("react.strict_mode"),Tm=Symbol.for("react.profiler"),IA=Symbol.for("react.provider"),SA=Symbol.for("react.context"),I_=Symbol.for("react.forward_ref"),wm=Symbol.for("react.suspense"),Im=Symbol.for("react.suspense_list"),S_=Symbol.for("react.memo"),yi=Symbol.for("react.lazy"),AA=Symbol.for("react.offscreen"),dT=Symbol.iterator;function ml(t){return t===null||typeof t!="object"?null:(t=dT&&t[dT]||t["@@iterator"],typeof t=="function"?t:null)}var We=Object.assign,Ap;function Ml(t){if(Ap===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ap=e&&e[1]||""}return`
`+Ap+t}var Cp=!1;function Rp(t,e){if(!t||Cp)return"";Cp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Cp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ml(t):""}function WD(t){switch(t.tag){case 5:return Ml(t.type);case 16:return Ml("Lazy");case 13:return Ml("Suspense");case 19:return Ml("SuspenseList");case 0:case 2:case 15:return t=Rp(t.type,!1),t;case 11:return t=Rp(t.type.render,!1),t;case 1:return t=Rp(t.type,!0),t;default:return""}}function Sm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vo:return"Fragment";case Mo:return"Portal";case Tm:return"Profiler";case w_:return"StrictMode";case wm:return"Suspense";case Im:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case SA:return(t.displayName||"Context")+".Consumer";case IA:return(t._context.displayName||"Context")+".Provider";case I_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case S_:return e=t.displayName||null,e!==null?e:Sm(t.type)||"Memo";case yi:e=t._payload,t=t._init;try{return Sm(t(e))}catch{}}return null}function KD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sm(e);case 8:return e===w_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function CA(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function JD(t){var e=CA(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Gc(t){t._valueTracker||(t._valueTracker=JD(t))}function RA(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=CA(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Hd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Am(t,e){var n=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function hT(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=qi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xA(t,e){e=e.checked,e!=null&&T_(t,"checked",e,!1)}function Cm(t,e){xA(t,e);var n=qi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rm(t,e.type,qi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function fT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Rm(t,e,n){(e!=="number"||Hd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Vl=Array.isArray;function jo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+qi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function pT(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(Vl(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:qi(n)}}function PA(t,e){var n=qi(e.value),r=qi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function mT(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function NA(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?NA(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $c,bA=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($c=$c||document.createElement("div"),$c.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$c.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Wl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jD=["Webkit","ms","Moz","O"];Object.keys(Wl).forEach(function(t){jD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wl[e]=Wl[t]})});function kA(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Wl.hasOwnProperty(t)&&Wl[t]?(""+e).trim():e+"px"}function DA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=kA(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var QD=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nm(t,e){if(e){if(QD[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function bm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var km=null;function A_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dm=null,Qo=null,Yo=null;function gT(t){if(t=nc(t)){if(typeof Dm!="function")throw Error(z(280));var e=t.stateNode;e&&(e=jh(e),Dm(t.stateNode,t.type,e))}}function MA(t){Qo?Yo?Yo.push(t):Yo=[t]:Qo=t}function VA(){if(Qo){var t=Qo,e=Yo;if(Yo=Qo=null,gT(t),e)for(t=0;t<e.length;t++)gT(e[t])}}function LA(t,e){return t(e)}function UA(){}var xp=!1;function FA(t,e,n){if(xp)return t(e,n);xp=!0;try{return LA(t,e,n)}finally{xp=!1,(Qo!==null||Yo!==null)&&(UA(),VA())}}function fu(t,e){var n=t.stateNode;if(n===null)return null;var r=jh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var Mm=!1;if($r)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){Mm=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{Mm=!1}function YD(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Kl=!1,zd=null,Wd=!1,Vm=null,XD={onError:function(t){Kl=!0,zd=t}};function ZD(t,e,n,r,i,s,o,a,l){Kl=!1,zd=null,YD.apply(XD,arguments)}function eM(t,e,n,r,i,s,o,a,l){if(ZD.apply(this,arguments),Kl){if(Kl){var u=zd;Kl=!1,zd=null}else throw Error(z(198));Wd||(Wd=!0,Vm=u)}}function io(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function OA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _T(t){if(io(t)!==t)throw Error(z(188))}function tM(t){var e=t.alternate;if(!e){if(e=io(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return _T(i),t;if(s===r)return _T(i),e;s=s.sibling}throw Error(z(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function BA(t){return t=tM(t),t!==null?qA(t):null}function qA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qA(t);if(e!==null)return e;t=t.sibling}return null}var GA=Pn.unstable_scheduleCallback,yT=Pn.unstable_cancelCallback,nM=Pn.unstable_shouldYield,rM=Pn.unstable_requestPaint,nt=Pn.unstable_now,iM=Pn.unstable_getCurrentPriorityLevel,C_=Pn.unstable_ImmediatePriority,$A=Pn.unstable_UserBlockingPriority,Kd=Pn.unstable_NormalPriority,sM=Pn.unstable_LowPriority,HA=Pn.unstable_IdlePriority,zh=null,Er=null;function oM(t){if(Er&&typeof Er.onCommitFiberRoot=="function")try{Er.onCommitFiberRoot(zh,t,void 0,(t.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:uM,aM=Math.log,lM=Math.LN2;function uM(t){return t>>>=0,t===0?32:31-(aM(t)/lM|0)|0}var Hc=64,zc=4194304;function Ll(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Jd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ll(a):(s&=o,s!==0&&(r=Ll(s)))}else o=n&~i,o!==0?r=Ll(o):s!==0&&(r=Ll(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-er(e),i=1<<n,r|=t[n],e&=~i;return r}function cM(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dM(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-er(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=cM(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Lm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function zA(){var t=Hc;return Hc<<=1,!(Hc&4194240)&&(Hc=64),t}function Pp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ec(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-er(e),t[e]=n}function hM(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-er(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function R_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-er(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Se=0;function WA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var KA,x_,JA,jA,QA,Um=!1,Wc=[],Ni=null,bi=null,ki=null,pu=new Map,mu=new Map,Ei=[],fM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vT(t,e){switch(t){case"focusin":case"focusout":Ni=null;break;case"dragenter":case"dragleave":bi=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":pu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":mu.delete(e.pointerId)}}function _l(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=nc(e),e!==null&&x_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function pM(t,e,n,r,i){switch(e){case"focusin":return Ni=_l(Ni,t,e,n,r,i),!0;case"dragenter":return bi=_l(bi,t,e,n,r,i),!0;case"mouseover":return ki=_l(ki,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return pu.set(s,_l(pu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,mu.set(s,_l(mu.get(s)||null,t,e,n,r,i)),!0}return!1}function YA(t){var e=Rs(t.target);if(e!==null){var n=io(e);if(n!==null){if(e=n.tag,e===13){if(e=OA(n),e!==null){t.blockedOn=e,QA(t.priority,function(){JA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ed(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);km=r,n.target.dispatchEvent(r),km=null}else return e=nc(n),e!==null&&x_(e),t.blockedOn=n,!1;e.shift()}return!0}function ET(t,e,n){Ed(t)&&n.delete(e)}function mM(){Um=!1,Ni!==null&&Ed(Ni)&&(Ni=null),bi!==null&&Ed(bi)&&(bi=null),ki!==null&&Ed(ki)&&(ki=null),pu.forEach(ET),mu.forEach(ET)}function yl(t,e){t.blockedOn===e&&(t.blockedOn=null,Um||(Um=!0,Pn.unstable_scheduleCallback(Pn.unstable_NormalPriority,mM)))}function gu(t){function e(i){return yl(i,t)}if(0<Wc.length){yl(Wc[0],t);for(var n=1;n<Wc.length;n++){var r=Wc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ni!==null&&yl(Ni,t),bi!==null&&yl(bi,t),ki!==null&&yl(ki,t),pu.forEach(e),mu.forEach(e),n=0;n<Ei.length;n++)r=Ei[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ei.length&&(n=Ei[0],n.blockedOn===null);)YA(n),n.blockedOn===null&&Ei.shift()}var Xo=Zr.ReactCurrentBatchConfig,jd=!0;function gM(t,e,n,r){var i=Se,s=Xo.transition;Xo.transition=null;try{Se=1,P_(t,e,n,r)}finally{Se=i,Xo.transition=s}}function _M(t,e,n,r){var i=Se,s=Xo.transition;Xo.transition=null;try{Se=4,P_(t,e,n,r)}finally{Se=i,Xo.transition=s}}function P_(t,e,n,r){if(jd){var i=Fm(t,e,n,r);if(i===null)Op(t,e,r,Qd,n),vT(t,r);else if(pM(i,t,e,n,r))r.stopPropagation();else if(vT(t,r),e&4&&-1<fM.indexOf(t)){for(;i!==null;){var s=nc(i);if(s!==null&&KA(s),s=Fm(t,e,n,r),s===null&&Op(t,e,r,Qd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Op(t,e,r,null,n)}}var Qd=null;function Fm(t,e,n,r){if(Qd=null,t=A_(r),t=Rs(t),t!==null)if(e=io(t),e===null)t=null;else if(n=e.tag,n===13){if(t=OA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qd=t,null}function XA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iM()){case C_:return 1;case $A:return 4;case Kd:case sM:return 16;case HA:return 536870912;default:return 16}default:return 16}}var Ai=null,N_=null,Td=null;function ZA(){if(Td)return Td;var t,e=N_,n=e.length,r,i="value"in Ai?Ai.value:Ai.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Td=i.slice(t,1<r?1-r:void 0)}function wd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kc(){return!0}function TT(){return!1}function kn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Kc:TT,this.isPropagationStopped=TT,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kc)},persist:function(){},isPersistent:Kc}),e}var La={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},b_=kn(La),tc=We({},La,{view:0,detail:0}),yM=kn(tc),Np,bp,vl,Wh=We({},tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:k_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vl&&(vl&&t.type==="mousemove"?(Np=t.screenX-vl.screenX,bp=t.screenY-vl.screenY):bp=Np=0,vl=t),Np)},movementY:function(t){return"movementY"in t?t.movementY:bp}}),wT=kn(Wh),vM=We({},Wh,{dataTransfer:0}),EM=kn(vM),TM=We({},tc,{relatedTarget:0}),kp=kn(TM),wM=We({},La,{animationName:0,elapsedTime:0,pseudoElement:0}),IM=kn(wM),SM=We({},La,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),AM=kn(SM),CM=We({},La,{data:0}),IT=kn(CM),RM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NM(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=PM[t])?!!e[t]:!1}function k_(){return NM}var bM=We({},tc,{key:function(t){if(t.key){var e=RM[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=wd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?xM[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:k_,charCode:function(t){return t.type==="keypress"?wd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?wd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kM=kn(bM),DM=We({},Wh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ST=kn(DM),MM=We({},tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:k_}),VM=kn(MM),LM=We({},La,{propertyName:0,elapsedTime:0,pseudoElement:0}),UM=kn(LM),FM=We({},Wh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),OM=kn(FM),BM=[9,13,27,32],D_=$r&&"CompositionEvent"in window,Jl=null;$r&&"documentMode"in document&&(Jl=document.documentMode);var qM=$r&&"TextEvent"in window&&!Jl,eC=$r&&(!D_||Jl&&8<Jl&&11>=Jl),AT=" ",CT=!1;function tC(t,e){switch(t){case"keyup":return BM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lo=!1;function GM(t,e){switch(t){case"compositionend":return nC(e);case"keypress":return e.which!==32?null:(CT=!0,AT);case"textInput":return t=e.data,t===AT&&CT?null:t;default:return null}}function $M(t,e){if(Lo)return t==="compositionend"||!D_&&tC(t,e)?(t=ZA(),Td=N_=Ai=null,Lo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eC&&e.locale!=="ko"?null:e.data;default:return null}}var HM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function RT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!HM[t.type]:e==="textarea"}function rC(t,e,n,r){MA(r),e=Yd(e,"onChange"),0<e.length&&(n=new b_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var jl=null,_u=null;function zM(t){pC(t,0)}function Kh(t){var e=Oo(t);if(RA(e))return t}function WM(t,e){if(t==="change")return e}var iC=!1;if($r){var Dp;if($r){var Mp="oninput"in document;if(!Mp){var xT=document.createElement("div");xT.setAttribute("oninput","return;"),Mp=typeof xT.oninput=="function"}Dp=Mp}else Dp=!1;iC=Dp&&(!document.documentMode||9<document.documentMode)}function PT(){jl&&(jl.detachEvent("onpropertychange",sC),_u=jl=null)}function sC(t){if(t.propertyName==="value"&&Kh(_u)){var e=[];rC(e,_u,t,A_(t)),FA(zM,e)}}function KM(t,e,n){t==="focusin"?(PT(),jl=e,_u=n,jl.attachEvent("onpropertychange",sC)):t==="focusout"&&PT()}function JM(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Kh(_u)}function jM(t,e){if(t==="click")return Kh(e)}function QM(t,e){if(t==="input"||t==="change")return Kh(e)}function YM(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ir=typeof Object.is=="function"?Object.is:YM;function yu(t,e){if(ir(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Em.call(e,i)||!ir(t[i],e[i]))return!1}return!0}function NT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function bT(t,e){var n=NT(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=NT(n)}}function oC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function aC(){for(var t=window,e=Hd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Hd(t.document)}return e}function M_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function XM(t){var e=aC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oC(n.ownerDocument.documentElement,n)){if(r!==null&&M_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=bT(n,s);var o=bT(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ZM=$r&&"documentMode"in document&&11>=document.documentMode,Uo=null,Om=null,Ql=null,Bm=!1;function kT(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bm||Uo==null||Uo!==Hd(r)||(r=Uo,"selectionStart"in r&&M_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ql&&yu(Ql,r)||(Ql=r,r=Yd(Om,"onSelect"),0<r.length&&(e=new b_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Uo)))}function Jc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Fo={animationend:Jc("Animation","AnimationEnd"),animationiteration:Jc("Animation","AnimationIteration"),animationstart:Jc("Animation","AnimationStart"),transitionend:Jc("Transition","TransitionEnd")},Vp={},lC={};$r&&(lC=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function Jh(t){if(Vp[t])return Vp[t];if(!Fo[t])return t;var e=Fo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in lC)return Vp[t]=e[n];return t}var uC=Jh("animationend"),cC=Jh("animationiteration"),dC=Jh("animationstart"),hC=Jh("transitionend"),fC=new Map,DT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(t,e){fC.set(t,e),ro(e,[t])}for(var Lp=0;Lp<DT.length;Lp++){var Up=DT[Lp],e1=Up.toLowerCase(),t1=Up[0].toUpperCase()+Up.slice(1);es(e1,"on"+t1)}es(uC,"onAnimationEnd");es(cC,"onAnimationIteration");es(dC,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(hC,"onTransitionEnd");ca("onMouseEnter",["mouseout","mouseover"]);ca("onMouseLeave",["mouseout","mouseover"]);ca("onPointerEnter",["pointerout","pointerover"]);ca("onPointerLeave",["pointerout","pointerover"]);ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ul));function MT(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,eM(r,e,void 0,t),t.currentTarget=null}function pC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;MT(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;MT(i,a,u),s=l}}}if(Wd)throw t=Vm,Wd=!1,Vm=null,t}function De(t,e){var n=e[zm];n===void 0&&(n=e[zm]=new Set);var r=t+"__bubble";n.has(r)||(mC(e,t,2,!1),n.add(r))}function Fp(t,e,n){var r=0;e&&(r|=4),mC(n,t,r,e)}var jc="_reactListening"+Math.random().toString(36).slice(2);function vu(t){if(!t[jc]){t[jc]=!0,wA.forEach(function(n){n!=="selectionchange"&&(n1.has(n)||Fp(n,!1,t),Fp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[jc]||(e[jc]=!0,Fp("selectionchange",!1,e))}}function mC(t,e,n,r){switch(XA(e)){case 1:var i=gM;break;case 4:i=_M;break;default:i=P_}n=i.bind(null,e,n,t),i=void 0,!Mm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Op(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Rs(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}FA(function(){var u=s,d=A_(n),p=[];e:{var m=fC.get(t);if(m!==void 0){var _=b_,E=t;switch(t){case"keypress":if(wd(n)===0)break e;case"keydown":case"keyup":_=kM;break;case"focusin":E="focus",_=kp;break;case"focusout":E="blur",_=kp;break;case"beforeblur":case"afterblur":_=kp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=wT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=EM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=VM;break;case uC:case cC:case dC:_=IM;break;case hC:_=UM;break;case"scroll":_=yM;break;case"wheel":_=OM;break;case"copy":case"cut":case"paste":_=AM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=ST}var C=(e&4)!==0,A=!C&&t==="scroll",w=C?m!==null?m+"Capture":null:m;C=[];for(var T=u,S;T!==null;){S=T;var D=S.stateNode;if(S.tag===5&&D!==null&&(S=D,w!==null&&(D=fu(T,w),D!=null&&C.push(Eu(T,D,S)))),A)break;T=T.return}0<C.length&&(m=new _(m,E,null,n,d),p.push({event:m,listeners:C}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==km&&(E=n.relatedTarget||n.fromElement)&&(Rs(E)||E[Hr]))break e;if((_||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,_?(E=n.relatedTarget||n.toElement,_=u,E=E?Rs(E):null,E!==null&&(A=io(E),E!==A||E.tag!==5&&E.tag!==6)&&(E=null)):(_=null,E=u),_!==E)){if(C=wT,D="onMouseLeave",w="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(C=ST,D="onPointerLeave",w="onPointerEnter",T="pointer"),A=_==null?m:Oo(_),S=E==null?m:Oo(E),m=new C(D,T+"leave",_,n,d),m.target=A,m.relatedTarget=S,D=null,Rs(d)===u&&(C=new C(w,T+"enter",E,n,d),C.target=S,C.relatedTarget=A,D=C),A=D,_&&E)t:{for(C=_,w=E,T=0,S=C;S;S=To(S))T++;for(S=0,D=w;D;D=To(D))S++;for(;0<T-S;)C=To(C),T--;for(;0<S-T;)w=To(w),S--;for(;T--;){if(C===w||w!==null&&C===w.alternate)break t;C=To(C),w=To(w)}C=null}else C=null;_!==null&&VT(p,m,_,C,!1),E!==null&&A!==null&&VT(p,A,E,C,!0)}}e:{if(m=u?Oo(u):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var L=WM;else if(RT(m))if(iC)L=QM;else{L=JM;var M=KM}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(L=jM);if(L&&(L=L(t,u))){rC(p,L,n,d);break e}M&&M(t,m,u),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&Rm(m,"number",m.value)}switch(M=u?Oo(u):window,t){case"focusin":(RT(M)||M.contentEditable==="true")&&(Uo=M,Om=u,Ql=null);break;case"focusout":Ql=Om=Uo=null;break;case"mousedown":Bm=!0;break;case"contextmenu":case"mouseup":case"dragend":Bm=!1,kT(p,n,d);break;case"selectionchange":if(ZM)break;case"keydown":case"keyup":kT(p,n,d)}var R;if(D_)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Lo?tC(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(eC&&n.locale!=="ko"&&(Lo||I!=="onCompositionStart"?I==="onCompositionEnd"&&Lo&&(R=ZA()):(Ai=d,N_="value"in Ai?Ai.value:Ai.textContent,Lo=!0)),M=Yd(u,I),0<M.length&&(I=new IT(I,t,null,n,d),p.push({event:I,listeners:M}),R?I.data=R:(R=nC(n),R!==null&&(I.data=R)))),(R=qM?GM(t,n):$M(t,n))&&(u=Yd(u,"onBeforeInput"),0<u.length&&(d=new IT("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:u}),d.data=R))}pC(p,e)})}function Eu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Yd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=fu(t,n),s!=null&&r.unshift(Eu(t,s,i)),s=fu(t,e),s!=null&&r.push(Eu(t,s,i))),t=t.return}return r}function To(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function VT(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=fu(n,s),l!=null&&o.unshift(Eu(n,l,a))):i||(l=fu(n,s),l!=null&&o.push(Eu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var r1=/\r\n?/g,i1=/\u0000|\uFFFD/g;function LT(t){return(typeof t=="string"?t:""+t).replace(r1,`
`).replace(i1,"")}function Qc(t,e,n){if(e=LT(e),LT(t)!==e&&n)throw Error(z(425))}function Xd(){}var qm=null,Gm=null;function $m(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hm=typeof setTimeout=="function"?setTimeout:void 0,s1=typeof clearTimeout=="function"?clearTimeout:void 0,UT=typeof Promise=="function"?Promise:void 0,o1=typeof queueMicrotask=="function"?queueMicrotask:typeof UT<"u"?function(t){return UT.resolve(null).then(t).catch(a1)}:Hm;function a1(t){setTimeout(function(){throw t})}function Bp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),gu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);gu(e)}function Di(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function FT(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ua=Math.random().toString(36).slice(2),dr="__reactFiber$"+Ua,Tu="__reactProps$"+Ua,Hr="__reactContainer$"+Ua,zm="__reactEvents$"+Ua,l1="__reactListeners$"+Ua,u1="__reactHandles$"+Ua;function Rs(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Hr]||n[dr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=FT(t);t!==null;){if(n=t[dr])return n;t=FT(t)}return e}t=n,n=t.parentNode}return null}function nc(t){return t=t[dr]||t[Hr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Oo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function jh(t){return t[Tu]||null}var Wm=[],Bo=-1;function ts(t){return{current:t}}function Ve(t){0>Bo||(t.current=Wm[Bo],Wm[Bo]=null,Bo--)}function Ne(t,e){Bo++,Wm[Bo]=t.current,t.current=e}var Gi={},zt=ts(Gi),yn=ts(!1),Os=Gi;function da(t,e){var n=t.type.contextTypes;if(!n)return Gi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function vn(t){return t=t.childContextTypes,t!=null}function Zd(){Ve(yn),Ve(zt)}function OT(t,e,n){if(zt.current!==Gi)throw Error(z(168));Ne(zt,e),Ne(yn,n)}function gC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(z(108,KD(t)||"Unknown",i));return We({},n,r)}function eh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Gi,Os=zt.current,Ne(zt,t),Ne(yn,yn.current),!0}function BT(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=gC(t,e,Os),r.__reactInternalMemoizedMergedChildContext=t,Ve(yn),Ve(zt),Ne(zt,t)):Ve(yn),Ne(yn,n)}var kr=null,Qh=!1,qp=!1;function _C(t){kr===null?kr=[t]:kr.push(t)}function c1(t){Qh=!0,_C(t)}function ns(){if(!qp&&kr!==null){qp=!0;var t=0,e=Se;try{var n=kr;for(Se=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}kr=null,Qh=!1}catch(i){throw kr!==null&&(kr=kr.slice(t+1)),GA(C_,ns),i}finally{Se=e,qp=!1}}return null}var qo=[],Go=0,th=null,nh=0,Mn=[],Vn=0,Bs=null,Mr=1,Vr="";function _s(t,e){qo[Go++]=nh,qo[Go++]=th,th=t,nh=e}function yC(t,e,n){Mn[Vn++]=Mr,Mn[Vn++]=Vr,Mn[Vn++]=Bs,Bs=t;var r=Mr;t=Vr;var i=32-er(r)-1;r&=~(1<<i),n+=1;var s=32-er(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Mr=1<<32-er(e)+i|n<<i|r,Vr=s+t}else Mr=1<<s|n<<i|r,Vr=t}function V_(t){t.return!==null&&(_s(t,1),yC(t,1,0))}function L_(t){for(;t===th;)th=qo[--Go],qo[Go]=null,nh=qo[--Go],qo[Go]=null;for(;t===Bs;)Bs=Mn[--Vn],Mn[Vn]=null,Vr=Mn[--Vn],Mn[Vn]=null,Mr=Mn[--Vn],Mn[Vn]=null}var Rn=null,An=null,Oe=!1,Xn=null;function vC(t,e){var n=Ln(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function qT(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Rn=t,An=Di(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Rn=t,An=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Bs!==null?{id:Mr,overflow:Vr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ln(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Rn=t,An=null,!0):!1;default:return!1}}function Km(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Jm(t){if(Oe){var e=An;if(e){var n=e;if(!qT(t,e)){if(Km(t))throw Error(z(418));e=Di(n.nextSibling);var r=Rn;e&&qT(t,e)?vC(r,n):(t.flags=t.flags&-4097|2,Oe=!1,Rn=t)}}else{if(Km(t))throw Error(z(418));t.flags=t.flags&-4097|2,Oe=!1,Rn=t}}}function GT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Rn=t}function Yc(t){if(t!==Rn)return!1;if(!Oe)return GT(t),Oe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$m(t.type,t.memoizedProps)),e&&(e=An)){if(Km(t))throw EC(),Error(z(418));for(;e;)vC(t,e),e=Di(e.nextSibling)}if(GT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){An=Di(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}An=null}}else An=Rn?Di(t.stateNode.nextSibling):null;return!0}function EC(){for(var t=An;t;)t=Di(t.nextSibling)}function ha(){An=Rn=null,Oe=!1}function U_(t){Xn===null?Xn=[t]:Xn.push(t)}var d1=Zr.ReactCurrentBatchConfig;function El(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function Xc(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function $T(t){var e=t._init;return e(t._payload)}function TC(t){function e(w,T){if(t){var S=w.deletions;S===null?(w.deletions=[T],w.flags|=16):S.push(T)}}function n(w,T){if(!t)return null;for(;T!==null;)e(w,T),T=T.sibling;return null}function r(w,T){for(w=new Map;T!==null;)T.key!==null?w.set(T.key,T):w.set(T.index,T),T=T.sibling;return w}function i(w,T){return w=Ui(w,T),w.index=0,w.sibling=null,w}function s(w,T,S){return w.index=S,t?(S=w.alternate,S!==null?(S=S.index,S<T?(w.flags|=2,T):S):(w.flags|=2,T)):(w.flags|=1048576,T)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,T,S,D){return T===null||T.tag!==6?(T=Jp(S,w.mode,D),T.return=w,T):(T=i(T,S),T.return=w,T)}function l(w,T,S,D){var L=S.type;return L===Vo?d(w,T,S.props.children,D,S.key):T!==null&&(T.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===yi&&$T(L)===T.type)?(D=i(T,S.props),D.ref=El(w,T,S),D.return=w,D):(D=Pd(S.type,S.key,S.props,null,w.mode,D),D.ref=El(w,T,S),D.return=w,D)}function u(w,T,S,D){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=jp(S,w.mode,D),T.return=w,T):(T=i(T,S.children||[]),T.return=w,T)}function d(w,T,S,D,L){return T===null||T.tag!==7?(T=Ms(S,w.mode,D,L),T.return=w,T):(T=i(T,S),T.return=w,T)}function p(w,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Jp(""+T,w.mode,S),T.return=w,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case qc:return S=Pd(T.type,T.key,T.props,null,w.mode,S),S.ref=El(w,null,T),S.return=w,S;case Mo:return T=jp(T,w.mode,S),T.return=w,T;case yi:var D=T._init;return p(w,D(T._payload),S)}if(Vl(T)||ml(T))return T=Ms(T,w.mode,S,null),T.return=w,T;Xc(w,T)}return null}function m(w,T,S,D){var L=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return L!==null?null:a(w,T,""+S,D);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case qc:return S.key===L?l(w,T,S,D):null;case Mo:return S.key===L?u(w,T,S,D):null;case yi:return L=S._init,m(w,T,L(S._payload),D)}if(Vl(S)||ml(S))return L!==null?null:d(w,T,S,D,null);Xc(w,S)}return null}function _(w,T,S,D,L){if(typeof D=="string"&&D!==""||typeof D=="number")return w=w.get(S)||null,a(T,w,""+D,L);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case qc:return w=w.get(D.key===null?S:D.key)||null,l(T,w,D,L);case Mo:return w=w.get(D.key===null?S:D.key)||null,u(T,w,D,L);case yi:var M=D._init;return _(w,T,S,M(D._payload),L)}if(Vl(D)||ml(D))return w=w.get(S)||null,d(T,w,D,L,null);Xc(T,D)}return null}function E(w,T,S,D){for(var L=null,M=null,R=T,I=T=0,P=null;R!==null&&I<S.length;I++){R.index>I?(P=R,R=null):P=R.sibling;var N=m(w,R,S[I],D);if(N===null){R===null&&(R=P);break}t&&R&&N.alternate===null&&e(w,R),T=s(N,T,I),M===null?L=N:M.sibling=N,M=N,R=P}if(I===S.length)return n(w,R),Oe&&_s(w,I),L;if(R===null){for(;I<S.length;I++)R=p(w,S[I],D),R!==null&&(T=s(R,T,I),M===null?L=R:M.sibling=R,M=R);return Oe&&_s(w,I),L}for(R=r(w,R);I<S.length;I++)P=_(R,w,I,S[I],D),P!==null&&(t&&P.alternate!==null&&R.delete(P.key===null?I:P.key),T=s(P,T,I),M===null?L=P:M.sibling=P,M=P);return t&&R.forEach(function(k){return e(w,k)}),Oe&&_s(w,I),L}function C(w,T,S,D){var L=ml(S);if(typeof L!="function")throw Error(z(150));if(S=L.call(S),S==null)throw Error(z(151));for(var M=L=null,R=T,I=T=0,P=null,N=S.next();R!==null&&!N.done;I++,N=S.next()){R.index>I?(P=R,R=null):P=R.sibling;var k=m(w,R,N.value,D);if(k===null){R===null&&(R=P);break}t&&R&&k.alternate===null&&e(w,R),T=s(k,T,I),M===null?L=k:M.sibling=k,M=k,R=P}if(N.done)return n(w,R),Oe&&_s(w,I),L;if(R===null){for(;!N.done;I++,N=S.next())N=p(w,N.value,D),N!==null&&(T=s(N,T,I),M===null?L=N:M.sibling=N,M=N);return Oe&&_s(w,I),L}for(R=r(w,R);!N.done;I++,N=S.next())N=_(R,w,I,N.value,D),N!==null&&(t&&N.alternate!==null&&R.delete(N.key===null?I:N.key),T=s(N,T,I),M===null?L=N:M.sibling=N,M=N);return t&&R.forEach(function(V){return e(w,V)}),Oe&&_s(w,I),L}function A(w,T,S,D){if(typeof S=="object"&&S!==null&&S.type===Vo&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case qc:e:{for(var L=S.key,M=T;M!==null;){if(M.key===L){if(L=S.type,L===Vo){if(M.tag===7){n(w,M.sibling),T=i(M,S.props.children),T.return=w,w=T;break e}}else if(M.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===yi&&$T(L)===M.type){n(w,M.sibling),T=i(M,S.props),T.ref=El(w,M,S),T.return=w,w=T;break e}n(w,M);break}else e(w,M);M=M.sibling}S.type===Vo?(T=Ms(S.props.children,w.mode,D,S.key),T.return=w,w=T):(D=Pd(S.type,S.key,S.props,null,w.mode,D),D.ref=El(w,T,S),D.return=w,w=D)}return o(w);case Mo:e:{for(M=S.key;T!==null;){if(T.key===M)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){n(w,T.sibling),T=i(T,S.children||[]),T.return=w,w=T;break e}else{n(w,T);break}else e(w,T);T=T.sibling}T=jp(S,w.mode,D),T.return=w,w=T}return o(w);case yi:return M=S._init,A(w,T,M(S._payload),D)}if(Vl(S))return E(w,T,S,D);if(ml(S))return C(w,T,S,D);Xc(w,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(n(w,T.sibling),T=i(T,S),T.return=w,w=T):(n(w,T),T=Jp(S,w.mode,D),T.return=w,w=T),o(w)):n(w,T)}return A}var fa=TC(!0),wC=TC(!1),rh=ts(null),ih=null,$o=null,F_=null;function O_(){F_=$o=ih=null}function B_(t){var e=rh.current;Ve(rh),t._currentValue=e}function jm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Zo(t,e){ih=t,F_=$o=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(pn=!0),t.firstContext=null)}function Gn(t){var e=t._currentValue;if(F_!==t)if(t={context:t,memoizedValue:e,next:null},$o===null){if(ih===null)throw Error(z(308));$o=t,ih.dependencies={lanes:0,firstContext:t}}else $o=$o.next=t;return e}var xs=null;function q_(t){xs===null?xs=[t]:xs.push(t)}function IC(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,q_(e)):(n.next=i.next,i.next=n),e.interleaved=n,zr(t,r)}function zr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vi=!1;function G_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Br(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Mi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ge&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,zr(t,n)}return i=r.interleaved,i===null?(e.next=e,q_(r)):(e.next=i.next,i.next=e),r.interleaved=e,zr(t,n)}function Id(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,R_(t,n)}}function HT(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function sh(t,e,n,r){var i=t.updateQueue;vi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var p=i.baseState;o=0,d=u=l=null,a=s;do{var m=a.lane,_=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,C=a;switch(m=e,_=n,C.tag){case 1:if(E=C.payload,typeof E=="function"){p=E.call(_,p,m);break e}p=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=C.payload,m=typeof E=="function"?E.call(_,p,m):E,m==null)break e;p=We({},p,m);break e;case 2:vi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=_,l=p):d=d.next=_,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(d===null&&(l=p),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Gs|=o,t.lanes=o,t.memoizedState=p}}function zT(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(z(191,i));i.call(r)}}}var rc={},Tr=ts(rc),wu=ts(rc),Iu=ts(rc);function Ps(t){if(t===rc)throw Error(z(174));return t}function $_(t,e){switch(Ne(Iu,e),Ne(wu,t),Ne(Tr,rc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pm(e,t)}Ve(Tr),Ne(Tr,e)}function pa(){Ve(Tr),Ve(wu),Ve(Iu)}function AC(t){Ps(Iu.current);var e=Ps(Tr.current),n=Pm(e,t.type);e!==n&&(Ne(wu,t),Ne(Tr,n))}function H_(t){wu.current===t&&(Ve(Tr),Ve(wu))}var $e=ts(0);function oh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gp=[];function z_(){for(var t=0;t<Gp.length;t++)Gp[t]._workInProgressVersionPrimary=null;Gp.length=0}var Sd=Zr.ReactCurrentDispatcher,$p=Zr.ReactCurrentBatchConfig,qs=0,He=null,ht=null,vt=null,ah=!1,Yl=!1,Su=0,h1=0;function Ft(){throw Error(z(321))}function W_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ir(t[n],e[n]))return!1;return!0}function K_(t,e,n,r,i,s){if(qs=s,He=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Sd.current=t===null||t.memoizedState===null?g1:_1,t=n(r,i),Yl){s=0;do{if(Yl=!1,Su=0,25<=s)throw Error(z(301));s+=1,vt=ht=null,e.updateQueue=null,Sd.current=y1,t=n(r,i)}while(Yl)}if(Sd.current=lh,e=ht!==null&&ht.next!==null,qs=0,vt=ht=He=null,ah=!1,e)throw Error(z(300));return t}function J_(){var t=Su!==0;return Su=0,t}function cr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?He.memoizedState=vt=t:vt=vt.next=t,vt}function $n(){if(ht===null){var t=He.alternate;t=t!==null?t.memoizedState:null}else t=ht.next;var e=vt===null?He.memoizedState:vt.next;if(e!==null)vt=e,ht=t;else{if(t===null)throw Error(z(310));ht=t,t={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},vt===null?He.memoizedState=vt=t:vt=vt.next=t}return vt}function Au(t,e){return typeof e=="function"?e(t):e}function Hp(t){var e=$n(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=ht,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((qs&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,He.lanes|=d,Gs|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,ir(r,e.memoizedState)||(pn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,He.lanes|=s,Gs|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zp(t){var e=$n(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);ir(s,e.memoizedState)||(pn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function CC(){}function RC(t,e){var n=He,r=$n(),i=e(),s=!ir(r.memoizedState,i);if(s&&(r.memoizedState=i,pn=!0),r=r.queue,j_(NC.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,Cu(9,PC.bind(null,n,r,i,e),void 0,null),Tt===null)throw Error(z(349));qs&30||xC(n,e,i)}return i}function xC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function PC(t,e,n,r){e.value=n,e.getSnapshot=r,bC(e)&&kC(t)}function NC(t,e,n){return n(function(){bC(e)&&kC(t)})}function bC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ir(t,n)}catch{return!0}}function kC(t){var e=zr(t,1);e!==null&&tr(e,t,1,-1)}function WT(t){var e=cr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Au,lastRenderedState:t},e.queue=t,t=t.dispatch=m1.bind(null,He,t),[e.memoizedState,t]}function Cu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function DC(){return $n().memoizedState}function Ad(t,e,n,r){var i=cr();He.flags|=t,i.memoizedState=Cu(1|e,n,void 0,r===void 0?null:r)}function Yh(t,e,n,r){var i=$n();r=r===void 0?null:r;var s=void 0;if(ht!==null){var o=ht.memoizedState;if(s=o.destroy,r!==null&&W_(r,o.deps)){i.memoizedState=Cu(e,n,s,r);return}}He.flags|=t,i.memoizedState=Cu(1|e,n,s,r)}function KT(t,e){return Ad(8390656,8,t,e)}function j_(t,e){return Yh(2048,8,t,e)}function MC(t,e){return Yh(4,2,t,e)}function VC(t,e){return Yh(4,4,t,e)}function LC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function UC(t,e,n){return n=n!=null?n.concat([t]):null,Yh(4,4,LC.bind(null,e,t),n)}function Q_(){}function FC(t,e){var n=$n();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&W_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function OC(t,e){var n=$n();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&W_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function BC(t,e,n){return qs&21?(ir(n,e)||(n=zA(),He.lanes|=n,Gs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,pn=!0),t.memoizedState=n)}function f1(t,e){var n=Se;Se=n!==0&&4>n?n:4,t(!0);var r=$p.transition;$p.transition={};try{t(!1),e()}finally{Se=n,$p.transition=r}}function qC(){return $n().memoizedState}function p1(t,e,n){var r=Li(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},GC(t))$C(e,n);else if(n=IC(t,e,n,r),n!==null){var i=nn();tr(n,t,r,i),HC(n,e,r)}}function m1(t,e,n){var r=Li(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(GC(t))$C(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ir(a,o)){var l=e.interleaved;l===null?(i.next=i,q_(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=IC(t,e,i,r),n!==null&&(i=nn(),tr(n,t,r,i),HC(n,e,r))}}function GC(t){var e=t.alternate;return t===He||e!==null&&e===He}function $C(t,e){Yl=ah=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function HC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,R_(t,n)}}var lh={readContext:Gn,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useInsertionEffect:Ft,useLayoutEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useMutableSource:Ft,useSyncExternalStore:Ft,useId:Ft,unstable_isNewReconciler:!1},g1={readContext:Gn,useCallback:function(t,e){return cr().memoizedState=[t,e===void 0?null:e],t},useContext:Gn,useEffect:KT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ad(4194308,4,LC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ad(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ad(4,2,t,e)},useMemo:function(t,e){var n=cr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=cr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=p1.bind(null,He,t),[r.memoizedState,t]},useRef:function(t){var e=cr();return t={current:t},e.memoizedState=t},useState:WT,useDebugValue:Q_,useDeferredValue:function(t){return cr().memoizedState=t},useTransition:function(){var t=WT(!1),e=t[0];return t=f1.bind(null,t[1]),cr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=He,i=cr();if(Oe){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),Tt===null)throw Error(z(349));qs&30||xC(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,KT(NC.bind(null,r,s,t),[t]),r.flags|=2048,Cu(9,PC.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=cr(),e=Tt.identifierPrefix;if(Oe){var n=Vr,r=Mr;n=(r&~(1<<32-er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Su++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=h1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},_1={readContext:Gn,useCallback:FC,useContext:Gn,useEffect:j_,useImperativeHandle:UC,useInsertionEffect:MC,useLayoutEffect:VC,useMemo:OC,useReducer:Hp,useRef:DC,useState:function(){return Hp(Au)},useDebugValue:Q_,useDeferredValue:function(t){var e=$n();return BC(e,ht.memoizedState,t)},useTransition:function(){var t=Hp(Au)[0],e=$n().memoizedState;return[t,e]},useMutableSource:CC,useSyncExternalStore:RC,useId:qC,unstable_isNewReconciler:!1},y1={readContext:Gn,useCallback:FC,useContext:Gn,useEffect:j_,useImperativeHandle:UC,useInsertionEffect:MC,useLayoutEffect:VC,useMemo:OC,useReducer:zp,useRef:DC,useState:function(){return zp(Au)},useDebugValue:Q_,useDeferredValue:function(t){var e=$n();return ht===null?e.memoizedState=t:BC(e,ht.memoizedState,t)},useTransition:function(){var t=zp(Au)[0],e=$n().memoizedState;return[t,e]},useMutableSource:CC,useSyncExternalStore:RC,useId:qC,unstable_isNewReconciler:!1};function Qn(t,e){if(t&&t.defaultProps){e=We({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Qm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:We({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Xh={isMounted:function(t){return(t=t._reactInternals)?io(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=nn(),i=Li(t),s=Br(r,i);s.payload=e,n!=null&&(s.callback=n),e=Mi(t,s,i),e!==null&&(tr(e,t,i,r),Id(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=nn(),i=Li(t),s=Br(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Mi(t,s,i),e!==null&&(tr(e,t,i,r),Id(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=nn(),r=Li(t),i=Br(n,r);i.tag=2,e!=null&&(i.callback=e),e=Mi(t,i,r),e!==null&&(tr(e,t,r,n),Id(e,t,r))}};function JT(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!yu(n,r)||!yu(i,s):!0}function zC(t,e,n){var r=!1,i=Gi,s=e.contextType;return typeof s=="object"&&s!==null?s=Gn(s):(i=vn(e)?Os:zt.current,r=e.contextTypes,s=(r=r!=null)?da(t,i):Gi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Xh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function jT(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Xh.enqueueReplaceState(e,e.state,null)}function Ym(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},G_(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Gn(s):(s=vn(e)?Os:zt.current,i.context=da(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Qm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Xh.enqueueReplaceState(i,i.state,null),sh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ma(t,e){try{var n="",r=e;do n+=WD(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Wp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Xm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var v1=typeof WeakMap=="function"?WeakMap:Map;function WC(t,e,n){n=Br(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ch||(ch=!0,lg=r),Xm(t,e)},n}function KC(t,e,n){n=Br(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Xm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Xm(t,e),typeof r!="function"&&(Vi===null?Vi=new Set([this]):Vi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function QT(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new v1;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=D1.bind(null,t,e,n),e.then(t,t))}function YT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function XT(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Br(-1,1),e.tag=2,Mi(n,e,1))),n.lanes|=1),t)}var E1=Zr.ReactCurrentOwner,pn=!1;function Xt(t,e,n,r){e.child=t===null?wC(e,null,n,r):fa(e,t.child,n,r)}function ZT(t,e,n,r,i){n=n.render;var s=e.ref;return Zo(e,i),r=K_(t,e,n,r,s,i),n=J_(),t!==null&&!pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Wr(t,e,i)):(Oe&&n&&V_(e),e.flags|=1,Xt(t,e,r,i),e.child)}function ew(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!iy(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,JC(t,e,s,r,i)):(t=Pd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:yu,n(o,r)&&t.ref===e.ref)return Wr(t,e,i)}return e.flags|=1,t=Ui(s,r),t.ref=e.ref,t.return=e,e.child=t}function JC(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(yu(s,r)&&t.ref===e.ref)if(pn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(pn=!0);else return e.lanes=t.lanes,Wr(t,e,i)}return Zm(t,e,n,r,i)}function jC(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(zo,wn),wn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ne(zo,wn),wn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ne(zo,wn),wn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ne(zo,wn),wn|=r;return Xt(t,e,i,n),e.child}function QC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Zm(t,e,n,r,i){var s=vn(n)?Os:zt.current;return s=da(e,s),Zo(e,i),n=K_(t,e,n,r,s,i),r=J_(),t!==null&&!pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Wr(t,e,i)):(Oe&&r&&V_(e),e.flags|=1,Xt(t,e,n,i),e.child)}function tw(t,e,n,r,i){if(vn(n)){var s=!0;eh(e)}else s=!1;if(Zo(e,i),e.stateNode===null)Cd(t,e),zC(e,n,r),Ym(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Gn(u):(u=vn(n)?Os:zt.current,u=da(e,u));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&jT(e,o,r,u),vi=!1;var m=e.memoizedState;o.state=m,sh(e,r,o,i),l=e.memoizedState,a!==r||m!==l||yn.current||vi?(typeof d=="function"&&(Qm(e,n,d,r),l=e.memoizedState),(a=vi||JT(e,n,a,r,m,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,SC(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Qn(e.type,a),o.props=u,p=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Gn(l):(l=vn(n)?Os:zt.current,l=da(e,l));var _=n.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&jT(e,o,r,l),vi=!1,m=e.memoizedState,o.state=m,sh(e,r,o,i);var E=e.memoizedState;a!==p||m!==E||yn.current||vi?(typeof _=="function"&&(Qm(e,n,_,r),E=e.memoizedState),(u=vi||JT(e,n,u,r,m,E,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return eg(t,e,n,r,s,i)}function eg(t,e,n,r,i,s){QC(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&BT(e,n,!1),Wr(t,e,s);r=e.stateNode,E1.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=fa(e,t.child,null,s),e.child=fa(e,null,a,s)):Xt(t,e,a,s),e.memoizedState=r.state,i&&BT(e,n,!0),e.child}function YC(t){var e=t.stateNode;e.pendingContext?OT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&OT(t,e.context,!1),$_(t,e.containerInfo)}function nw(t,e,n,r,i){return ha(),U_(i),e.flags|=256,Xt(t,e,n,r),e.child}var tg={dehydrated:null,treeContext:null,retryLane:0};function ng(t){return{baseLanes:t,cachePool:null,transitions:null}}function XC(t,e,n){var r=e.pendingProps,i=$e.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ne($e,i&1),t===null)return Jm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=tf(o,r,0,null),t=Ms(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=ng(n),e.memoizedState=tg,t):Y_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return T1(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ui(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ui(a,s):(s=Ms(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?ng(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=tg,r}return s=t.child,t=s.sibling,r=Ui(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Y_(t,e){return e=tf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Zc(t,e,n,r){return r!==null&&U_(r),fa(e,t.child,null,n),t=Y_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function T1(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Wp(Error(z(422))),Zc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=tf({mode:"visible",children:r.children},i,0,null),s=Ms(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&fa(e,t.child,null,o),e.child.memoizedState=ng(o),e.memoizedState=tg,s);if(!(e.mode&1))return Zc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(z(419)),r=Wp(s,r,void 0),Zc(t,e,o,r)}if(a=(o&t.childLanes)!==0,pn||a){if(r=Tt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,zr(t,i),tr(r,t,i,-1))}return ry(),r=Wp(Error(z(421))),Zc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=M1.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,An=Di(i.nextSibling),Rn=e,Oe=!0,Xn=null,t!==null&&(Mn[Vn++]=Mr,Mn[Vn++]=Vr,Mn[Vn++]=Bs,Mr=t.id,Vr=t.overflow,Bs=e),e=Y_(e,r.children),e.flags|=4096,e)}function rw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jm(t.return,e,n)}function Kp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ZC(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Xt(t,e,r.children,n),r=$e.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&rw(t,n,e);else if(t.tag===19)rw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ne($e,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&oh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Kp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&oh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Kp(e,!0,n,null,s);break;case"together":Kp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Cd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=Ui(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ui(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function w1(t,e,n){switch(e.tag){case 3:YC(e),ha();break;case 5:AC(e);break;case 1:vn(e.type)&&eh(e);break;case 4:$_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ne(rh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ne($e,$e.current&1),e.flags|=128,null):n&e.child.childLanes?XC(t,e,n):(Ne($e,$e.current&1),t=Wr(t,e,n),t!==null?t.sibling:null);Ne($e,$e.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ZC(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ne($e,$e.current),r)break;return null;case 22:case 23:return e.lanes=0,jC(t,e,n)}return Wr(t,e,n)}var eR,rg,tR,nR;eR=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rg=function(){};tR=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ps(Tr.current);var s=null;switch(n){case"input":i=Am(t,i),r=Am(t,r),s=[];break;case"select":i=We({},i,{value:void 0}),r=We({},r,{value:void 0}),s=[];break;case"textarea":i=xm(t,i),r=xm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Xd)}Nm(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(du.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(du.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&De("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};nR=function(t,e,n,r){n!==r&&(e.flags|=4)};function Tl(t,e){if(!Oe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ot(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function I1(t,e,n){var r=e.pendingProps;switch(L_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(e),null;case 1:return vn(e.type)&&Zd(),Ot(e),null;case 3:return r=e.stateNode,pa(),Ve(yn),Ve(zt),z_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Yc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xn!==null&&(dg(Xn),Xn=null))),rg(t,e),Ot(e),null;case 5:H_(e);var i=Ps(Iu.current);if(n=e.type,t!==null&&e.stateNode!=null)tR(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return Ot(e),null}if(t=Ps(Tr.current),Yc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[dr]=e,r[Tu]=s,t=(e.mode&1)!==0,n){case"dialog":De("cancel",r),De("close",r);break;case"iframe":case"object":case"embed":De("load",r);break;case"video":case"audio":for(i=0;i<Ul.length;i++)De(Ul[i],r);break;case"source":De("error",r);break;case"img":case"image":case"link":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"input":hT(r,s),De("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},De("invalid",r);break;case"textarea":pT(r,s),De("invalid",r)}Nm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Qc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Qc(r.textContent,a,t),i=["children",""+a]):du.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&De("scroll",r)}switch(n){case"input":Gc(r),fT(r,s,!0);break;case"textarea":Gc(r),mT(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Xd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=NA(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[dr]=e,t[Tu]=r,eR(t,e,!1,!1),e.stateNode=t;e:{switch(o=bm(n,r),n){case"dialog":De("cancel",t),De("close",t),i=r;break;case"iframe":case"object":case"embed":De("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ul.length;i++)De(Ul[i],t);i=r;break;case"source":De("error",t),i=r;break;case"img":case"image":case"link":De("error",t),De("load",t),i=r;break;case"details":De("toggle",t),i=r;break;case"input":hT(t,r),i=Am(t,r),De("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=We({},r,{value:void 0}),De("invalid",t);break;case"textarea":pT(t,r),i=xm(t,r),De("invalid",t);break;default:i=r}Nm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?DA(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bA(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&hu(t,l):typeof l=="number"&&hu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(du.hasOwnProperty(s)?l!=null&&s==="onScroll"&&De("scroll",t):l!=null&&T_(t,s,l,o))}switch(n){case"input":Gc(t),fT(t,r,!1);break;case"textarea":Gc(t),mT(t);break;case"option":r.value!=null&&t.setAttribute("value",""+qi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?jo(t,!!r.multiple,s,!1):r.defaultValue!=null&&jo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Xd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ot(e),null;case 6:if(t&&e.stateNode!=null)nR(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=Ps(Iu.current),Ps(Tr.current),Yc(e)){if(r=e.stateNode,n=e.memoizedProps,r[dr]=e,(s=r.nodeValue!==n)&&(t=Rn,t!==null))switch(t.tag){case 3:Qc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dr]=e,e.stateNode=r}return Ot(e),null;case 13:if(Ve($e),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Oe&&An!==null&&e.mode&1&&!(e.flags&128))EC(),ha(),e.flags|=98560,s=!1;else if(s=Yc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(z(317));s[dr]=e}else ha(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ot(e),s=!1}else Xn!==null&&(dg(Xn),Xn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||$e.current&1?pt===0&&(pt=3):ry())),e.updateQueue!==null&&(e.flags|=4),Ot(e),null);case 4:return pa(),rg(t,e),t===null&&vu(e.stateNode.containerInfo),Ot(e),null;case 10:return B_(e.type._context),Ot(e),null;case 17:return vn(e.type)&&Zd(),Ot(e),null;case 19:if(Ve($e),s=e.memoizedState,s===null)return Ot(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Tl(s,!1);else{if(pt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=oh(t),o!==null){for(e.flags|=128,Tl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ne($e,$e.current&1|2),e.child}t=t.sibling}s.tail!==null&&nt()>ga&&(e.flags|=128,r=!0,Tl(s,!1),e.lanes=4194304)}else{if(!r)if(t=oh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Tl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Oe)return Ot(e),null}else 2*nt()-s.renderingStartTime>ga&&n!==1073741824&&(e.flags|=128,r=!0,Tl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=nt(),e.sibling=null,n=$e.current,Ne($e,r?n&1|2:n&1),e):(Ot(e),null);case 22:case 23:return ny(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?wn&1073741824&&(Ot(e),e.subtreeFlags&6&&(e.flags|=8192)):Ot(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function S1(t,e){switch(L_(e),e.tag){case 1:return vn(e.type)&&Zd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pa(),Ve(yn),Ve(zt),z_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return H_(e),null;case 13:if(Ve($e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));ha()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ve($e),null;case 4:return pa(),null;case 10:return B_(e.type._context),null;case 22:case 23:return ny(),null;case 24:return null;default:return null}}var ed=!1,qt=!1,A1=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Ho(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qe(t,e,r)}else n.current=null}function ig(t,e,n){try{n()}catch(r){Qe(t,e,r)}}var iw=!1;function C1(t,e){if(qm=jd,t=aC(),M_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,p=t,m=null;t:for(;;){for(var _;p!==n||i!==0&&p.nodeType!==3||(a=o+i),p!==s||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(_=p.firstChild)!==null;)m=p,p=_;for(;;){if(p===t)break t;if(m===n&&++u===i&&(a=o),m===s&&++d===r&&(l=o),(_=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=_}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gm={focusedElem:t,selectionRange:n},jd=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var C=E.memoizedProps,A=E.memoizedState,w=e.stateNode,T=w.getSnapshotBeforeUpdate(e.elementType===e.type?C:Qn(e.type,C),A);w.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(D){Qe(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return E=iw,iw=!1,E}function Xl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ig(e,n,s)}i=i.next}while(i!==r)}}function Zh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function sg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rR(t){var e=t.alternate;e!==null&&(t.alternate=null,rR(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dr],delete e[Tu],delete e[zm],delete e[l1],delete e[u1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function iR(t){return t.tag===5||t.tag===3||t.tag===4}function sw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||iR(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function og(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Xd));else if(r!==4&&(t=t.child,t!==null))for(og(t,e,n),t=t.sibling;t!==null;)og(t,e,n),t=t.sibling}function ag(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ag(t,e,n),t=t.sibling;t!==null;)ag(t,e,n),t=t.sibling}var Rt=null,Yn=!1;function fi(t,e,n){for(n=n.child;n!==null;)sR(t,e,n),n=n.sibling}function sR(t,e,n){if(Er&&typeof Er.onCommitFiberUnmount=="function")try{Er.onCommitFiberUnmount(zh,n)}catch{}switch(n.tag){case 5:qt||Ho(n,e);case 6:var r=Rt,i=Yn;Rt=null,fi(t,e,n),Rt=r,Yn=i,Rt!==null&&(Yn?(t=Rt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Rt.removeChild(n.stateNode));break;case 18:Rt!==null&&(Yn?(t=Rt,n=n.stateNode,t.nodeType===8?Bp(t.parentNode,n):t.nodeType===1&&Bp(t,n),gu(t)):Bp(Rt,n.stateNode));break;case 4:r=Rt,i=Yn,Rt=n.stateNode.containerInfo,Yn=!0,fi(t,e,n),Rt=r,Yn=i;break;case 0:case 11:case 14:case 15:if(!qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&ig(n,e,o),i=i.next}while(i!==r)}fi(t,e,n);break;case 1:if(!qt&&(Ho(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Qe(n,e,a)}fi(t,e,n);break;case 21:fi(t,e,n);break;case 22:n.mode&1?(qt=(r=qt)||n.memoizedState!==null,fi(t,e,n),qt=r):fi(t,e,n);break;default:fi(t,e,n)}}function ow(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new A1),e.forEach(function(r){var i=V1.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Rt=a.stateNode,Yn=!1;break e;case 3:Rt=a.stateNode.containerInfo,Yn=!0;break e;case 4:Rt=a.stateNode.containerInfo,Yn=!0;break e}a=a.return}if(Rt===null)throw Error(z(160));sR(s,o,i),Rt=null,Yn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Qe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oR(e,t),e=e.sibling}function oR(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(jn(e,t),lr(t),r&4){try{Xl(3,t,t.return),Zh(3,t)}catch(C){Qe(t,t.return,C)}try{Xl(5,t,t.return)}catch(C){Qe(t,t.return,C)}}break;case 1:jn(e,t),lr(t),r&512&&n!==null&&Ho(n,n.return);break;case 5:if(jn(e,t),lr(t),r&512&&n!==null&&Ho(n,n.return),t.flags&32){var i=t.stateNode;try{hu(i,"")}catch(C){Qe(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&xA(i,s),bm(a,o);var u=bm(a,s);for(o=0;o<l.length;o+=2){var d=l[o],p=l[o+1];d==="style"?DA(i,p):d==="dangerouslySetInnerHTML"?bA(i,p):d==="children"?hu(i,p):T_(i,d,p,u)}switch(a){case"input":Cm(i,s);break;case"textarea":PA(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var _=s.value;_!=null?jo(i,!!s.multiple,_,!1):m!==!!s.multiple&&(s.defaultValue!=null?jo(i,!!s.multiple,s.defaultValue,!0):jo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Tu]=s}catch(C){Qe(t,t.return,C)}}break;case 6:if(jn(e,t),lr(t),r&4){if(t.stateNode===null)throw Error(z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(C){Qe(t,t.return,C)}}break;case 3:if(jn(e,t),lr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{gu(e.containerInfo)}catch(C){Qe(t,t.return,C)}break;case 4:jn(e,t),lr(t);break;case 13:jn(e,t),lr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ey=nt())),r&4&&ow(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(qt=(u=qt)||d,jn(e,t),qt=u):jn(e,t),lr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Z=t,d=t.child;d!==null;){for(p=Z=d;Z!==null;){switch(m=Z,_=m.child,m.tag){case 0:case 11:case 14:case 15:Xl(4,m,m.return);break;case 1:Ho(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(C){Qe(r,n,C)}}break;case 5:Ho(m,m.return);break;case 22:if(m.memoizedState!==null){lw(p);continue}}_!==null?(_.return=m,Z=_):lw(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=kA("display",o))}catch(C){Qe(t,t.return,C)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(C){Qe(t,t.return,C)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:jn(e,t),lr(t),r&4&&ow(t);break;case 21:break;default:jn(e,t),lr(t)}}function lr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(iR(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(hu(i,""),r.flags&=-33);var s=sw(t);ag(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=sw(t);og(t,a,o);break;default:throw Error(z(161))}}catch(l){Qe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function R1(t,e,n){Z=t,aR(t)}function aR(t,e,n){for(var r=(t.mode&1)!==0;Z!==null;){var i=Z,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||ed;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||qt;a=ed;var u=qt;if(ed=o,(qt=l)&&!u)for(Z=i;Z!==null;)o=Z,l=o.child,o.tag===22&&o.memoizedState!==null?uw(i):l!==null?(l.return=o,Z=l):uw(i);for(;s!==null;)Z=s,aR(s),s=s.sibling;Z=i,ed=a,qt=u}aw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Z=s):aw(t)}}function aw(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qt||Zh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!qt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Qn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&zT(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}zT(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&gu(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}qt||e.flags&512&&sg(e)}catch(m){Qe(e,e.return,m)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function lw(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function uw(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Zh(4,e)}catch(l){Qe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Qe(e,i,l)}}var s=e.return;try{sg(e)}catch(l){Qe(e,s,l)}break;case 5:var o=e.return;try{sg(e)}catch(l){Qe(e,o,l)}}}catch(l){Qe(e,e.return,l)}if(e===t){Z=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Z=a;break}Z=e.return}}var x1=Math.ceil,uh=Zr.ReactCurrentDispatcher,X_=Zr.ReactCurrentOwner,On=Zr.ReactCurrentBatchConfig,ge=0,Tt=null,ct=null,Nt=0,wn=0,zo=ts(0),pt=0,Ru=null,Gs=0,ef=0,Z_=0,Zl=null,fn=null,ey=0,ga=1/0,br=null,ch=!1,lg=null,Vi=null,td=!1,Ci=null,dh=0,eu=0,ug=null,Rd=-1,xd=0;function nn(){return ge&6?nt():Rd!==-1?Rd:Rd=nt()}function Li(t){return t.mode&1?ge&2&&Nt!==0?Nt&-Nt:d1.transition!==null?(xd===0&&(xd=zA()),xd):(t=Se,t!==0||(t=window.event,t=t===void 0?16:XA(t.type)),t):1}function tr(t,e,n,r){if(50<eu)throw eu=0,ug=null,Error(z(185));ec(t,n,r),(!(ge&2)||t!==Tt)&&(t===Tt&&(!(ge&2)&&(ef|=n),pt===4&&Ti(t,Nt)),En(t,r),n===1&&ge===0&&!(e.mode&1)&&(ga=nt()+500,Qh&&ns()))}function En(t,e){var n=t.callbackNode;dM(t,e);var r=Jd(t,t===Tt?Nt:0);if(r===0)n!==null&&yT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&yT(n),e===1)t.tag===0?c1(cw.bind(null,t)):_C(cw.bind(null,t)),o1(function(){!(ge&6)&&ns()}),n=null;else{switch(WA(r)){case 1:n=C_;break;case 4:n=$A;break;case 16:n=Kd;break;case 536870912:n=HA;break;default:n=Kd}n=mR(n,lR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function lR(t,e){if(Rd=-1,xd=0,ge&6)throw Error(z(327));var n=t.callbackNode;if(ea()&&t.callbackNode!==n)return null;var r=Jd(t,t===Tt?Nt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hh(t,r);else{e=r;var i=ge;ge|=2;var s=cR();(Tt!==t||Nt!==e)&&(br=null,ga=nt()+500,Ds(t,e));do try{b1();break}catch(a){uR(t,a)}while(!0);O_(),uh.current=s,ge=i,ct!==null?e=0:(Tt=null,Nt=0,e=pt)}if(e!==0){if(e===2&&(i=Lm(t),i!==0&&(r=i,e=cg(t,i))),e===1)throw n=Ru,Ds(t,0),Ti(t,r),En(t,nt()),n;if(e===6)Ti(t,r);else{if(i=t.current.alternate,!(r&30)&&!P1(i)&&(e=hh(t,r),e===2&&(s=Lm(t),s!==0&&(r=s,e=cg(t,s))),e===1))throw n=Ru,Ds(t,0),Ti(t,r),En(t,nt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:ys(t,fn,br);break;case 3:if(Ti(t,r),(r&130023424)===r&&(e=ey+500-nt(),10<e)){if(Jd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){nn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Hm(ys.bind(null,t,fn,br),e);break}ys(t,fn,br);break;case 4:if(Ti(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-er(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*x1(r/1960))-r,10<r){t.timeoutHandle=Hm(ys.bind(null,t,fn,br),r);break}ys(t,fn,br);break;case 5:ys(t,fn,br);break;default:throw Error(z(329))}}}return En(t,nt()),t.callbackNode===n?lR.bind(null,t):null}function cg(t,e){var n=Zl;return t.current.memoizedState.isDehydrated&&(Ds(t,e).flags|=256),t=hh(t,e),t!==2&&(e=fn,fn=n,e!==null&&dg(e)),t}function dg(t){fn===null?fn=t:fn.push.apply(fn,t)}function P1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ir(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ti(t,e){for(e&=~Z_,e&=~ef,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-er(e),r=1<<n;t[n]=-1,e&=~r}}function cw(t){if(ge&6)throw Error(z(327));ea();var e=Jd(t,0);if(!(e&1))return En(t,nt()),null;var n=hh(t,e);if(t.tag!==0&&n===2){var r=Lm(t);r!==0&&(e=r,n=cg(t,r))}if(n===1)throw n=Ru,Ds(t,0),Ti(t,e),En(t,nt()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ys(t,fn,br),En(t,nt()),null}function ty(t,e){var n=ge;ge|=1;try{return t(e)}finally{ge=n,ge===0&&(ga=nt()+500,Qh&&ns())}}function $s(t){Ci!==null&&Ci.tag===0&&!(ge&6)&&ea();var e=ge;ge|=1;var n=On.transition,r=Se;try{if(On.transition=null,Se=1,t)return t()}finally{Se=r,On.transition=n,ge=e,!(ge&6)&&ns()}}function ny(){wn=zo.current,Ve(zo)}function Ds(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,s1(n)),ct!==null)for(n=ct.return;n!==null;){var r=n;switch(L_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zd();break;case 3:pa(),Ve(yn),Ve(zt),z_();break;case 5:H_(r);break;case 4:pa();break;case 13:Ve($e);break;case 19:Ve($e);break;case 10:B_(r.type._context);break;case 22:case 23:ny()}n=n.return}if(Tt=t,ct=t=Ui(t.current,null),Nt=wn=e,pt=0,Ru=null,Z_=ef=Gs=0,fn=Zl=null,xs!==null){for(e=0;e<xs.length;e++)if(n=xs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}xs=null}return t}function uR(t,e){do{var n=ct;try{if(O_(),Sd.current=lh,ah){for(var r=He.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ah=!1}if(qs=0,vt=ht=He=null,Yl=!1,Su=0,X_.current=null,n===null||n.return===null){pt=1,Ru=e,ct=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Nt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=YT(o);if(_!==null){_.flags&=-257,XT(_,o,a,s,e),_.mode&1&&QT(s,u,e),e=_,l=u;var E=e.updateQueue;if(E===null){var C=new Set;C.add(l),e.updateQueue=C}else E.add(l);break e}else{if(!(e&1)){QT(s,u,e),ry();break e}l=Error(z(426))}}else if(Oe&&a.mode&1){var A=YT(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),XT(A,o,a,s,e),U_(ma(l,a));break e}}s=l=ma(l,a),pt!==4&&(pt=2),Zl===null?Zl=[s]:Zl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=WC(s,l,e);HT(s,w);break e;case 1:a=l;var T=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Vi===null||!Vi.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var D=KC(s,a,e);HT(s,D);break e}}s=s.return}while(s!==null)}hR(n)}catch(L){e=L,ct===n&&n!==null&&(ct=n=n.return);continue}break}while(!0)}function cR(){var t=uh.current;return uh.current=lh,t===null?lh:t}function ry(){(pt===0||pt===3||pt===2)&&(pt=4),Tt===null||!(Gs&268435455)&&!(ef&268435455)||Ti(Tt,Nt)}function hh(t,e){var n=ge;ge|=2;var r=cR();(Tt!==t||Nt!==e)&&(br=null,Ds(t,e));do try{N1();break}catch(i){uR(t,i)}while(!0);if(O_(),ge=n,uh.current=r,ct!==null)throw Error(z(261));return Tt=null,Nt=0,pt}function N1(){for(;ct!==null;)dR(ct)}function b1(){for(;ct!==null&&!nM();)dR(ct)}function dR(t){var e=pR(t.alternate,t,wn);t.memoizedProps=t.pendingProps,e===null?hR(t):ct=e,X_.current=null}function hR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=S1(n,e),n!==null){n.flags&=32767,ct=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{pt=6,ct=null;return}}else if(n=I1(n,e,wn),n!==null){ct=n;return}if(e=e.sibling,e!==null){ct=e;return}ct=e=t}while(e!==null);pt===0&&(pt=5)}function ys(t,e,n){var r=Se,i=On.transition;try{On.transition=null,Se=1,k1(t,e,n,r)}finally{On.transition=i,Se=r}return null}function k1(t,e,n,r){do ea();while(Ci!==null);if(ge&6)throw Error(z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(hM(t,s),t===Tt&&(ct=Tt=null,Nt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||td||(td=!0,mR(Kd,function(){return ea(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=On.transition,On.transition=null;var o=Se;Se=1;var a=ge;ge|=4,X_.current=null,C1(t,n),oR(n,t),XM(Gm),jd=!!qm,Gm=qm=null,t.current=n,R1(n),rM(),ge=a,Se=o,On.transition=s}else t.current=n;if(td&&(td=!1,Ci=t,dh=i),s=t.pendingLanes,s===0&&(Vi=null),oM(n.stateNode),En(t,nt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ch)throw ch=!1,t=lg,lg=null,t;return dh&1&&t.tag!==0&&ea(),s=t.pendingLanes,s&1?t===ug?eu++:(eu=0,ug=t):eu=0,ns(),null}function ea(){if(Ci!==null){var t=WA(dh),e=On.transition,n=Se;try{if(On.transition=null,Se=16>t?16:t,Ci===null)var r=!1;else{if(t=Ci,Ci=null,dh=0,ge&6)throw Error(z(331));var i=ge;for(ge|=4,Z=t.current;Z!==null;){var s=Z,o=s.child;if(Z.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Z=u;Z!==null;){var d=Z;switch(d.tag){case 0:case 11:case 15:Xl(8,d,s)}var p=d.child;if(p!==null)p.return=d,Z=p;else for(;Z!==null;){d=Z;var m=d.sibling,_=d.return;if(rR(d),d===u){Z=null;break}if(m!==null){m.return=_,Z=m;break}Z=_}}}var E=s.alternate;if(E!==null){var C=E.child;if(C!==null){E.child=null;do{var A=C.sibling;C.sibling=null,C=A}while(C!==null)}}Z=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Z=o;else e:for(;Z!==null;){if(s=Z,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xl(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Z=w;break e}Z=s.return}}var T=t.current;for(Z=T;Z!==null;){o=Z;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Z=S;else e:for(o=T;Z!==null;){if(a=Z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Zh(9,a)}}catch(L){Qe(a,a.return,L)}if(a===o){Z=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,Z=D;break e}Z=a.return}}if(ge=i,ns(),Er&&typeof Er.onPostCommitFiberRoot=="function")try{Er.onPostCommitFiberRoot(zh,t)}catch{}r=!0}return r}finally{Se=n,On.transition=e}}return!1}function dw(t,e,n){e=ma(n,e),e=WC(t,e,1),t=Mi(t,e,1),e=nn(),t!==null&&(ec(t,1,e),En(t,e))}function Qe(t,e,n){if(t.tag===3)dw(t,t,n);else for(;e!==null;){if(e.tag===3){dw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vi===null||!Vi.has(r))){t=ma(n,t),t=KC(e,t,1),e=Mi(e,t,1),t=nn(),e!==null&&(ec(e,1,t),En(e,t));break}}e=e.return}}function D1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=nn(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(Nt&n)===n&&(pt===4||pt===3&&(Nt&130023424)===Nt&&500>nt()-ey?Ds(t,0):Z_|=n),En(t,e)}function fR(t,e){e===0&&(t.mode&1?(e=zc,zc<<=1,!(zc&130023424)&&(zc=4194304)):e=1);var n=nn();t=zr(t,e),t!==null&&(ec(t,e,n),En(t,n))}function M1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),fR(t,n)}function V1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),fR(t,n)}var pR;pR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yn.current)pn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return pn=!1,w1(t,e,n);pn=!!(t.flags&131072)}else pn=!1,Oe&&e.flags&1048576&&yC(e,nh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Cd(t,e),t=e.pendingProps;var i=da(e,zt.current);Zo(e,n),i=K_(null,e,r,t,i,n);var s=J_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vn(r)?(s=!0,eh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,G_(e),i.updater=Xh,e.stateNode=i,i._reactInternals=e,Ym(e,r,t,n),e=eg(null,e,r,!0,s,n)):(e.tag=0,Oe&&s&&V_(e),Xt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Cd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=U1(r),t=Qn(r,t),i){case 0:e=Zm(null,e,r,t,n);break e;case 1:e=tw(null,e,r,t,n);break e;case 11:e=ZT(null,e,r,t,n);break e;case 14:e=ew(null,e,r,Qn(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),Zm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),tw(t,e,r,i,n);case 3:e:{if(YC(e),t===null)throw Error(z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,SC(t,e),sh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ma(Error(z(423)),e),e=nw(t,e,r,n,i);break e}else if(r!==i){i=ma(Error(z(424)),e),e=nw(t,e,r,n,i);break e}else for(An=Di(e.stateNode.containerInfo.firstChild),Rn=e,Oe=!0,Xn=null,n=wC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ha(),r===i){e=Wr(t,e,n);break e}Xt(t,e,r,n)}e=e.child}return e;case 5:return AC(e),t===null&&Jm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,$m(r,i)?o=null:s!==null&&$m(r,s)&&(e.flags|=32),QC(t,e),Xt(t,e,o,n),e.child;case 6:return t===null&&Jm(e),null;case 13:return XC(t,e,n);case 4:return $_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fa(e,null,r,n):Xt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),ZT(t,e,r,i,n);case 7:return Xt(t,e,e.pendingProps,n),e.child;case 8:return Xt(t,e,e.pendingProps.children,n),e.child;case 12:return Xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ne(rh,r._currentValue),r._currentValue=o,s!==null)if(ir(s.value,o)){if(s.children===i.children&&!yn.current){e=Wr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Br(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),jm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(z(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),jm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Xt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Zo(e,n),i=Gn(i),r=r(i),e.flags|=1,Xt(t,e,r,n),e.child;case 14:return r=e.type,i=Qn(r,e.pendingProps),i=Qn(r.type,i),ew(t,e,r,i,n);case 15:return JC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),Cd(t,e),e.tag=1,vn(r)?(t=!0,eh(e)):t=!1,Zo(e,n),zC(e,r,i),Ym(e,r,i,n),eg(null,e,r,!0,t,n);case 19:return ZC(t,e,n);case 22:return jC(t,e,n)}throw Error(z(156,e.tag))};function mR(t,e){return GA(t,e)}function L1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(t,e,n,r){return new L1(t,e,n,r)}function iy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function U1(t){if(typeof t=="function")return iy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===I_)return 11;if(t===S_)return 14}return 2}function Ui(t,e){var n=t.alternate;return n===null?(n=Ln(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Pd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")iy(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Vo:return Ms(n.children,i,s,e);case w_:o=8,i|=8;break;case Tm:return t=Ln(12,n,e,i|2),t.elementType=Tm,t.lanes=s,t;case wm:return t=Ln(13,n,e,i),t.elementType=wm,t.lanes=s,t;case Im:return t=Ln(19,n,e,i),t.elementType=Im,t.lanes=s,t;case AA:return tf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case IA:o=10;break e;case SA:o=9;break e;case I_:o=11;break e;case S_:o=14;break e;case yi:o=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=Ln(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ms(t,e,n,r){return t=Ln(7,t,r,e),t.lanes=n,t}function tf(t,e,n,r){return t=Ln(22,t,r,e),t.elementType=AA,t.lanes=n,t.stateNode={isHidden:!1},t}function Jp(t,e,n){return t=Ln(6,t,null,e),t.lanes=n,t}function jp(t,e,n){return e=Ln(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function F1(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pp(0),this.expirationTimes=Pp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function sy(t,e,n,r,i,s,o,a,l){return t=new F1(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ln(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},G_(s),t}function O1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function gR(t){if(!t)return Gi;t=t._reactInternals;e:{if(io(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(vn(n))return gC(t,n,e)}return e}function _R(t,e,n,r,i,s,o,a,l){return t=sy(n,r,!0,t,i,s,o,a,l),t.context=gR(null),n=t.current,r=nn(),i=Li(n),s=Br(r,i),s.callback=e??null,Mi(n,s,i),t.current.lanes=i,ec(t,i,r),En(t,r),t}function nf(t,e,n,r){var i=e.current,s=nn(),o=Li(i);return n=gR(n),e.context===null?e.context=n:e.pendingContext=n,e=Br(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Mi(i,e,o),t!==null&&(tr(t,i,o,s),Id(t,i,o)),o}function fh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function hw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function oy(t,e){hw(t,e),(t=t.alternate)&&hw(t,e)}function B1(){return null}var yR=typeof reportError=="function"?reportError:function(t){console.error(t)};function ay(t){this._internalRoot=t}rf.prototype.render=ay.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));nf(t,e,null,null)};rf.prototype.unmount=ay.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$s(function(){nf(null,t,null,null)}),e[Hr]=null}};function rf(t){this._internalRoot=t}rf.prototype.unstable_scheduleHydration=function(t){if(t){var e=jA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ei.length&&e!==0&&e<Ei[n].priority;n++);Ei.splice(n,0,t),n===0&&YA(t)}};function ly(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function sf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function fw(){}function q1(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=fh(o);s.call(u)}}var o=_R(e,r,t,0,null,!1,!1,"",fw);return t._reactRootContainer=o,t[Hr]=o.current,vu(t.nodeType===8?t.parentNode:t),$s(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=fh(l);a.call(u)}}var l=sy(t,0,!1,null,null,!1,!1,"",fw);return t._reactRootContainer=l,t[Hr]=l.current,vu(t.nodeType===8?t.parentNode:t),$s(function(){nf(e,l,n,r)}),l}function of(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=fh(o);a.call(l)}}nf(e,o,t,i)}else o=q1(n,e,t,i,r);return fh(o)}KA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ll(e.pendingLanes);n!==0&&(R_(e,n|1),En(e,nt()),!(ge&6)&&(ga=nt()+500,ns()))}break;case 13:$s(function(){var r=zr(t,1);if(r!==null){var i=nn();tr(r,t,1,i)}}),oy(t,1)}};x_=function(t){if(t.tag===13){var e=zr(t,134217728);if(e!==null){var n=nn();tr(e,t,134217728,n)}oy(t,134217728)}};JA=function(t){if(t.tag===13){var e=Li(t),n=zr(t,e);if(n!==null){var r=nn();tr(n,t,e,r)}oy(t,e)}};jA=function(){return Se};QA=function(t,e){var n=Se;try{return Se=t,e()}finally{Se=n}};Dm=function(t,e,n){switch(e){case"input":if(Cm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=jh(r);if(!i)throw Error(z(90));RA(r),Cm(r,i)}}}break;case"textarea":PA(t,n);break;case"select":e=n.value,e!=null&&jo(t,!!n.multiple,e,!1)}};LA=ty;UA=$s;var G1={usingClientEntryPoint:!1,Events:[nc,Oo,jh,MA,VA,ty]},wl={findFiberByHostInstance:Rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$1={bundleType:wl.bundleType,version:wl.version,rendererPackageName:wl.rendererPackageName,rendererConfig:wl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=BA(t),t===null?null:t.stateNode},findFiberByHostInstance:wl.findFiberByHostInstance||B1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{zh=nd.inject($1),Er=nd}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G1;bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ly(e))throw Error(z(200));return O1(t,e,null,n)};bn.createRoot=function(t,e){if(!ly(t))throw Error(z(299));var n=!1,r="",i=yR;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=sy(t,1,!1,null,null,n,!1,r,i),t[Hr]=e.current,vu(t.nodeType===8?t.parentNode:t),new ay(e)};bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=BA(e),t=t===null?null:t.stateNode,t};bn.flushSync=function(t){return $s(t)};bn.hydrate=function(t,e,n){if(!sf(e))throw Error(z(200));return of(null,t,e,!0,n)};bn.hydrateRoot=function(t,e,n){if(!ly(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=yR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=_R(e,null,t,1,n??null,i,!1,s,o),t[Hr]=e.current,vu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new rf(e)};bn.render=function(t,e,n){if(!sf(e))throw Error(z(200));return of(null,t,e,!1,n)};bn.unmountComponentAtNode=function(t){if(!sf(t))throw Error(z(40));return t._reactRootContainer?($s(function(){of(null,null,t,!1,function(){t._reactRootContainer=null,t[Hr]=null})}),!0):!1};bn.unstable_batchedUpdates=ty;bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!sf(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return of(t,e,n,!1,r)};bn.version="18.3.1-next-f1338f8080-20240426";function vR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vR)}catch(t){console.error(t)}}vR(),vA.exports=bn;var H1=vA.exports,pw=H1;vm.createRoot=pw.createRoot,vm.hydrateRoot=pw.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xu(){return xu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xu.apply(this,arguments)}var Ri;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ri||(Ri={}));const mw="popstate";function z1(t){t===void 0&&(t={});function e(i,s){let{pathname:o="/",search:a="",hash:l=""}=so(i.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),hg("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let o=i.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=i.location.href,u=l.indexOf("#");a=u===-1?l:l.slice(0,u)}return a+"#"+(typeof s=="string"?s:ph(s))}function r(i,s){af(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return K1(e,n,r,t)}function it(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function af(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function W1(){return Math.random().toString(36).substr(2,8)}function gw(t,e){return{usr:t.state,key:t.key,idx:e}}function hg(t,e,n,r){return n===void 0&&(n=null),xu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?so(e):e,{state:n,key:e&&e.key||r||W1()})}function ph(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function so(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function K1(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Ri.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(xu({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function p(){a=Ri.Pop;let A=d(),w=A==null?null:A-u;u=A,l&&l({action:a,location:C.location,delta:w})}function m(A,w){a=Ri.Push;let T=hg(C.location,A,w);n&&n(T,A),u=d()+1;let S=gw(T,u),D=C.createHref(T);try{o.pushState(S,"",D)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;i.location.assign(D)}s&&l&&l({action:a,location:C.location,delta:1})}function _(A,w){a=Ri.Replace;let T=hg(C.location,A,w);n&&n(T,A),u=d();let S=gw(T,u),D=C.createHref(T);o.replaceState(S,"",D),s&&l&&l({action:a,location:C.location,delta:0})}function E(A){let w=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof A=="string"?A:ph(A);return T=T.replace(/ $/,"%20"),it(w,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,w)}let C={get action(){return a},get location(){return t(i,o)},listen(A){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(mw,p),l=A,()=>{i.removeEventListener(mw,p),l=null}},createHref(A){return e(i,A)},createURL:E,encodeLocation(A){let w=E(A);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:_,go(A){return o.go(A)}};return C}var _w;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(_w||(_w={}));function J1(t,e,n){return n===void 0&&(n="/"),j1(t,e,n)}function j1(t,e,n,r){let i=typeof e=="string"?so(e):e,s=uy(i.pathname||"/",n);if(s==null)return null;let o=ER(t);Q1(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=lV(s);a=sV(o[l],u)}return a}function ER(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(it(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Fi([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(it(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),ER(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:rV(u,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of TR(s.path))i(s,o,l)}),e}function TR(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=TR(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Q1(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:iV(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Y1=/^:[\w-]+$/,X1=3,Z1=2,eV=1,tV=10,nV=-2,yw=t=>t==="*";function rV(t,e){let n=t.split("/"),r=n.length;return n.some(yw)&&(r+=nV),e&&(r+=Z1),n.filter(i=>!yw(i)).reduce((i,s)=>i+(Y1.test(s)?X1:s===""?eV:tV),r)}function iV(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function sV(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,d=s==="/"?e:e.slice(s.length)||"/",p=oV({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),m=l.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Fi([s,p.pathname]),pathnameBase:fV(Fi([s,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(s=Fi([s,p.pathnameBase]))}return o}function oV(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=aV(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,d,p)=>{let{paramName:m,isOptional:_}=d;if(m==="*"){let C=a[p]||"";o=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const E=a[p];return _&&!E?u[m]=void 0:u[m]=(E||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function aV(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),af(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function lV(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return af(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function uy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const uV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cV=t=>uV.test(t);function dV(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?so(t):t,s;if(n)if(cV(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),af(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?s=vw(n.substring(1),"/"):s=vw(n,e)}else s=e;return{pathname:s,search:pV(r),hash:mV(i)}}function vw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Qp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hV(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function cy(t,e){let n=hV(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function dy(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=so(t):(i=xu({},t),it(!i.pathname||!i.pathname.includes("?"),Qp("?","pathname","search",i)),it(!i.pathname||!i.pathname.includes("#"),Qp("#","pathname","hash",i)),it(!i.search||!i.search.includes("#"),Qp("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}a=p>=0?e[p]:"/"}let l=dV(i,a),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Fi=t=>t.join("/").replace(/\/\/+/g,"/"),fV=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),pV=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mV=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function gV(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const wR=["post","put","patch","delete"];new Set(wR);const _V=["get",...wR];new Set(_V);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pu(){return Pu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pu.apply(this,arguments)}const hy=O.createContext(null),yV=O.createContext(null),rs=O.createContext(null),lf=O.createContext(null),ei=O.createContext({outlet:null,matches:[],isDataRoute:!1}),IR=O.createContext(null);function vV(t,e){let{relative:n}=e===void 0?{}:e;Fa()||it(!1);let{basename:r,navigator:i}=O.useContext(rs),{hash:s,pathname:o,search:a}=AR(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Fi([r,o])),i.createHref({pathname:l,search:a,hash:s})}function Fa(){return O.useContext(lf)!=null}function oo(){return Fa()||it(!1),O.useContext(lf).location}function SR(t){O.useContext(rs).static||O.useLayoutEffect(t)}function or(){let{isDataRoute:t}=O.useContext(ei);return t?DV():EV()}function EV(){Fa()||it(!1);let t=O.useContext(hy),{basename:e,future:n,navigator:r}=O.useContext(rs),{matches:i}=O.useContext(ei),{pathname:s}=oo(),o=JSON.stringify(cy(i,n.v7_relativeSplatPath)),a=O.useRef(!1);return SR(()=>{a.current=!0}),O.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let p=dy(u,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Fi([e,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[e,r,o,s,t])}function TV(){let{matches:t}=O.useContext(ei),e=t[t.length-1];return e?e.params:{}}function AR(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=O.useContext(rs),{matches:i}=O.useContext(ei),{pathname:s}=oo(),o=JSON.stringify(cy(i,r.v7_relativeSplatPath));return O.useMemo(()=>dy(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function wV(t,e){return IV(t,e)}function IV(t,e,n,r){Fa()||it(!1);let{navigator:i}=O.useContext(rs),{matches:s}=O.useContext(ei),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=oo(),d;if(e){var p;let A=typeof e=="string"?so(e):e;l==="/"||(p=A.pathname)!=null&&p.startsWith(l)||it(!1),d=A}else d=u;let m=d.pathname||"/",_=m;if(l!=="/"){let A=l.replace(/^\//,"").split("/");_="/"+m.replace(/^\//,"").split("/").slice(A.length).join("/")}let E=J1(t,{pathname:_}),C=xV(E&&E.map(A=>Object.assign({},A,{params:Object.assign({},a,A.params),pathname:Fi([l,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?l:Fi([l,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),s,n,r);return e&&C?O.createElement(lf.Provider,{value:{location:Pu({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ri.Pop}},C):C}function SV(){let t=kV(),e=gV(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),n?O.createElement("pre",{style:i},n):null,null)}const AV=O.createElement(SV,null);class CV extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?O.createElement(ei.Provider,{value:this.props.routeContext},O.createElement(IR.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RV(t){let{routeContext:e,match:n,children:r}=t,i=O.useContext(hy);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),O.createElement(ei.Provider,{value:e},r)}function xV(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);d>=0||it(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:m,errors:_}=n,E=p.route.loader&&m[p.route.id]===void 0&&(!_||_[p.route.id]===void 0);if(p.route.lazy||E){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,p,m)=>{let _,E=!1,C=null,A=null;n&&(_=a&&p.route.id?a[p.route.id]:void 0,C=p.route.errorElement||AV,l&&(u<0&&m===0?(MV("route-fallback"),E=!0,A=null):u===m&&(E=!0,A=p.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,m+1)),T=()=>{let S;return _?S=C:E?S=A:p.route.Component?S=O.createElement(p.route.Component,null):p.route.element?S=p.route.element:S=d,O.createElement(RV,{match:p,routeContext:{outlet:d,matches:w,isDataRoute:n!=null},children:S})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?O.createElement(CV,{location:n.location,revalidation:n.revalidation,component:C,error:_,children:T(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):T()},null)}var CR=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(CR||{}),RR=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(RR||{});function PV(t){let e=O.useContext(hy);return e||it(!1),e}function NV(t){let e=O.useContext(yV);return e||it(!1),e}function bV(t){let e=O.useContext(ei);return e||it(!1),e}function xR(t){let e=bV(),n=e.matches[e.matches.length-1];return n.route.id||it(!1),n.route.id}function kV(){var t;let e=O.useContext(IR),n=NV(),r=xR();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function DV(){let{router:t}=PV(CR.UseNavigateStable),e=xR(RR.UseNavigateStable),n=O.useRef(!1);return SR(()=>{n.current=!0}),O.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Pu({fromRouteId:e},s)))},[t,e])}const Ew={};function MV(t,e,n){Ew[t]||(Ew[t]=!0)}function VV(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function PR(t){let{to:e,replace:n,state:r,relative:i}=t;Fa()||it(!1);let{future:s,static:o}=O.useContext(rs),{matches:a}=O.useContext(ei),{pathname:l}=oo(),u=or(),d=dy(e,cy(a,s.v7_relativeSplatPath),l,i==="path"),p=JSON.stringify(d);return O.useEffect(()=>u(JSON.parse(p),{replace:n,state:r,relative:i}),[u,p,i,n,r]),null}function ur(t){it(!1)}function LV(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Ri.Pop,navigator:s,static:o=!1,future:a}=t;Fa()&&it(!1);let l=e.replace(/^\/*/,"/"),u=O.useMemo(()=>({basename:l,navigator:s,static:o,future:Pu({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=so(r));let{pathname:d="/",search:p="",hash:m="",state:_=null,key:E="default"}=r,C=O.useMemo(()=>{let A=uy(d,l);return A==null?null:{location:{pathname:A,search:p,hash:m,state:_,key:E},navigationType:i}},[l,d,p,m,_,E,i]);return C==null?null:O.createElement(rs.Provider,{value:u},O.createElement(lf.Provider,{children:n,value:C}))}function UV(t){let{children:e,location:n}=t;return wV(fg(e),n)}new Promise(()=>{});function fg(t,e){e===void 0&&(e=[]);let n=[];return O.Children.forEach(t,(r,i)=>{if(!O.isValidElement(r))return;let s=[...e,i];if(r.type===O.Fragment){n.push.apply(n,fg(r.props.children,s));return}r.type!==ur&&it(!1),!r.props.index||!r.props.children||it(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=fg(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pg(){return pg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pg.apply(this,arguments)}function FV(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function OV(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function BV(t,e){return t.button===0&&(!e||e==="_self")&&!OV(t)}function mg(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function qV(t,e){let n=mg(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(s=>{n.append(i,s)})}),n}const GV=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],$V="6";try{window.__reactRouterVersion=$V}catch{}const HV="startTransition",Tw=DD[HV];function zV(t){let{basename:e,children:n,future:r,window:i}=t,s=O.useRef();s.current==null&&(s.current=z1({window:i,v5Compat:!0}));let o=s.current,[a,l]=O.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=O.useCallback(p=>{u&&Tw?Tw(()=>l(p)):l(p)},[l,u]);return O.useLayoutEffect(()=>o.listen(d),[o,d]),O.useEffect(()=>VV(r),[r]),O.createElement(LV,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const WV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",KV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wi=O.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:d,viewTransition:p}=e,m=FV(e,GV),{basename:_}=O.useContext(rs),E,C=!1;if(typeof u=="string"&&KV.test(u)&&(E=u,WV))try{let S=new URL(window.location.href),D=u.startsWith("//")?new URL(S.protocol+u):new URL(u),L=uy(D.pathname,_);D.origin===S.origin&&L!=null?u=L+D.search+D.hash:C=!0}catch{}let A=vV(u,{relative:i}),w=JV(u,{replace:o,state:a,target:l,preventScrollReset:d,relative:i,viewTransition:p});function T(S){r&&r(S),S.defaultPrevented||w(S)}return O.createElement("a",pg({},m,{href:E||A,onClick:C||s?r:T,ref:n,target:l}))});var ww;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ww||(ww={}));var Iw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Iw||(Iw={}));function JV(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=or(),u=oo(),d=AR(t,{relative:o});return O.useCallback(p=>{if(BV(p,n)){p.preventDefault();let m=r!==void 0?r:ph(u)===ph(d);l(t,{replace:m,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,d,r,i,n,t,s,o,a])}function jV(t){let e=O.useRef(mg(t)),n=O.useRef(!1),r=oo(),i=O.useMemo(()=>qV(r.search,n.current?null:e.current),[r.search]),s=or(),o=O.useCallback((a,l)=>{const u=mg(typeof a=="function"?a(i):a);n.current=!0,s("?"+u,l)},[s,i]);return[i,o]}var Sw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},QV=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},bR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=s>>2,p=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,_=u&63;l||(_=64,o||(m=64)),r.push(n[d],n[p],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(NR(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):QV(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||p==null)throw new YV;const m=s<<2|a>>4;if(r.push(m),u!==64){const _=a<<4&240|u>>2;if(r.push(_),p!==64){const E=u<<6&192|p;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class YV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XV=function(t){const e=NR(t);return bR.encodeByteArray(e,!0)},mh=function(t){return XV(t).replace(/\./g,"")},kR=function(t){try{return bR.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gh(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!ZV(n)||(t[n]=gh(t[n],e[n]));return t}function ZV(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL=()=>DR().__FIREBASE_DEFAULTS__,tL=()=>{if(typeof process>"u"||typeof Sw>"u")return;const t=Sw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},nL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&kR(t[1]);return e&&JSON.parse(e)},fy=()=>{try{return eL()||tL()||nL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},MR=()=>{var t;return(t=fy())===null||t===void 0?void 0:t.config},rL=t=>{var e;return(e=fy())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[mh(JSON.stringify(n)),mh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ke())}function py(){var t;const e=(t=fy())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function oL(){return typeof window<"u"||LR()}function LR(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function aL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function UR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function my(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function FR(){const t=Ke();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function OR(){return!py()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Nu(){try{return typeof indexedDB=="object"}catch{return!1}}function lL(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL="FirebaseError";class Ht extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=uL,Object.setPrototypeOf(this,Ht.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ao.prototype.create)}}class ao{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?cL(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ht(i,a,r)}}function cL(t,e){return t.replace(dL,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const dL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Cw(s)&&Cw(o)){if(!bu(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Cw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Wo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Fl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function BR(t,e){const n=new fL(t,e);return n.subscribe.bind(n)}class fL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");pL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Yp),i.error===void 0&&(i.error=Yp),i.complete===void 0&&(i.complete=Yp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Yp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(t){return t&&t._delegate?t._delegate:t}class Hn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new iL;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_L(e))try{this.getOrInitializeService({instanceIdentifier:vs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=vs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vs){return this.instances.has(e)}getOptions(e=vs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:gL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=vs){return this.component?this.component.multipleInstances?e:vs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gL(t){return t===vs?void 0:t}function _L(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new mL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy=[];var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const GR={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},yL=de.INFO,vL={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},EL=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=vL[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uf{constructor(e){this.name=e,this._logLevel=yL,this._logHandler=EL,this._userLogHandler=null,gy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}function TL(t){gy.forEach(e=>{e.setLogLevel(t)})}function wL(t,e){for(const n of gy){let r=null;e&&e.level&&(r=GR[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(r??i.logLevel)&&t({level:de[s].toLowerCase(),message:a,args:o,type:i.name})}}}const IL=(t,e)=>e.some(n=>t instanceof n);let Rw,xw;function SL(){return Rw||(Rw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AL(){return xw||(xw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $R=new WeakMap,gg=new WeakMap,HR=new WeakMap,Xp=new WeakMap,_y=new WeakMap;function CL(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Oi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&$R.set(n,t)}).catch(()=>{}),_y.set(e,t),e}function RL(t){if(gg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});gg.set(t,e)}let _g={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return gg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||HR.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function xL(t){_g=t(_g)}function PL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Zp(this),e,...n);return HR.set(r,e.sort?e.sort():[e]),Oi(r)}:AL().includes(t)?function(...e){return t.apply(Zp(this),e),Oi($R.get(this))}:function(...e){return Oi(t.apply(Zp(this),e))}}function NL(t){return typeof t=="function"?PL(t):(t instanceof IDBTransaction&&RL(t),IL(t,SL())?new Proxy(t,_g):t)}function Oi(t){if(t instanceof IDBRequest)return CL(t);if(Xp.has(t))return Xp.get(t);const e=NL(t);return e!==t&&(Xp.set(t,e),_y.set(e,t)),e}const Zp=t=>_y.get(t);function bL(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Oi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Oi(o.result),l.oldVersion,l.newVersion,Oi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const kL=["get","getKey","getAll","getAllKeys","count"],DL=["put","add","delete","clear"],em=new Map;function Pw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(em.get(e))return em.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=DL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||kL.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return em.set(e,s),s}xL(t=>({...t,get:(e,n,r)=>Pw(e,n)||t.get(e,n,r),has:(e,n)=>!!Pw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(VL(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function VL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const _h="@firebase/app",yg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr=new uf("@firebase/app"),LL="@firebase/app-compat",UL="@firebase/analytics-compat",FL="@firebase/analytics",OL="@firebase/app-check-compat",BL="@firebase/app-check",qL="@firebase/auth",GL="@firebase/auth-compat",$L="@firebase/database",HL="@firebase/data-connect",zL="@firebase/database-compat",WL="@firebase/functions",KL="@firebase/functions-compat",JL="@firebase/installations",jL="@firebase/installations-compat",QL="@firebase/messaging",YL="@firebase/messaging-compat",XL="@firebase/performance",ZL="@firebase/performance-compat",eU="@firebase/remote-config",tU="@firebase/remote-config-compat",nU="@firebase/storage",rU="@firebase/storage-compat",iU="@firebase/firestore",sU="@firebase/vertexai-preview",oU="@firebase/firestore-compat",aU="firebase",lU="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i="[DEFAULT]",uU={[_h]:"fire-core",[LL]:"fire-core-compat",[FL]:"fire-analytics",[UL]:"fire-analytics-compat",[BL]:"fire-app-check",[OL]:"fire-app-check-compat",[qL]:"fire-auth",[GL]:"fire-auth-compat",[$L]:"fire-rtdb",[HL]:"fire-data-connect",[zL]:"fire-rtdb-compat",[WL]:"fire-fn",[KL]:"fire-fn-compat",[JL]:"fire-iid",[jL]:"fire-iid-compat",[QL]:"fire-fcm",[YL]:"fire-fcm-compat",[XL]:"fire-perf",[ZL]:"fire-perf-compat",[eU]:"fire-rc",[tU]:"fire-rc-compat",[nU]:"fire-gcs",[rU]:"fire-gcs-compat",[iU]:"fire-fst",[oU]:"fire-fst-compat",[sU]:"fire-vertex","fire-js":"fire-js",[aU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=new Map,_a=new Map,ya=new Map;function ku(t,e){try{t.container.addComponent(e)}catch(n){Kr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function zR(t,e){t.container.addOrOverwriteComponent(e)}function Jr(t){const e=t.name;if(ya.has(e))return Kr.debug(`There were multiple attempts to register component ${e}.`),!1;ya.set(e,t);for(const n of Hi.values())ku(n,t);for(const n of _a.values())ku(n,t);return!0}function WR(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function cU(t,e,n=$i){WR(t,e).clearInstance(n)}function KR(t){return t.options!==void 0}function Ye(t){return t.settings!==void 0}function dU(){ya.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bn=new ao("app","Firebase",hU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let JR=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU extends JR{constructor(e,n,r,i){const s=n.automaticDataCollectionEnabled!==void 0?n.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{const a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},n),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,xn(_h,yg,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){vy(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Bn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=lU;function yy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:$i,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Bn.create("bad-app-name",{appName:String(i)});if(n||(n=MR()),!n)throw Bn.create("no-options");const s=Hi.get(i);if(s){if(bu(n,s.options)&&bu(r,s.config))return s;throw Bn.create("duplicate-app",{appName:i})}const o=new qR(i);for(const l of ya.values())o.addComponent(l);const a=new JR(n,r,o);return Hi.set(i,a),a}function pU(t,e){if(oL()&&!LR())throw Bn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let n;KR(t)?n=t.options:n=t;const r=Object.assign(Object.assign({},e),n);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const i=u=>[...u].reduce((d,p)=>Math.imul(31,d)+p.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Bn.create("finalization-registry-not-supported",{});const s=""+i(JSON.stringify(r)),o=_a.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;const a=new qR(s);for(const u of ya.values())a.addComponent(u);const l=new fU(n,e,s,a);return _a.set(s,l),l}function mU(t=$i){const e=Hi.get(t);if(!e&&t===$i&&MR())return yy();if(!e)throw Bn.create("no-app",{appName:t});return e}function gU(){return Array.from(Hi.values())}async function vy(t){let e=!1;const n=t.name;Hi.has(n)?(e=!0,Hi.delete(n)):_a.has(n)&&t.decRefCount()<=0&&(_a.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function xn(t,e,n){var r;let i=(r=uU[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Kr.warn(a.join(" "));return}Jr(new Hn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function jR(t,e){if(t!==null&&typeof t!="function")throw Bn.create("invalid-log-argument");wL(t,e)}function QR(t){TL(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _U="firebase-heartbeat-database",yU=1,Du="firebase-heartbeat-store";let tm=null;function YR(){return tm||(tm=bL(_U,yU,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Du)}catch(n){console.warn(n)}}}}).catch(t=>{throw Bn.create("idb-open",{originalErrorMessage:t.message})})),tm}async function vU(t){try{const n=(await YR()).transaction(Du),r=await n.objectStore(Du).get(XR(t));return await n.done,r}catch(e){if(e instanceof Ht)Kr.warn(e.message);else{const n=Bn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Kr.warn(n.message)}}}async function Nw(t,e){try{const r=(await YR()).transaction(Du,"readwrite");await r.objectStore(Du).put(e,XR(t)),await r.done}catch(n){if(n instanceof Ht)Kr.warn(n.message);else{const r=Bn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Kr.warn(r.message)}}}function XR(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=1024,TU=30*24*60*60*1e3;class wU{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new SU(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=bw();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=TU}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Kr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=bw(),{heartbeatsToSend:r,unsentEntries:i}=IU(this._heartbeatsCache.heartbeats),s=mh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Kr.warn(n),""}}}function bw(){return new Date().toISOString().substring(0,10)}function IU(t,e=EU){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),kw(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),kw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class SU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Nu()?lL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await vU(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Nw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Nw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function kw(t){return mh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AU(t){Jr(new Hn("platform-logger",e=>new ML(e),"PRIVATE")),Jr(new Hn("heartbeat",e=>new wU(e),"PRIVATE")),xn(_h,yg,t),xn(_h,yg,"esm2017"),xn("fire-js","")}AU("");const CU=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Ht,SDK_VERSION:ti,_DEFAULT_ENTRY_NAME:$i,_addComponent:ku,_addOrOverwriteComponent:zR,_apps:Hi,_clearComponents:dU,_components:ya,_getProvider:WR,_isFirebaseApp:KR,_isFirebaseServerApp:Ye,_registerComponent:Jr,_removeServiceInstance:cU,_serverApps:_a,deleteApp:vy,getApp:mU,getApps:gU,initializeApp:yy,initializeServerApp:pU,onLog:jR,registerVersion:xn,setLogLevel:QR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RU{constructor(e,n){this._delegate=e,this.firebase=n,ku(e,new Hn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),vy(this._delegate)))}_getService(e,n=$i){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=$i){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){ku(this._delegate,e)}_addOrOverwriteComponent(e){zR(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xU={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Dw=new ao("app-compat","Firebase",xU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:xn,setLogLevel:QR,onLog:jR,apps:null,SDK_VERSION:ti,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:CU}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||$i,!Aw(e,u))throw Dw.create("no-app",{appName:u});return e[u]}i.App=t;function s(u,d={}){const p=yy(u,d);if(Aw(e,p.name))return e[p.name];const m=new t(p,n);return e[p.name]=m,m}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const d=u.name,p=d.replace("-compat","");if(Jr(u)&&u.type==="PUBLIC"){const m=(_=i())=>{if(typeof _[p]!="function")throw Dw.create("invalid-app-argument",{appName:d});return _[p]()};u.serviceProps!==void 0&&gh(m,u.serviceProps),n[p]=m,t.prototype[p]=function(..._){return this._getService.bind(this,d).apply(this,u.multipleInstances?_:[])}}return u.type==="PUBLIC"?n[p]:null}function l(u,d){return d==="serverAuth"?null:d}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(){const t=PU(RU);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:ZR,extendNamespace:e,createSubscribe:BR,ErrorFactory:ao,deepExtend:gh});function e(n){gh(t,n)}return t}const NU=ZR();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw=new uf("@firebase/app-compat"),bU="@firebase/app-compat",kU="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(t){xn(bU,kU,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const t=DR();if(t.firebase!==void 0){Mw.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=t.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Mw.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const zn=NU;DU();var MU="firebase",VU="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zn.registerVersion(MU,VU,"app-compat");function Ey(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}const Il={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},wo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function ex(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const UU=LU,FU=ex,tx=new ao("auth","Firebase",ex());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new uf("@firebase/auth");function OU(t,...e){yh.logLevel<=de.WARN&&yh.warn(`Auth (${ti}): ${t}`,...e)}function Nd(t,...e){yh.logLevel<=de.ERROR&&yh.error(`Auth (${ti}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t,...e){throw wy(t,...e)}function mt(t,...e){return wy(t,...e)}function Ty(t,e,n){const r=Object.assign(Object.assign({},FU()),{[e]:n});return new ao("auth","Firebase",r).create(e,{appName:t.name})}function wt(t){return Ty(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ba(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Dt(t,"argument-error"),Ty(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return tx.create(t,...e)}function W(t,e,...n){if(!t)throw wy(e,...n)}function _r(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Nd(e),new Error(e)}function sr(t,e){t||_r(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Iy(){return Vw()==="http:"||Vw()==="https:"}function Vw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Iy()||UR()||"connection"in navigator)?navigator.onLine:!0}function qU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n){this.shortDelay=e,this.longDelay=n,sr(n>e,"Short delay should be less than long delay!"),this.isMobile=sL()||my()}get(){return BU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sy(t,e){sr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_r("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_r("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_r("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $U=new ic(3e4,6e4);function et(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function tt(t,e,n,r,i={}){return rx(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Oa(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return aL()||(u.referrerPolicy="no-referrer"),nx.fetch()(ix(t,t.config.apiHost,n,a),u)})}async function rx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},GU),e);try{const i=new zU(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ol(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ol(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ol(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ol(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Ty(t,d,u);Dt(t,d)}}catch(i){if(i instanceof Ht)throw i;Dt(t,"network-request-failed",{message:String(i)})}}async function ni(t,e,n,r,i={}){const s=await tt(t,e,n,r,i);return"mfaPendingCredential"in s&&Dt(t,"multi-factor-auth-required",{_serverResponse:s}),s}function ix(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Sy(t.config,i):`${t.config.apiScheme}://${i}`}function HU(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(mt(this.auth,"network-request-failed")),$U.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ol(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=mt(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t){return t!==void 0&&t.getResponse!==void 0}function Uw(t){return t!==void 0&&t.enterprise!==void 0}class WU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return HU(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KU(t){return(await tt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function JU(t,e){return tt(t,"GET","/v2/recaptchaConfig",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jU(t,e){return tt(t,"POST","/v1/accounts:delete",e)}async function QU(t,e){return tt(t,"POST","/v1/accounts:update",e)}async function sx(t,e){return tt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YU(t,e=!1){const n=ne(t),r=await n.getIdToken(e),i=cf(r);W(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:tu(nm(i.auth_time)),issuedAtTime:tu(nm(i.iat)),expirationTime:tu(nm(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function nm(t){return Number(t)*1e3}function cf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Nd("JWT malformed, contained fewer than 3 sections"),null;try{const i=kR(n);return i?JSON.parse(i):(Nd("Failed to decode base64 JWT payload"),null)}catch(i){return Nd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Fw(t){const e=cf(t);return W(e,"internal-error"),W(typeof e.exp<"u","internal-error"),W(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jr(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ht&&XU(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function XU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=tu(this.lastLoginAt),this.creationTime=tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vu(t){var e;const n=t.auth,r=await t.getIdToken(),i=await jr(t,sx(n,{idToken:r}));W(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?ox(s.providerUserInfo):[],a=tF(t.providerData,o),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new vg(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function eF(t){const e=ne(t);await Vu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tF(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function ox(t){return t.map(e=>{var{providerId:n}=e,r=Ey(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nF(t,e){const n=await rx(t,{},async()=>{const r=Oa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=ix(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",nx.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function rF(t,e){return tt(t,"POST","/v2/accounts:revokeToken",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){W(e.idToken,"internal-error"),W(typeof e.idToken<"u","internal-error"),W(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Fw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){W(e.length!==0,"internal-error");const n=Fw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(W(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await nF(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ta;return r&&(W(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(W(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(W(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ta,this.toJSON())}_performRefresh(){return _r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(t,e){W(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Lr{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Ey(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ZU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new vg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await jr(this,this.stsTokenManager.getToken(this.auth,e));return W(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return YU(this,e)}reload(){return eF(this)}_assign(e){this!==e&&(W(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Lr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){W(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Vu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ye(this.auth.app))return Promise.reject(wt(this.auth));const e=await this.getIdToken();return await jr(this,jU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,u,d;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,_=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(a=n.tenantId)!==null&&a!==void 0?a:void 0,A=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,w=(u=n.createdAt)!==null&&u!==void 0?u:void 0,T=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:D,isAnonymous:L,providerData:M,stsTokenManager:R}=n;W(S&&R,e,"internal-error");const I=ta.fromJSON(this.name,R);W(typeof S=="string",e,"internal-error"),pi(p,e.name),pi(m,e.name),W(typeof D=="boolean",e,"internal-error"),W(typeof L=="boolean",e,"internal-error"),pi(_,e.name),pi(E,e.name),pi(C,e.name),pi(A,e.name),pi(w,e.name),pi(T,e.name);const P=new Lr({uid:S,auth:e,email:m,emailVerified:D,displayName:p,isAnonymous:L,photoURL:E,phoneNumber:_,tenantId:C,stsTokenManager:I,createdAt:w,lastLoginAt:T});return M&&Array.isArray(M)&&(P.providerData=M.map(N=>Object.assign({},N))),A&&(P._redirectEventId=A),P}static async _fromIdTokenResponse(e,n,r=!1){const i=new ta;i.updateFromServerResponse(n);const s=new Lr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Vu(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];W(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?ox(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ta;a.updateFromIdToken(r);const l=new Lr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new vg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow=new Map;function Cn(t){sr(t instanceof Function,"Expected a class definition");let e=Ow.get(t);return e?(sr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ow.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ax.type="NONE";const va=ax;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(t,e,n){return`firebase:${t}:${e}:${n}`}class na{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Vs(this.userKey,i.apiKey,s),this.fullPersistenceKey=Vs("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Lr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new na(Cn(va),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Cn(va);const o=Vs(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){const p=Lr._fromJSON(e,d);u!==s&&(a=p),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new na(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new na(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hx(e))return"Blackberry";if(fx(e))return"Webos";if(ux(e))return"Safari";if((e.includes("chrome/")||cx(e))&&!e.includes("edge/"))return"Chrome";if(sc(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function lx(t=Ke()){return/firefox\//i.test(t)}function ux(t=Ke()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cx(t=Ke()){return/crios\//i.test(t)}function dx(t=Ke()){return/iemobile/i.test(t)}function sc(t=Ke()){return/android/i.test(t)}function hx(t=Ke()){return/blackberry/i.test(t)}function fx(t=Ke()){return/webos/i.test(t)}function oc(t=Ke()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function iF(t=Ke()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function sF(t=Ke()){var e;return oc(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function oF(){return FR()&&document.documentMode===10}function px(t=Ke()){return oc(t)||sc(t)||fx(t)||hx(t)||/windows phone/i.test(t)||dx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t,e=[]){let n;switch(t){case"Browser":n=Bw(Ke());break;case"Worker":n=`${Bw(Ke())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ti}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lF(t,e={}){return tt(t,"GET","/v2/passwordPolicy",et(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF=6;class cF{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:uF,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qw(this),this.idTokenSubscription=new qw(this),this.beforeStateQueue=new aF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Cn(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await na.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await sx(this,{idToken:e}),r=await Lr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Ye(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return W(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Vu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ye(this.app))return Promise.reject(wt(this));const n=e?ne(e):null;return n&&W(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&W(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ye(this.app)?Promise.reject(wt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ye(this.app)?Promise.reject(wt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Cn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lF(this),n=new cF(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ao("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await rF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Cn(e)||this._popupRedirectResolver;W(n,this,"argument-error"),this.redirectPersistenceManager=await na.create(this,[Cn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(W(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return W(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&OU(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Xe(t){return ne(t)}class qw{constructor(e){this.auth=e,this.observer=null,this.addObserver=BR(n=>this.observer=n)}get next(){return W(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ac={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hF(t){ac=t}function Ay(t){return ac.loadJS(t)}function fF(){return ac.recaptchaV2Script}function pF(){return ac.recaptchaEnterpriseScript}function mF(){return ac.gapiScript}function gx(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const gF="recaptcha-enterprise",_F="NO_RECAPTCHA";class yF{constructor(e){this.type=gF,this.auth=Xe(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{JU(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new WU(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;Uw(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(_F)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&Uw(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=pF();l.length!==0&&(l+=a),Ay(l).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Gw(t,e,n,r=!1){const i=new yF(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Lu(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Gw(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Gw(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}function vF(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Cn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function EF(t,e,n){const r=Xe(t);W(r._canInitEmulator,r,"emulator-config-failed"),W(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=_x(e),{host:o,port:a}=TF(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||wF()}function _x(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function TF(t){const e=_x(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:$w(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:$w(o)}}}function $w(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function wF(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return _r("not implemented")}_getIdTokenResponse(e){return _r("not implemented")}_linkToIdToken(e,n){return _r("not implemented")}_getReauthenticationResolver(e){return _r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yx(t,e){return tt(t,"POST","/v1/accounts:resetPassword",et(t,e))}async function IF(t,e){return tt(t,"POST","/v1/accounts:update",e)}async function SF(t,e){return tt(t,"POST","/v1/accounts:signUp",e)}async function AF(t,e){return tt(t,"POST","/v1/accounts:update",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CF(t,e){return ni(t,"POST","/v1/accounts:signInWithPassword",et(t,e))}async function df(t,e){return tt(t,"POST","/v1/accounts:sendOobCode",et(t,e))}async function RF(t,e){return df(t,e)}async function xF(t,e){return df(t,e)}async function PF(t,e){return df(t,e)}async function NF(t,e){return df(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bF(t,e){return ni(t,"POST","/v1/accounts:signInWithEmailLink",et(t,e))}async function kF(t,e){return ni(t,"POST","/v1/accounts:signInWithEmailLink",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu extends qa{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Uu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Uu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lu(e,n,"signInWithPassword",CF);case"emailLink":return bF(e,{email:this._email,oobCode:this._password});default:Dt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lu(e,r,"signUpPassword",SF);case"emailLink":return kF(e,{idToken:n,email:this._email,oobCode:this._password});default:Dt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qr(t,e){return ni(t,"POST","/v1/accounts:signInWithIdp",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF="http://localhost";class Ar extends qa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ar(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Dt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Ey(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Ar(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return qr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,qr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,qr(e,n)}buildRequest(){const e={requestUri:DF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Oa(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MF(t,e){return tt(t,"POST","/v1/accounts:sendVerificationCode",et(t,e))}async function VF(t,e){return ni(t,"POST","/v1/accounts:signInWithPhoneNumber",et(t,e))}async function LF(t,e){const n=await ni(t,"POST","/v1/accounts:signInWithPhoneNumber",et(t,e));if(n.temporaryProof)throw Ol(t,"account-exists-with-different-credential",n);return n}const UF={USER_NOT_FOUND:"user-not-found"};async function FF(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return ni(t,"POST","/v1/accounts:signInWithPhoneNumber",et(t,n),UF)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls extends qa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Ls({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Ls({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return VF(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return LF(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return FF(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new Ls({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function BF(t){const e=Wo(Fl(t)).link,n=e?Wo(Fl(e)).deep_link_id:null,r=Wo(Fl(t)).deep_link_id;return(r?Wo(Fl(r)).link:null)||r||n||e||t}class hf{constructor(e){var n,r,i,s,o,a;const l=Wo(Fl(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,p=OF((i=l.mode)!==null&&i!==void 0?i:null);W(u&&d&&p,"argument-error"),this.apiKey=u,this.operation=p,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=BF(e);try{return new hf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(){this.providerId=is.PROVIDER_ID}static credential(e,n){return Uu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=hf.parseLink(n);return W(r,"argument-error"),Uu._fromEmailAndCode(e,r.code,r.tenantId)}}is.PROVIDER_ID="password";is.EMAIL_PASSWORD_SIGN_IN_METHOD="password";is.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga extends ri{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ra extends Ga{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return W("providerId"in n&&"signInMethod"in n,"argument-error"),Ar._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return W(e.idToken||e.accessToken,"argument-error"),Ar._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ra.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ra.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!n&&!s||!a)return null;try{return new ra(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends Ga{constructor(){super("facebook.com")}static credential(e){return Ar._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hr.credential(e.oauthAccessToken)}catch{return null}}}hr.FACEBOOK_SIGN_IN_METHOD="facebook.com";hr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends Ga{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ar._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return fr.credentialFromTaggedObject(e)}static credentialFromError(e){return fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return fr.credential(n,r)}catch{return null}}}fr.GOOGLE_SIGN_IN_METHOD="google.com";fr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends Ga{constructor(){super("github.com")}static credential(e){return Ar._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pr.credential(e.oauthAccessToken)}catch{return null}}}pr.GITHUB_SIGN_IN_METHOD="github.com";pr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF="http://localhost";class Ea extends qa{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return qr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,qr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,qr(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new Ea(r,s)}static _create(e,n){return new Ea(e,n)}buildRequest(){return{requestUri:qF,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF="saml.";class vh extends ri{constructor(e){W(e.startsWith(GF),"argument-error"),super(e)}static credentialFromResult(e){return vh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return vh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Ea.fromJSON(e);return W(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return Ea._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr extends Ga{constructor(){super("twitter.com")}static credential(e,n){return Ar._fromParams({providerId:mr.PROVIDER_ID,signInMethod:mr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return mr.credentialFromTaggedObject(e)}static credentialFromError(e){return mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return mr.credential(n,r)}catch{return null}}}mr.TWITTER_SIGN_IN_METHOD="twitter.com";mr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vx(t,e){return ni(t,"POST","/v1/accounts:signUp",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Lr._fromIdTokenResponse(e,r,i),o=Hw(r);return new Wn({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Hw(r);return new Wn({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Hw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $F(t){var e;if(Ye(t.app))return Promise.reject(wt(t));const n=Xe(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Wn({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await vx(n,{returnSecureToken:!0}),i=await Wn._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh extends Ht{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Eh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Eh(e,n,r,i)}}function Ex(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Eh._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HF(t,e){const n=ne(t);await ff(!0,n,e);const{providerUserInfo:r}=await QU(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=Tx(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Cy(t,e,n=!1){const r=await jr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wn._forOperation(t,"link",r)}async function ff(t,e,n){await Vu(e);const r=Tx(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";W(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wx(t,e,n=!1){const{auth:r}=t;if(Ye(r.app))return Promise.reject(wt(r));const i="reauthenticate";try{const s=await jr(t,Ex(r,i,e,t),n);W(s.idToken,r,"internal-error");const o=cf(s.idToken);W(o,r,"internal-error");const{sub:a}=o;return W(t.uid===a,r,"user-mismatch"),Wn._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Dt(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ix(t,e,n=!1){if(Ye(t.app))return Promise.reject(wt(t));const r="signIn",i=await Ex(t,r,e),s=await Wn._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function pf(t,e){return Ix(Xe(t),e)}async function Sx(t,e){const n=ne(t);return await ff(!1,n,e.providerId),Cy(n,e)}async function Ax(t,e){return wx(ne(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zF(t,e){return ni(t,"POST","/v1/accounts:signInWithCustomToken",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WF(t,e){if(Ye(t.app))return Promise.reject(wt(t));const n=Xe(t),r=await zF(n,{token:e,returnSecureToken:!0}),i=await Wn._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Ry._fromServerResponse(e,n):"totpInfo"in n?xy._fromServerResponse(e,n):Dt(e,"internal-error")}}class Ry extends lc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Ry(n)}}class xy extends lc{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new xy(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(t,e,n){var r;W(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),W(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(W(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(W(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Py(t){const e=Xe(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function KF(t,e,n){const r=Xe(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&mf(r,i,n),await Lu(r,i,"getOobCode",xF)}async function JF(t,e,n){await yx(ne(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Py(t),r})}async function jF(t,e){await AF(ne(t),{oobCode:e})}async function Cx(t,e){const n=ne(t),r=await yx(n,{oobCode:e}),i=r.requestType;switch(W(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":W(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":W(r.mfaInfo,n,"internal-error");default:W(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=lc._fromServerResponse(Xe(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function QF(t,e){const{data:n}=await Cx(ne(t),e);return n.email}async function YF(t,e,n){if(Ye(t.app))return Promise.reject(wt(t));const r=Xe(t),o=await Lu(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vx).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Py(t),l}),a=await Wn._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function XF(t,e,n){return Ye(t.app)?Promise.reject(wt(t)):pf(ne(t),is.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Py(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZF(t,e,n){const r=Xe(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){W(a.handleCodeInApp,r,"argument-error"),a&&mf(r,o,a)}s(i,n),await Lu(r,i,"getOobCode",PF)}function eO(t,e){const n=hf.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function tO(t,e,n){if(Ye(t.app))return Promise.reject(wt(t));const r=ne(t),i=is.credentialWithLink(e,n||Mu());return W(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),pf(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nO(t,e){return tt(t,"POST","/v1/accounts:createAuthUri",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rO(t,e){const n=Iy()?Mu():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await nO(ne(t),r);return i||[]}async function iO(t,e){const n=ne(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&mf(n.auth,i,e);const{email:s}=await RF(n.auth,i);s!==t.email&&await t.reload()}async function sO(t,e,n){const r=ne(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&mf(r.auth,s,n);const{email:o}=await NF(r.auth,s);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(t,e){return tt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aO(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=ne(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await jr(r,oO(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function lO(t,e){const n=ne(t);return Ye(n.auth.app)?Promise.reject(wt(n.auth)):Rx(n,e,null)}function uO(t,e){return Rx(ne(t),null,e)}async function Rx(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await jr(t,IF(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cO(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const o=(n=(e=cf(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new ia(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new dO(s,i);case"github.com":return new hO(s,i);case"google.com":return new fO(s,i);case"twitter.com":return new pO(s,i,t.screenName||null);case"custom":case"anonymous":return new ia(s,null);default:return new ia(s,r,i)}}class ia{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class xx extends ia{constructor(e,n,r,i){super(e,n,r),this.username=i}}class dO extends ia{constructor(e,n){super(e,"facebook.com",n)}}class hO extends xx{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class fO extends ia{constructor(e,n){super(e,"google.com",n)}}class pO extends xx{constructor(e,n,r){super(e,"twitter.com",n,r)}}function mO(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:cO(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new Ns("enroll",e,n)}static _fromMfaPendingCredential(e){return new Ns("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Ns._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Ns._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Xe(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>lc._fromServerResponse(r,a));W(i.mfaPendingCredential,r,"internal-error");const o=Ns._fromMfaPendingCredential(i.mfaPendingCredential);return new Ny(o,s,async a=>{const l=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const u=Object.assign(Object.assign({},i),{idToken:l.idToken,refreshToken:l.refreshToken});switch(n.operationType){case"signIn":const d=await Wn._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return W(n.user,r,"internal-error"),Wn._forOperation(n.user,n.operationType,u);default:Dt(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function gO(t,e){var n;const r=ne(t),i=e;return W(e.customData.operationType,r,"argument-error"),W((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),Ny._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _O(t,e){return tt(t,"POST","/v2/accounts/mfaEnrollment:start",et(t,e))}function yO(t,e){return tt(t,"POST","/v2/accounts/mfaEnrollment:finalize",et(t,e))}function vO(t,e){return tt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",et(t,e))}class by{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>lc._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new by(e)}async getSession(){return Ns._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await jr(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await jr(this.user,vO(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const rm=new WeakMap;function EO(t){const e=ne(t);return rm.has(e)||rm.set(e,by._fromUser(e)),rm.get(e)}const Th="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Th,"1"),this.storage.removeItem(Th),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO=1e3,wO=10;class Nx extends Px{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=px(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);oF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,wO):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},TO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Nx.type="LOCAL";const ky=Nx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx extends Px{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}bx.type="SESSION";const Hs=bx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new gf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await IO(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=uc("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(){return window}function AO(t){ut().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(){return typeof ut().WorkerGlobalScope<"u"&&typeof ut().importScripts=="function"}async function CO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function xO(){return Dy()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx="firebaseLocalStorageDb",PO=1,wh="firebaseLocalStorage",Dx="fbase_key";class cc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function _f(t,e){return t.transaction([wh],e?"readwrite":"readonly").objectStore(wh)}function NO(){const t=indexedDB.deleteDatabase(kx);return new cc(t).toPromise()}function Eg(){const t=indexedDB.open(kx,PO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(wh,{keyPath:Dx})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(wh)?e(r):(r.close(),await NO(),e(await Eg()))})})}async function zw(t,e,n){const r=_f(t,!0).put({[Dx]:e,value:n});return new cc(r).toPromise()}async function bO(t,e){const n=_f(t,!1).get(e),r=await new cc(n).toPromise();return r===void 0?null:r.value}function Ww(t,e){const n=_f(t,!0).delete(e);return new cc(n).toPromise()}const kO=800,DO=3;class Mx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Eg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>DO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Dy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gf._getInstance(xO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await CO(),!this.activeServiceWorker)return;this.sender=new SO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Eg();return await zw(e,Th,"1"),await Ww(e,Th),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>zw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>bO(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ww(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=_f(i,!1).getAll();return new cc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Mx.type="LOCAL";const Fu=Mx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MO(t,e){return tt(t,"POST","/v2/accounts/mfaSignIn:start",et(t,e))}function VO(t,e){return tt(t,"POST","/v2/accounts/mfaSignIn:finalize",et(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=500,UO=6e4,rd=1e12;class FO{constructor(e){this.auth=e,this.counter=rd,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new OO(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||rd;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||rd;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||rd;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class OO{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;W(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=BO(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},UO)},LO))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function BO(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im=gx("rcb"),qO=new ic(3e4,6e4);class GO{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ut().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return W($O(n),e,"argument-error"),this.shouldResolveImmediately(n)&&Lw(ut().grecaptcha)?Promise.resolve(ut().grecaptcha):new Promise((r,i)=>{const s=ut().setTimeout(()=>{i(mt(e,"network-request-failed"))},qO.get());ut()[im]=()=>{ut().clearTimeout(s),delete ut()[im];const a=ut().grecaptcha;if(!a||!Lw(a)){i(mt(e,"internal-error"));return}const l=a.render;a.render=(u,d)=>{const p=l(u,d);return this.counter++,p},this.hostLanguage=n,r(a)};const o=`${fF()}?${Oa({onload:im,render:"explicit",hl:n})}`;Ay(o).catch(()=>{clearTimeout(s),i(mt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=ut().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function $O(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class HO{async load(e){return new FO(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="recaptcha",zO={theme:"light",type:"image"};let WO=class{constructor(e,n,r=Object.assign({},zO)){this.parameters=r,this.type=Vx,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Xe(e),this.isInvisible=this.parameters.size==="invisible",W(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;W(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new HO:new GO,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){W(!this.parameters.sitekey,this.auth,"argument-error"),W(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),W(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=ut()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){W(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){W(Iy()&&!Dy(),this.auth,"internal-error"),await KO(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await KU(this.auth);W(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return W(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function KO(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Ls._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function JO(t,e,n){if(Ye(t.app))return Promise.reject(wt(t));const r=Xe(t),i=await yf(r,e,ne(n));return new My(i,s=>pf(r,s))}async function jO(t,e,n){const r=ne(t);await ff(!1,r,"phone");const i=await yf(r.auth,e,ne(n));return new My(i,s=>Sx(r,s))}async function QO(t,e,n){const r=ne(t);if(Ye(r.auth.app))return Promise.reject(wt(r.auth));const i=await yf(r.auth,e,ne(n));return new My(i,s=>Ax(r,s))}async function yf(t,e,n){var r;const i=await n.verify();try{W(typeof i=="string",t,"argument-error"),W(n.type===Vx,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const o=s.session;if("phoneNumber"in s)return W(o.type==="enroll",t,"internal-error"),(await _O(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{W(o.type==="signin",t,"internal-error");const a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return W(a,t,"missing-multi-factor-info"),(await MO(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await MF(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{n._reset()}}async function YO(t,e){const n=ne(t);if(Ye(n.auth.app))return Promise.reject(wt(n.auth));await Cy(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zs=class bd{constructor(e){this.providerId=bd.PROVIDER_ID,this.auth=Xe(e)}verifyPhoneNumber(e,n){return yf(this.auth,e,ne(n))}static credential(e,n){return Ls._fromVerification(e,n)}static credentialFromResult(e){const n=e;return bd.credentialFromTaggedObject(n)}static credentialFromError(e){return bd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Ls._fromTokenResponse(n,r):null}};zs.PROVIDER_ID="phone";zs.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(t,e){return e?Cn(e):(W(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy extends qa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qr(e,this._buildIdpRequest())}_linkToIdToken(e,n){return qr(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return qr(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function XO(t){return Ix(t.auth,new Vy(t),t.bypassAuthState)}function ZO(t){const{auth:e,user:n}=t;return W(n,e,"internal-error"),wx(n,new Vy(t),t.bypassAuthState)}async function e2(t){const{auth:e,user:n}=t;return W(n,e,"internal-error"),Cy(n,new Vy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XO;case"linkViaPopup":case"linkViaRedirect":return e2;case"reauthViaPopup":case"reauthViaRedirect":return ZO;default:Dt(this.auth,"internal-error")}}resolve(e){sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=new ic(2e3,1e4);async function n2(t,e,n){if(Ye(t.app))return Promise.reject(mt(t,"operation-not-supported-in-this-environment"));const r=Xe(t);Ba(t,e,ri);const i=lo(r,n);return new Ur(r,"signInViaPopup",e,i).executeNotNull()}async function r2(t,e,n){const r=ne(t);if(Ye(r.auth.app))return Promise.reject(mt(r.auth,"operation-not-supported-in-this-environment"));Ba(r.auth,e,ri);const i=lo(r.auth,n);return new Ur(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function i2(t,e,n){const r=ne(t);Ba(r.auth,e,ri);const i=lo(r.auth,n);return new Ur(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class Ur extends Lx{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ur.currentPopupAction&&Ur.currentPopupAction.cancel(),Ur.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return W(e,this.auth,"internal-error"),e}async onExecution(){sr(this.filter.length===1,"Popup operations only handle one event");const e=uc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(mt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(mt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ur.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t2.get())};e()}}Ur.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2="pendingRedirect",nu=new Map;class o2 extends Lx{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=nu.get(this.auth._key());if(!e){try{const r=await a2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}nu.set(this.auth._key(),e)}return this.bypassAuthState||nu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function a2(t,e){const n=Fx(e),r=Ux(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function Ly(t,e){return Ux(t)._set(Fx(e),"true")}function l2(){nu.clear()}function Uy(t,e){nu.set(t._key(),e)}function Ux(t){return Cn(t._redirectPersistence)}function Fx(t){return Vs(s2,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t,e,n){return c2(t,e,n)}async function c2(t,e,n){if(Ye(t.app))return Promise.reject(wt(t));const r=Xe(t);Ba(t,e,ri),await r._initializationPromise;const i=lo(r,n);return await Ly(i,r),i._openRedirect(r,e,"signInViaRedirect")}function d2(t,e,n){return h2(t,e,n)}async function h2(t,e,n){const r=ne(t);if(Ba(r.auth,e,ri),Ye(r.auth.app))return Promise.reject(wt(r.auth));await r.auth._initializationPromise;const i=lo(r.auth,n);await Ly(i,r.auth);const s=await Ox(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function f2(t,e,n){return p2(t,e,n)}async function p2(t,e,n){const r=ne(t);Ba(r.auth,e,ri),await r.auth._initializationPromise;const i=lo(r.auth,n);await ff(!1,r,e.providerId),await Ly(i,r.auth);const s=await Ox(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function m2(t,e){return await Xe(t)._initializationPromise,vf(t,e,!1)}async function vf(t,e,n=!1){if(Ye(t.app))return Promise.reject(wt(t));const r=Xe(t),i=lo(r,e),o=await new o2(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function Ox(t){const e=uc(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2=10*60*1e3;class Bx{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!qx(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(mt(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=g2&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kw(e))}saveEventToCache(e){this.cachedEventUids.add(Kw(e)),this.lastProcessedEventTime=Date.now()}}function Kw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function qx({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qx(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gx(t,e={}){return tt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,v2=/^https?/;async function E2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Gx(t);for(const n of e)try{if(T2(n))return}catch{}Dt(t,"unauthorized-domain")}function T2(t){const e=Mu(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!v2.test(n))return!1;if(y2.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=new ic(3e4,6e4);function Jw(){const t=ut().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function I2(t){return new Promise((e,n)=>{var r,i,s;function o(){Jw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jw(),n(mt(t,"network-request-failed"))},timeout:w2.get()})}if(!((i=(r=ut().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ut().gapi)===null||s===void 0)&&s.load)o();else{const a=gx("iframefcb");return ut()[a]=()=>{gapi.load?o():n(mt(t,"network-request-failed"))},Ay(`${mF()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw kd=null,e})}let kd=null;function S2(t){return kd=kd||I2(t),kd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A2=new ic(5e3,15e3),C2="__/auth/iframe",R2="emulator/auth/iframe",x2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},P2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function N2(t){const e=t.config;W(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Sy(e,R2):`https://${t.config.authDomain}/${C2}`,r={apiKey:e.apiKey,appName:t.name,v:ti},i=P2.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Oa(r).slice(1)}`}async function b2(t){const e=await S2(t),n=ut().gapi;return W(n,t,"internal-error"),e.open({where:document.body,url:N2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:x2,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=mt(t,"network-request-failed"),a=ut().setTimeout(()=>{s(o)},A2.get());function l(){ut().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},D2=500,M2=600,V2="_blank",L2="http://localhost";class jw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function U2(t,e,n,r=D2,i=M2){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},k2),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Ke().toLowerCase();n&&(a=cx(u)?V2:n),lx(u)&&(e=e||L2,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[_,E])=>`${m}${_}=${E},`,"");if(sF(u)&&a!=="_self")return F2(e||"",a),new jw(null);const p=window.open(e||"",a,d);W(p,t,"popup-blocked");try{p.focus()}catch{}return new jw(p)}function F2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2="__/auth/handler",B2="emulator/auth/handler",q2=encodeURIComponent("fac");async function Tg(t,e,n,r,i,s){W(t.config.authDomain,t,"auth-domain-config-required"),W(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ti,eventId:i};if(e instanceof ri){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",hL(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,p]of Object.entries(s||{}))o[d]=p}if(e instanceof Ga){const d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${q2}=${encodeURIComponent(l)}`:"";return`${G2(t)}?${Oa(a).slice(1)}${u}`}function G2({config:t}){return t.emulator?Sy(t,B2):`https://${t.authDomain}/${O2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm="webStorageSupport";class $2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Hs,this._completeRedirectFn=vf,this._overrideRedirectResult=Uy}async _openPopup(e,n,r,i){var s;sr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Tg(e,n,r,Mu(),i);return U2(e,o,uc())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Tg(e,n,r,Mu(),i);return AO(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(sr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await b2(e),r=new Bx(e);return n.register("authEvent",i=>(W(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(sm,{type:sm},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[sm];o!==void 0&&n(!!o),Dt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=E2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return px()||ux()||oc()}}const H2=$2;class z2{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return _r("unexpected MultiFactorSessionType")}}}class Fy extends z2{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Fy(e)}_finalizeEnroll(e,n,r){return yO(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return VO(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class $x{constructor(){}static assertion(e){return Fy._fromCredential(e)}}$x.FACTOR_ID="phone";var Qw="@firebase/auth",Yw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){W(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function J2(t){Jr(new Hn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;W(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mx(t)},u=new dF(r,i,s,l);return vF(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Jr(new Hn("auth-internal",e=>{const n=Xe(e.getProvider("auth").getImmediate());return(r=>new W2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),xn(Qw,Yw,K2(t)),xn(Qw,Yw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2=5*60;rL("authIdTokenMaxAge");function Q2(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}hF({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=mt("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",Q2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});J2("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2=2e3;async function X2(t,e,n){var r;const{BuildInfo:i}=Ws();sr(e.sessionId,"AuthEvent did not contain a session ID");const s=await rB(e.sessionId),o={};return oc()?o.ibi=i.packageName:sc()?o.apn=i.packageName:Dt(t,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Tg(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function Z2(t){const{BuildInfo:e}=Ws(),n={};oc()?n.iosBundleId=e.packageName:sc()?n.androidPackageName=e.packageName:Dt(t,"operation-not-supported-in-this-environment"),await Gx(t,n)}function eB(t){const{cordova:e}=Ws();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,iF()?"_blank":"_system","location=yes"),n(i)})})}async function tB(t,e,n){const{cordova:r}=Ws();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function l(){var p;s();const m=(p=r.plugins.browsertab)===null||p===void 0?void 0:p.close;typeof m=="function"&&m(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function u(){a||(a=window.setTimeout(()=>{o(mt(t,"redirect-cancelled-by-user"))},Y2))}function d(){(document==null?void 0:document.visibilityState)==="visible"&&u()}e.addPassiveListener(l),document.addEventListener("resume",u,!1),sc()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}}function nB(t){var e,n,r,i,s,o,a,l,u,d;const p=Ws();W(typeof((e=p==null?void 0:p.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),W(typeof((n=p==null?void 0:p.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),W(typeof((s=(i=(r=p==null?void 0:p.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),W(typeof((l=(a=(o=p==null?void 0:p.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||l===void 0?void 0:l.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),W(typeof((d=(u=p==null?void 0:p.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function rB(t){const e=iB(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function iB(t){if(sr(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sB=20;class oB extends Bx{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function aB(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:cB(),postBody:null,tenantId:t.tenantId,error:mt(t,"no-auth-event")}}function lB(t,e){return wg()._set(Ig(t),e)}async function Xw(t){const e=await wg()._get(Ig(t));return e&&await wg()._remove(Ig(t)),e}function uB(t,e){var n,r;const i=hB(e);if(i.includes("/__/auth/callback")){const s=Dd(i),o=s.firebaseError?dB(decodeURIComponent(s.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],l=a?mt(a):null;return l?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function cB(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<sB;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function wg(){return Cn(ky)}function Ig(t){return Vs("authEvent",t.config.apiKey,t.name)}function dB(t){try{return JSON.parse(t)}catch{return null}}function hB(t){const e=Dd(t),n=e.link?decodeURIComponent(e.link):void 0,r=Dd(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Dd(i).link||i||r||n||t}function Dd(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Wo(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB=500;class pB{constructor(){this._redirectPersistence=Hs,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=vf,this._overrideRedirectResult=Uy}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new oB(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Dt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){nB(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),l2(),await this._originValidation(e);const o=aB(e,r,i);await lB(e,o);const a=await X2(e,o,n),l=await eB(a);return tB(e,s,l)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Z2(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Ws(),o=setTimeout(async()=>{await Xw(e),n.onEvent(Zw())},fB),a=async d=>{clearTimeout(o);const p=await Xw(e);let m=null;p&&(d!=null&&d.url)&&(m=uB(p,d.url)),n.onEvent(m||Zw())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const l=i,u=`${s.packageName.toLowerCase()}://`;Ws().handleOpenURL=async d=>{if(d.toLowerCase().startsWith(u)&&a({url:d}),typeof l=="function")try{l(d)}catch(p){console.error(p)}}}}const mB=pB;function Zw(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:mt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gB(t,e){Xe(t)._logFramework(e)}var _B="@firebase/auth-compat",yB="0.5.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vB=1e3;function ru(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function EB(){return ru()==="http:"||ru()==="https:"}function Hx(t=Ke()){return!!((ru()==="file:"||ru()==="ionic:"||ru()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function TB(){return my()||py()}function wB(){return FR()&&(document==null?void 0:document.documentMode)===11}function IB(t=Ke()){return/Edge\/\d+/.test(t)}function SB(t=Ke()){return wB()||IB(t)}function zx(){try{const t=self.localStorage,e=uc();if(t)return t.setItem(e,"1"),t.removeItem(e),SB()?Nu():!0}catch{return Oy()&&Nu()}return!1}function Oy(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function om(){return(EB()||UR()||Hx())&&!TB()&&zx()&&!Oy()}function Wx(){return Hx()&&typeof document<"u"}async function AB(){return Wx()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},vB);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function CB(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn={LOCAL:"local",NONE:"none",SESSION:"session"},Sl=W,Kx="persistence";function RB(t,e){if(Sl(Object.values(Sn).includes(e),t,"invalid-persistence-type"),my()){Sl(e!==Sn.SESSION,t,"unsupported-persistence-type");return}if(py()){Sl(e===Sn.NONE,t,"unsupported-persistence-type");return}if(Oy()){Sl(e===Sn.NONE||e===Sn.LOCAL&&Nu(),t,"unsupported-persistence-type");return}Sl(e===Sn.NONE||zx(),t,"unsupported-persistence-type")}async function Sg(t){await t._initializationPromise;const e=Jx(),n=Vs(Kx,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function xB(t,e){const n=Jx();if(!n)return[];const r=Vs(Kx,t,e);switch(n.getItem(r)){case Sn.NONE:return[va];case Sn.LOCAL:return[Fu,Hs];case Sn.SESSION:return[Hs];default:return[]}}function Jx(){var t;try{return((t=CB())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PB=W;class xi{constructor(){this.browserResolver=Cn(H2),this.cordovaResolver=Cn(mB),this.underlyingResolver=null,this._redirectPersistence=Hs,this._completeRedirectFn=vf,this._overrideRedirectResult=Uy}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Wx()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return PB(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await AB();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(t){return t.unwrap()}function NB(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bB(t){return Qx(t)}function kB(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new DB(t,gO(t,e))}else if(r){const i=Qx(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function Qx(t){const{_tokenResponse:e}=t instanceof Ht?t.customData:t;if(!e)return null;if(!(t instanceof Ht)&&"temporaryProof"in e&&"phoneNumber"in e)return zs.credentialFromResult(t);const n=e.providerId;if(!n||n===Il.PASSWORD)return null;let r;switch(n){case Il.GOOGLE:r=fr;break;case Il.FACEBOOK:r=hr;break;case Il.GITHUB:r=pr;break;case Il.TWITTER:r=mr;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:l}=e;return!s&&!o&&!i&&!a?null:a?n.startsWith("saml.")?Ea._create(n,a):Ar._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:i,accessToken:s}):new ra(n).credential({idToken:i,accessToken:s,rawNonce:l})}return t instanceof Ht?r.credentialFromError(t):r.credentialFromResult(t)}function dn(t,e){return e.catch(n=>{throw n instanceof Ht&&kB(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:bB(n),additionalUserInfo:mO(n),user:Ef.getOrCreate(i)}})}async function Ag(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>dn(t,n.confirm(r))}}class DB{constructor(e,n){this.resolver=n,this.auth=NB(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return dn(jx(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ef=class Bl{constructor(e){this._delegate=e,this.multiFactor=EO(e)}static getOrCreate(e){return Bl.USER_MAP.has(e)||Bl.USER_MAP.set(e,new Bl(e)),Bl.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return dn(this.auth,Sx(this._delegate,e))}async linkWithPhoneNumber(e,n){return Ag(this.auth,jO(this._delegate,e,n))}async linkWithPopup(e){return dn(this.auth,i2(this._delegate,e,xi))}async linkWithRedirect(e){return await Sg(Xe(this.auth)),f2(this._delegate,e,xi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return dn(this.auth,Ax(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return Ag(this.auth,QO(this._delegate,e,n))}reauthenticateWithPopup(e){return dn(this.auth,r2(this._delegate,e,xi))}async reauthenticateWithRedirect(e){return await Sg(Xe(this.auth)),d2(this._delegate,e,xi)}sendEmailVerification(e){return iO(this._delegate,e)}async unlink(e){return await HF(this._delegate,e),this}updateEmail(e){return lO(this._delegate,e)}updatePassword(e){return uO(this._delegate,e)}updatePhoneNumber(e){return YO(this._delegate,e)}updateProfile(e){return aO(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return sO(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Ef.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al=W;class Cg{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Al(r,"invalid-api-key",{appName:e.name}),Al(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?xi:void 0;this._delegate=n.initialize({options:{persistence:MB(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(UU),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ef.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){EF(this._delegate,e,n)}applyActionCode(e){return jF(this._delegate,e)}checkActionCode(e){return Cx(this._delegate,e)}confirmPasswordReset(e,n){return JF(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return dn(this._delegate,YF(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return rO(this._delegate,e)}isSignInWithEmailLink(e){return eO(this._delegate,e)}async getRedirectResult(){Al(om(),this._delegate,"operation-not-supported-in-this-environment");const e=await m2(this._delegate,xi);return e?dn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){gB(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:o}=e0(e,n,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:o}=e0(e,n,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,n){return ZF(this._delegate,e,n)}sendPasswordResetEmail(e,n){return KF(this._delegate,e,n||void 0)}async setPersistence(e){RB(this._delegate,e);let n;switch(e){case Sn.SESSION:n=Hs;break;case Sn.LOCAL:n=await Cn(Fu)._isAvailable()?Fu:ky;break;case Sn.NONE:n=va;break;default:return Dt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return dn(this._delegate,$F(this._delegate))}signInWithCredential(e){return dn(this._delegate,pf(this._delegate,e))}signInWithCustomToken(e){return dn(this._delegate,WF(this._delegate,e))}signInWithEmailAndPassword(e,n){return dn(this._delegate,XF(this._delegate,e,n))}signInWithEmailLink(e,n){return dn(this._delegate,tO(this._delegate,e,n))}signInWithPhoneNumber(e,n){return Ag(this._delegate,JO(this._delegate,e,n))}async signInWithPopup(e){return Al(om(),this._delegate,"operation-not-supported-in-this-environment"),dn(this._delegate,n2(this._delegate,e,xi))}async signInWithRedirect(e){return Al(om(),this._delegate,"operation-not-supported-in-this-environment"),await Sg(this._delegate),u2(this._delegate,e,xi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return QF(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Cg.Persistence=Sn;function e0(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:o=>i(o&&Ef.getOrCreate(o)),error:e,complete:n}}function MB(t,e){const n=xB(t,e);if(typeof self<"u"&&!n.includes(Fu)&&n.push(Fu),typeof window<"u")for(const r of[ky,Hs])n.includes(r)||n.push(r);return n.includes(va)||n.push(va),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(){this.providerId="phone",this._delegate=new zs(jx(zn.auth()))}static credential(e,n){return zs.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}By.PHONE_SIGN_IN_METHOD=zs.PHONE_SIGN_IN_METHOD;By.PROVIDER_ID=zs.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VB=W;class LB{constructor(e,n,r=zn.app()){var i;VB((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new WO(r.auth(),e,n),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB="auth-compat";function FB(t){t.INTERNAL.registerComponent(new Hn(UB,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Cg(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:wo.EMAIL_SIGNIN,PASSWORD_RESET:wo.PASSWORD_RESET,RECOVER_EMAIL:wo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:wo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:wo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:wo.VERIFY_EMAIL}},EmailAuthProvider:is,FacebookAuthProvider:hr,GithubAuthProvider:pr,GoogleAuthProvider:fr,OAuthProvider:ra,SAMLAuthProvider:vh,PhoneAuthProvider:By,PhoneMultiFactorGenerator:$x,RecaptchaVerifier:LB,TwitterAuthProvider:mr,Auth:Cg,AuthCredential:qa,Error:Ht}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(_B,yB)}FB(zn);var t0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Us,Yx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,I){function P(){}P.prototype=I.prototype,R.D=I.prototype,R.prototype=new P,R.prototype.constructor=R,R.C=function(N,k,V){for(var b=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)b[Te-2]=arguments[Te];return I.prototype[k].apply(N,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(R,I,P){P||(P=0);var N=Array(16);if(typeof I=="string")for(var k=0;16>k;++k)N[k]=I.charCodeAt(P++)|I.charCodeAt(P++)<<8|I.charCodeAt(P++)<<16|I.charCodeAt(P++)<<24;else for(k=0;16>k;++k)N[k]=I[P++]|I[P++]<<8|I[P++]<<16|I[P++]<<24;I=R.g[0],P=R.g[1],k=R.g[2];var V=R.g[3],b=I+(V^P&(k^V))+N[0]+3614090360&4294967295;I=P+(b<<7&4294967295|b>>>25),b=V+(k^I&(P^k))+N[1]+3905402710&4294967295,V=I+(b<<12&4294967295|b>>>20),b=k+(P^V&(I^P))+N[2]+606105819&4294967295,k=V+(b<<17&4294967295|b>>>15),b=P+(I^k&(V^I))+N[3]+3250441966&4294967295,P=k+(b<<22&4294967295|b>>>10),b=I+(V^P&(k^V))+N[4]+4118548399&4294967295,I=P+(b<<7&4294967295|b>>>25),b=V+(k^I&(P^k))+N[5]+1200080426&4294967295,V=I+(b<<12&4294967295|b>>>20),b=k+(P^V&(I^P))+N[6]+2821735955&4294967295,k=V+(b<<17&4294967295|b>>>15),b=P+(I^k&(V^I))+N[7]+4249261313&4294967295,P=k+(b<<22&4294967295|b>>>10),b=I+(V^P&(k^V))+N[8]+1770035416&4294967295,I=P+(b<<7&4294967295|b>>>25),b=V+(k^I&(P^k))+N[9]+2336552879&4294967295,V=I+(b<<12&4294967295|b>>>20),b=k+(P^V&(I^P))+N[10]+4294925233&4294967295,k=V+(b<<17&4294967295|b>>>15),b=P+(I^k&(V^I))+N[11]+2304563134&4294967295,P=k+(b<<22&4294967295|b>>>10),b=I+(V^P&(k^V))+N[12]+1804603682&4294967295,I=P+(b<<7&4294967295|b>>>25),b=V+(k^I&(P^k))+N[13]+4254626195&4294967295,V=I+(b<<12&4294967295|b>>>20),b=k+(P^V&(I^P))+N[14]+2792965006&4294967295,k=V+(b<<17&4294967295|b>>>15),b=P+(I^k&(V^I))+N[15]+1236535329&4294967295,P=k+(b<<22&4294967295|b>>>10),b=I+(k^V&(P^k))+N[1]+4129170786&4294967295,I=P+(b<<5&4294967295|b>>>27),b=V+(P^k&(I^P))+N[6]+3225465664&4294967295,V=I+(b<<9&4294967295|b>>>23),b=k+(I^P&(V^I))+N[11]+643717713&4294967295,k=V+(b<<14&4294967295|b>>>18),b=P+(V^I&(k^V))+N[0]+3921069994&4294967295,P=k+(b<<20&4294967295|b>>>12),b=I+(k^V&(P^k))+N[5]+3593408605&4294967295,I=P+(b<<5&4294967295|b>>>27),b=V+(P^k&(I^P))+N[10]+38016083&4294967295,V=I+(b<<9&4294967295|b>>>23),b=k+(I^P&(V^I))+N[15]+3634488961&4294967295,k=V+(b<<14&4294967295|b>>>18),b=P+(V^I&(k^V))+N[4]+3889429448&4294967295,P=k+(b<<20&4294967295|b>>>12),b=I+(k^V&(P^k))+N[9]+568446438&4294967295,I=P+(b<<5&4294967295|b>>>27),b=V+(P^k&(I^P))+N[14]+3275163606&4294967295,V=I+(b<<9&4294967295|b>>>23),b=k+(I^P&(V^I))+N[3]+4107603335&4294967295,k=V+(b<<14&4294967295|b>>>18),b=P+(V^I&(k^V))+N[8]+1163531501&4294967295,P=k+(b<<20&4294967295|b>>>12),b=I+(k^V&(P^k))+N[13]+2850285829&4294967295,I=P+(b<<5&4294967295|b>>>27),b=V+(P^k&(I^P))+N[2]+4243563512&4294967295,V=I+(b<<9&4294967295|b>>>23),b=k+(I^P&(V^I))+N[7]+1735328473&4294967295,k=V+(b<<14&4294967295|b>>>18),b=P+(V^I&(k^V))+N[12]+2368359562&4294967295,P=k+(b<<20&4294967295|b>>>12),b=I+(P^k^V)+N[5]+4294588738&4294967295,I=P+(b<<4&4294967295|b>>>28),b=V+(I^P^k)+N[8]+2272392833&4294967295,V=I+(b<<11&4294967295|b>>>21),b=k+(V^I^P)+N[11]+1839030562&4294967295,k=V+(b<<16&4294967295|b>>>16),b=P+(k^V^I)+N[14]+4259657740&4294967295,P=k+(b<<23&4294967295|b>>>9),b=I+(P^k^V)+N[1]+2763975236&4294967295,I=P+(b<<4&4294967295|b>>>28),b=V+(I^P^k)+N[4]+1272893353&4294967295,V=I+(b<<11&4294967295|b>>>21),b=k+(V^I^P)+N[7]+4139469664&4294967295,k=V+(b<<16&4294967295|b>>>16),b=P+(k^V^I)+N[10]+3200236656&4294967295,P=k+(b<<23&4294967295|b>>>9),b=I+(P^k^V)+N[13]+681279174&4294967295,I=P+(b<<4&4294967295|b>>>28),b=V+(I^P^k)+N[0]+3936430074&4294967295,V=I+(b<<11&4294967295|b>>>21),b=k+(V^I^P)+N[3]+3572445317&4294967295,k=V+(b<<16&4294967295|b>>>16),b=P+(k^V^I)+N[6]+76029189&4294967295,P=k+(b<<23&4294967295|b>>>9),b=I+(P^k^V)+N[9]+3654602809&4294967295,I=P+(b<<4&4294967295|b>>>28),b=V+(I^P^k)+N[12]+3873151461&4294967295,V=I+(b<<11&4294967295|b>>>21),b=k+(V^I^P)+N[15]+530742520&4294967295,k=V+(b<<16&4294967295|b>>>16),b=P+(k^V^I)+N[2]+3299628645&4294967295,P=k+(b<<23&4294967295|b>>>9),b=I+(k^(P|~V))+N[0]+4096336452&4294967295,I=P+(b<<6&4294967295|b>>>26),b=V+(P^(I|~k))+N[7]+1126891415&4294967295,V=I+(b<<10&4294967295|b>>>22),b=k+(I^(V|~P))+N[14]+2878612391&4294967295,k=V+(b<<15&4294967295|b>>>17),b=P+(V^(k|~I))+N[5]+4237533241&4294967295,P=k+(b<<21&4294967295|b>>>11),b=I+(k^(P|~V))+N[12]+1700485571&4294967295,I=P+(b<<6&4294967295|b>>>26),b=V+(P^(I|~k))+N[3]+2399980690&4294967295,V=I+(b<<10&4294967295|b>>>22),b=k+(I^(V|~P))+N[10]+4293915773&4294967295,k=V+(b<<15&4294967295|b>>>17),b=P+(V^(k|~I))+N[1]+2240044497&4294967295,P=k+(b<<21&4294967295|b>>>11),b=I+(k^(P|~V))+N[8]+1873313359&4294967295,I=P+(b<<6&4294967295|b>>>26),b=V+(P^(I|~k))+N[15]+4264355552&4294967295,V=I+(b<<10&4294967295|b>>>22),b=k+(I^(V|~P))+N[6]+2734768916&4294967295,k=V+(b<<15&4294967295|b>>>17),b=P+(V^(k|~I))+N[13]+1309151649&4294967295,P=k+(b<<21&4294967295|b>>>11),b=I+(k^(P|~V))+N[4]+4149444226&4294967295,I=P+(b<<6&4294967295|b>>>26),b=V+(P^(I|~k))+N[11]+3174756917&4294967295,V=I+(b<<10&4294967295|b>>>22),b=k+(I^(V|~P))+N[2]+718787259&4294967295,k=V+(b<<15&4294967295|b>>>17),b=P+(V^(k|~I))+N[9]+3951481745&4294967295,R.g[0]=R.g[0]+I&4294967295,R.g[1]=R.g[1]+(k+(b<<21&4294967295|b>>>11))&4294967295,R.g[2]=R.g[2]+k&4294967295,R.g[3]=R.g[3]+V&4294967295}r.prototype.u=function(R,I){I===void 0&&(I=R.length);for(var P=I-this.blockSize,N=this.B,k=this.h,V=0;V<I;){if(k==0)for(;V<=P;)i(this,R,V),V+=this.blockSize;if(typeof R=="string"){for(;V<I;)if(N[k++]=R.charCodeAt(V++),k==this.blockSize){i(this,N),k=0;break}}else for(;V<I;)if(N[k++]=R[V++],k==this.blockSize){i(this,N),k=0;break}}this.h=k,this.o+=I},r.prototype.v=function(){var R=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);R[0]=128;for(var I=1;I<R.length-8;++I)R[I]=0;var P=8*this.o;for(I=R.length-8;I<R.length;++I)R[I]=P&255,P/=256;for(this.u(R),R=Array(16),I=P=0;4>I;++I)for(var N=0;32>N;N+=8)R[P++]=this.g[I]>>>N&255;return R};function s(R,I){var P=a;return Object.prototype.hasOwnProperty.call(P,R)?P[R]:P[R]=I(R)}function o(R,I){this.h=I;for(var P=[],N=!0,k=R.length-1;0<=k;k--){var V=R[k]|0;N&&V==I||(P[k]=V,N=!1)}this.g=P}var a={};function l(R){return-128<=R&&128>R?s(R,function(I){return new o([I|0],0>I?-1:0)}):new o([R|0],0>R?-1:0)}function u(R){if(isNaN(R)||!isFinite(R))return p;if(0>R)return A(u(-R));for(var I=[],P=1,N=0;R>=P;N++)I[N]=R/P|0,P*=4294967296;return new o(I,0)}function d(R,I){if(R.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(R.charAt(0)=="-")return A(d(R.substring(1),I));if(0<=R.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(I,8)),N=p,k=0;k<R.length;k+=8){var V=Math.min(8,R.length-k),b=parseInt(R.substring(k,k+V),I);8>V?(V=u(Math.pow(I,V)),N=N.j(V).add(u(b))):(N=N.j(P),N=N.add(u(b)))}return N}var p=l(0),m=l(1),_=l(16777216);t=o.prototype,t.m=function(){if(C(this))return-A(this).m();for(var R=0,I=1,P=0;P<this.g.length;P++){var N=this.i(P);R+=(0<=N?N:4294967296+N)*I,I*=4294967296}return R},t.toString=function(R){if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(E(this))return"0";if(C(this))return"-"+A(this).toString(R);for(var I=u(Math.pow(R,6)),P=this,N="";;){var k=D(P,I).g;P=w(P,k.j(I));var V=((0<P.g.length?P.g[0]:P.h)>>>0).toString(R);if(P=k,E(P))return V+N;for(;6>V.length;)V="0"+V;N=V+N}},t.i=function(R){return 0>R?0:R<this.g.length?this.g[R]:this.h};function E(R){if(R.h!=0)return!1;for(var I=0;I<R.g.length;I++)if(R.g[I]!=0)return!1;return!0}function C(R){return R.h==-1}t.l=function(R){return R=w(this,R),C(R)?-1:E(R)?0:1};function A(R){for(var I=R.g.length,P=[],N=0;N<I;N++)P[N]=~R.g[N];return new o(P,~R.h).add(m)}t.abs=function(){return C(this)?A(this):this},t.add=function(R){for(var I=Math.max(this.g.length,R.g.length),P=[],N=0,k=0;k<=I;k++){var V=N+(this.i(k)&65535)+(R.i(k)&65535),b=(V>>>16)+(this.i(k)>>>16)+(R.i(k)>>>16);N=b>>>16,V&=65535,b&=65535,P[k]=b<<16|V}return new o(P,P[P.length-1]&-2147483648?-1:0)};function w(R,I){return R.add(A(I))}t.j=function(R){if(E(this)||E(R))return p;if(C(this))return C(R)?A(this).j(A(R)):A(A(this).j(R));if(C(R))return A(this.j(A(R)));if(0>this.l(_)&&0>R.l(_))return u(this.m()*R.m());for(var I=this.g.length+R.g.length,P=[],N=0;N<2*I;N++)P[N]=0;for(N=0;N<this.g.length;N++)for(var k=0;k<R.g.length;k++){var V=this.i(N)>>>16,b=this.i(N)&65535,Te=R.i(k)>>>16,Mt=R.i(k)&65535;P[2*N+2*k]+=b*Mt,T(P,2*N+2*k),P[2*N+2*k+1]+=V*Mt,T(P,2*N+2*k+1),P[2*N+2*k+1]+=b*Te,T(P,2*N+2*k+1),P[2*N+2*k+2]+=V*Te,T(P,2*N+2*k+2)}for(N=0;N<I;N++)P[N]=P[2*N+1]<<16|P[2*N];for(N=I;N<2*I;N++)P[N]=0;return new o(P,0)};function T(R,I){for(;(R[I]&65535)!=R[I];)R[I+1]+=R[I]>>>16,R[I]&=65535,I++}function S(R,I){this.g=R,this.h=I}function D(R,I){if(E(I))throw Error("division by zero");if(E(R))return new S(p,p);if(C(R))return I=D(A(R),I),new S(A(I.g),A(I.h));if(C(I))return I=D(R,A(I)),new S(A(I.g),I.h);if(30<R.g.length){if(C(R)||C(I))throw Error("slowDivide_ only works with positive integers.");for(var P=m,N=I;0>=N.l(R);)P=L(P),N=L(N);var k=M(P,1),V=M(N,1);for(N=M(N,2),P=M(P,2);!E(N);){var b=V.add(N);0>=b.l(R)&&(k=k.add(P),V=b),N=M(N,1),P=M(P,1)}return I=w(R,k.j(I)),new S(k,I)}for(k=p;0<=R.l(I);){for(P=Math.max(1,Math.floor(R.m()/I.m())),N=Math.ceil(Math.log(P)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),V=u(P),b=V.j(I);C(b)||0<b.l(R);)P-=N,V=u(P),b=V.j(I);E(V)&&(V=m),k=k.add(V),R=w(R,b)}return new S(k,R)}t.A=function(R){return D(this,R).h},t.and=function(R){for(var I=Math.max(this.g.length,R.g.length),P=[],N=0;N<I;N++)P[N]=this.i(N)&R.i(N);return new o(P,this.h&R.h)},t.or=function(R){for(var I=Math.max(this.g.length,R.g.length),P=[],N=0;N<I;N++)P[N]=this.i(N)|R.i(N);return new o(P,this.h|R.h)},t.xor=function(R){for(var I=Math.max(this.g.length,R.g.length),P=[],N=0;N<I;N++)P[N]=this.i(N)^R.i(N);return new o(P,this.h^R.h)};function L(R){for(var I=R.g.length+1,P=[],N=0;N<I;N++)P[N]=R.i(N)<<1|R.i(N-1)>>>31;return new o(P,R.h)}function M(R,I){var P=I>>5;I%=32;for(var N=R.g.length-P,k=[],V=0;V<N;V++)k[V]=0<I?R.i(V+P)>>>I|R.i(V+P+1)<<32-I:R.i(V+P);return new o(k,R.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Yx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Us=o}).apply(typeof t0<"u"?t0:typeof self<"u"?self:typeof window<"u"?window:{});var id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xx,ql,Zx,Md,Rg,eP,tP,nP;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,g,v){return h==Array.prototype||h==Object.prototype||(h[g]=v.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof id=="object"&&id];for(var g=0;g<h.length;++g){var v=h[g];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function i(h,g){if(g)e:{var v=r;h=h.split(".");for(var x=0;x<h.length-1;x++){var U=h[x];if(!(U in v))break e;v=v[U]}h=h[h.length-1],x=v[h],g=g(x),g!=x&&g!=null&&e(v,h,{configurable:!0,writable:!0,value:g})}}function s(h,g){h instanceof String&&(h+="");var v=0,x=!1,U={next:function(){if(!x&&v<h.length){var q=v++;return{value:g(q,h[q]),done:!1}}return x=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}i("Array.prototype.values",function(h){return h||function(){return s(this,function(g,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var g=typeof h;return g=g!="object"?g:h?Array.isArray(h)?"array":g:"null",g=="array"||g=="object"&&typeof h.length=="number"}function u(h){var g=typeof h;return g=="object"&&h!=null||g=="function"}function d(h,g,v){return h.call.apply(h.bind,arguments)}function p(h,g,v){if(!h)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,x),h.apply(g,U)}}return function(){return h.apply(g,arguments)}}function m(h,g,v){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function _(h,g){var v=Array.prototype.slice.call(arguments,1);return function(){var x=v.slice();return x.push.apply(x,arguments),h.apply(this,x)}}function E(h,g){function v(){}v.prototype=g.prototype,h.aa=g.prototype,h.prototype=new v,h.prototype.constructor=h,h.Qb=function(x,U,q){for(var K=Array(arguments.length-2),Re=2;Re<arguments.length;Re++)K[Re-2]=arguments[Re];return g.prototype[U].apply(x,K)}}function C(h){const g=h.length;if(0<g){const v=Array(g);for(let x=0;x<g;x++)v[x]=h[x];return v}return[]}function A(h,g){for(let v=1;v<arguments.length;v++){const x=arguments[v];if(l(x)){const U=h.length||0,q=x.length||0;h.length=U+q;for(let K=0;K<q;K++)h[U+K]=x[K]}else h.push(x)}}class w{constructor(g,v){this.i=g,this.j=v,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function T(h){return/^[\s\xa0]*$/.test(h)}function S(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function D(h){return D[" "](h),h}D[" "]=function(){};var L=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function M(h,g,v){for(const x in h)g.call(v,h[x],x,h)}function R(h,g){for(const v in h)g.call(void 0,h[v],v,h)}function I(h){const g={};for(const v in h)g[v]=h[v];return g}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(h,g){let v,x;for(let U=1;U<arguments.length;U++){x=arguments[U];for(v in x)h[v]=x[v];for(let q=0;q<P.length;q++)v=P[q],Object.prototype.hasOwnProperty.call(x,v)&&(h[v]=x[v])}}function k(h){var g=1;h=h.split(":");const v=[];for(;0<g&&h.length;)v.push(h.shift()),g--;return h.length&&v.push(h.join(":")),v}function V(h){a.setTimeout(()=>{throw h},0)}function b(){var h=ie;let g=null;return h.g&&(g=h.g,h.g=h.g.next,h.g||(h.h=null),g.next=null),g}class Te{constructor(){this.h=this.g=null}add(g,v){const x=Mt.get();x.set(g,v),this.h?this.h.next=x:this.g=x,this.h=x}}var Mt=new w(()=>new dt,h=>h.reset());class dt{constructor(){this.next=this.g=this.h=null}set(g,v){this.h=g,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let At,Q=!1,ie=new Te,se=()=>{const h=a.Promise.resolve(void 0);At=()=>{h.then(Ce)}};var Ce=()=>{for(var h;h=b();){try{h.h.call(h.g)}catch(v){V(v)}var g=Mt;g.j(h),100>g.h&&(g.h++,h.next=g.g,g.g=h)}Q=!1};function Ee(){this.s=this.s,this.C=this.C}Ee.prototype.s=!1,Ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pe(h,g){this.type=h,this.g=this.target=g,this.defaultPrevented=!1}Pe.prototype.h=function(){this.defaultPrevented=!0};var cn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,g=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const v=()=>{};a.addEventListener("test",v,g),a.removeEventListener("test",v,g)}catch{}return h}();function Kt(h,g){if(Pe.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var v=this.type=h.type,x=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=g,g=h.relatedTarget){if(L){e:{try{D(g.nodeName);var U=!0;break e}catch{}U=!1}U||(g=null)}}else v=="mouseover"?g=h.fromElement:v=="mouseout"&&(g=h.toElement);this.relatedTarget=g,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ee[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Kt.aa.h.call(this)}}E(Kt,Pe);var ee={2:"touch",3:"pen",4:"mouse"};Kt.prototype.h=function(){Kt.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),at=0;function Dn(h,g,v,x,U){this.listener=h,this.proxy=null,this.src=g,this.type=v,this.capture=!!x,this.ha=U,this.key=++at,this.da=this.fa=!1}function H(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ue(h){this.src=h,this.g={},this.h=0}Ue.prototype.add=function(h,g,v,x,U){var q=h.toString();h=this.g[q],h||(h=this.g[q]=[],this.h++);var K=tl(h,g,x,U);return-1<K?(g=h[K],v||(g.fa=!1)):(g=new Dn(g,this.src,q,!!x,U),g.fa=v,h.push(g)),g};function go(h,g){var v=g.type;if(v in h.g){var x=h.g[v],U=Array.prototype.indexOf.call(x,g,void 0),q;(q=0<=U)&&Array.prototype.splice.call(x,U,1),q&&(H(g),h.g[v].length==0&&(delete h.g[v],h.h--))}}function tl(h,g,v,x){for(var U=0;U<h.length;++U){var q=h[U];if(!q.da&&q.listener==g&&q.capture==!!v&&q.ha==x)return U}return-1}var rp="closure_lm_"+(1e6*Math.random()|0),ip={};function aE(h,g,v,x,U){if(Array.isArray(g)){for(var q=0;q<g.length;q++)aE(h,g[q],v,x,U);return null}return v=cE(v),h&&h[ue]?h.K(g,v,u(x)?!!x.capture:!1,U):qk(h,g,v,!1,x,U)}function qk(h,g,v,x,U,q){if(!g)throw Error("Invalid event type");var K=u(U)?!!U.capture:!!U,Re=op(h);if(Re||(h[rp]=Re=new Ue(h)),v=Re.add(g,v,x,K,q),v.proxy)return v;if(x=Gk(),v.proxy=x,x.src=h,x.listener=v,h.addEventListener)cn||(U=K),U===void 0&&(U=!1),h.addEventListener(g.toString(),x,U);else if(h.attachEvent)h.attachEvent(uE(g.toString()),x);else if(h.addListener&&h.removeListener)h.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Gk(){function h(v){return g.call(h.src,h.listener,v)}const g=$k;return h}function lE(h,g,v,x,U){if(Array.isArray(g))for(var q=0;q<g.length;q++)lE(h,g[q],v,x,U);else x=u(x)?!!x.capture:!!x,v=cE(v),h&&h[ue]?(h=h.i,g=String(g).toString(),g in h.g&&(q=h.g[g],v=tl(q,v,x,U),-1<v&&(H(q[v]),Array.prototype.splice.call(q,v,1),q.length==0&&(delete h.g[g],h.h--)))):h&&(h=op(h))&&(g=h.g[g.toString()],h=-1,g&&(h=tl(g,v,x,U)),(v=-1<h?g[h]:null)&&sp(v))}function sp(h){if(typeof h!="number"&&h&&!h.da){var g=h.src;if(g&&g[ue])go(g.i,h);else{var v=h.type,x=h.proxy;g.removeEventListener?g.removeEventListener(v,x,h.capture):g.detachEvent?g.detachEvent(uE(v),x):g.addListener&&g.removeListener&&g.removeListener(x),(v=op(g))?(go(v,h),v.h==0&&(v.src=null,g[rp]=null)):H(h)}}}function uE(h){return h in ip?ip[h]:ip[h]="on"+h}function $k(h,g){if(h.da)h=!0;else{g=new Kt(g,this);var v=h.listener,x=h.ha||h.src;h.fa&&sp(h),h=v.call(x,g)}return h}function op(h){return h=h[rp],h instanceof Ue?h:null}var ap="__closure_events_fn_"+(1e9*Math.random()>>>0);function cE(h){return typeof h=="function"?h:(h[ap]||(h[ap]=function(g){return h.handleEvent(g)}),h[ap])}function Vt(){Ee.call(this),this.i=new Ue(this),this.M=this,this.F=null}E(Vt,Ee),Vt.prototype[ue]=!0,Vt.prototype.removeEventListener=function(h,g,v,x){lE(this,h,g,v,x)};function Jt(h,g){var v,x=h.F;if(x)for(v=[];x;x=x.F)v.push(x);if(h=h.M,x=g.type||g,typeof g=="string")g=new Pe(g,h);else if(g instanceof Pe)g.target=g.target||h;else{var U=g;g=new Pe(x,h),N(g,U)}if(U=!0,v)for(var q=v.length-1;0<=q;q--){var K=g.g=v[q];U=Sc(K,x,!0,g)&&U}if(K=g.g=h,U=Sc(K,x,!0,g)&&U,U=Sc(K,x,!1,g)&&U,v)for(q=0;q<v.length;q++)K=g.g=v[q],U=Sc(K,x,!1,g)&&U}Vt.prototype.N=function(){if(Vt.aa.N.call(this),this.i){var h=this.i,g;for(g in h.g){for(var v=h.g[g],x=0;x<v.length;x++)H(v[x]);delete h.g[g],h.h--}}this.F=null},Vt.prototype.K=function(h,g,v,x){return this.i.add(String(h),g,!1,v,x)},Vt.prototype.L=function(h,g,v,x){return this.i.add(String(h),g,!0,v,x)};function Sc(h,g,v,x){if(g=h.i.g[String(g)],!g)return!0;g=g.concat();for(var U=!0,q=0;q<g.length;++q){var K=g[q];if(K&&!K.da&&K.capture==v){var Re=K.listener,Ct=K.ha||K.src;K.fa&&go(h.i,K),U=Re.call(Ct,x)!==!1&&U}}return U&&!x.defaultPrevented}function dE(h,g,v){if(typeof h=="function")v&&(h=m(h,v));else if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(h,g||0)}function hE(h){h.g=dE(()=>{h.g=null,h.i&&(h.i=!1,hE(h))},h.l);const g=h.h;h.h=null,h.m.apply(null,g)}class Hk extends Ee{constructor(g,v){super(),this.m=g,this.l=v,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:hE(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nl(h){Ee.call(this),this.h=h,this.g={}}E(nl,Ee);var fE=[];function pE(h){M(h.g,function(g,v){this.g.hasOwnProperty(v)&&sp(g)},h),h.g={}}nl.prototype.N=function(){nl.aa.N.call(this),pE(this)},nl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var lp=a.JSON.stringify,zk=a.JSON.parse,Wk=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function up(){}up.prototype.h=null;function mE(h){return h.h||(h.h=h.i())}function gE(){}var rl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function cp(){Pe.call(this,"d")}E(cp,Pe);function dp(){Pe.call(this,"c")}E(dp,Pe);var hs={},_E=null;function Ac(){return _E=_E||new Vt}hs.La="serverreachability";function yE(h){Pe.call(this,hs.La,h)}E(yE,Pe);function il(h){const g=Ac();Jt(g,new yE(g))}hs.STAT_EVENT="statevent";function vE(h,g){Pe.call(this,hs.STAT_EVENT,h),this.stat=g}E(vE,Pe);function jt(h){const g=Ac();Jt(g,new vE(g,h))}hs.Ma="timingevent";function EE(h,g){Pe.call(this,hs.Ma,h),this.size=g}E(EE,Pe);function sl(h,g){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},g)}function ol(){this.g=!0}ol.prototype.xa=function(){this.g=!1};function Kk(h,g,v,x,U,q){h.info(function(){if(h.g)if(q)for(var K="",Re=q.split("&"),Ct=0;Ct<Re.length;Ct++){var _e=Re[Ct].split("=");if(1<_e.length){var Lt=_e[0];_e=_e[1];var Ut=Lt.split("_");K=2<=Ut.length&&Ut[1]=="type"?K+(Lt+"="+_e+"&"):K+(Lt+"=redacted&")}}else K=null;else K=q;return"XMLHTTP REQ ("+x+") [attempt "+U+"]: "+g+`
`+v+`
`+K})}function Jk(h,g,v,x,U,q,K){h.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+U+"]: "+g+`
`+v+`
`+q+" "+K})}function _o(h,g,v,x){h.info(function(){return"XMLHTTP TEXT ("+g+"): "+Qk(h,v)+(x?" "+x:"")})}function jk(h,g){h.info(function(){return"TIMEOUT: "+g})}ol.prototype.info=function(){};function Qk(h,g){if(!h.g)return g;if(!g)return null;try{var v=JSON.parse(g);if(v){for(h=0;h<v.length;h++)if(Array.isArray(v[h])){var x=v[h];if(!(2>x.length)){var U=x[1];if(Array.isArray(U)&&!(1>U.length)){var q=U[0];if(q!="noop"&&q!="stop"&&q!="close")for(var K=1;K<U.length;K++)U[K]=""}}}}return lp(v)}catch{return g}}var Cc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},TE={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},hp;function Rc(){}E(Rc,up),Rc.prototype.g=function(){return new XMLHttpRequest},Rc.prototype.i=function(){return{}},hp=new Rc;function ci(h,g,v,x){this.j=h,this.i=g,this.l=v,this.R=x||1,this.U=new nl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new wE}function wE(){this.i=null,this.g="",this.h=!1}var IE={},fp={};function pp(h,g,v){h.L=1,h.v=bc(Pr(g)),h.m=v,h.P=!0,SE(h,null)}function SE(h,g){h.F=Date.now(),xc(h),h.A=Pr(h.v);var v=h.A,x=h.R;Array.isArray(x)||(x=[String(x)]),FE(v.i,"t",x),h.C=0,v=h.j.J,h.h=new wE,h.g=nT(h.j,v?g:null,!h.m),0<h.O&&(h.M=new Hk(m(h.Y,h,h.g),h.O)),g=h.U,v=h.g,x=h.ca;var U="readystatechange";Array.isArray(U)||(U&&(fE[0]=U.toString()),U=fE);for(var q=0;q<U.length;q++){var K=aE(v,U[q],x||g.handleEvent,!1,g.h||g);if(!K)break;g.g[K.key]=K}g=h.H?I(h.H):{},h.m?(h.u||(h.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,g)):(h.u="GET",h.g.ea(h.A,h.u,null,g)),il(),Kk(h.i,h.u,h.A,h.l,h.R,h.m)}ci.prototype.ca=function(h){h=h.target;const g=this.M;g&&Nr(h)==3?g.j():this.Y(h)},ci.prototype.Y=function(h){try{if(h==this.g)e:{const Ut=Nr(this.g);var g=this.g.Ba();const Eo=this.g.Z();if(!(3>Ut)&&(Ut!=3||this.g&&(this.h.h||this.g.oa()||zE(this.g)))){this.J||Ut!=4||g==7||(g==8||0>=Eo?il(3):il(2)),mp(this);var v=this.g.Z();this.X=v;t:if(AE(this)){var x=zE(this.g);h="";var U=x.length,q=Nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){fs(this),al(this);var K="";break t}this.h.i=new a.TextDecoder}for(g=0;g<U;g++)this.h.h=!0,h+=this.h.i.decode(x[g],{stream:!(q&&g==U-1)});x.length=0,this.h.g+=h,this.C=0,K=this.h.g}else K=this.g.oa();if(this.o=v==200,Jk(this.i,this.u,this.A,this.l,this.R,Ut,v),this.o){if(this.T&&!this.K){t:{if(this.g){var Re,Ct=this.g;if((Re=Ct.g?Ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(Re)){var _e=Re;break t}}_e=null}if(v=_e)_o(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gp(this,v);else{this.o=!1,this.s=3,jt(12),fs(this),al(this);break e}}if(this.P){v=!0;let Jn;for(;!this.J&&this.C<K.length;)if(Jn=Yk(this,K),Jn==fp){Ut==4&&(this.s=4,jt(14),v=!1),_o(this.i,this.l,null,"[Incomplete Response]");break}else if(Jn==IE){this.s=4,jt(15),_o(this.i,this.l,K,"[Invalid Chunk]"),v=!1;break}else _o(this.i,this.l,Jn,null),gp(this,Jn);if(AE(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ut!=4||K.length!=0||this.h.h||(this.s=1,jt(16),v=!1),this.o=this.o&&v,!v)_o(this.i,this.l,K,"[Invalid Chunked Response]"),fs(this),al(this);else if(0<K.length&&!this.W){this.W=!0;var Lt=this.j;Lt.g==this&&Lt.ba&&!Lt.M&&(Lt.j.info("Great, no buffering proxy detected. Bytes received: "+K.length),wp(Lt),Lt.M=!0,jt(11))}}else _o(this.i,this.l,K,null),gp(this,K);Ut==4&&fs(this),this.o&&!this.J&&(Ut==4?XE(this.j,this):(this.o=!1,xc(this)))}else pD(this.g),v==400&&0<K.indexOf("Unknown SID")?(this.s=3,jt(12)):(this.s=0,jt(13)),fs(this),al(this)}}}catch{}finally{}};function AE(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Yk(h,g){var v=h.C,x=g.indexOf(`
`,v);return x==-1?fp:(v=Number(g.substring(v,x)),isNaN(v)?IE:(x+=1,x+v>g.length?fp:(g=g.slice(x,x+v),h.C=x+v,g)))}ci.prototype.cancel=function(){this.J=!0,fs(this)};function xc(h){h.S=Date.now()+h.I,CE(h,h.I)}function CE(h,g){if(h.B!=null)throw Error("WatchDog timer not null");h.B=sl(m(h.ba,h),g)}function mp(h){h.B&&(a.clearTimeout(h.B),h.B=null)}ci.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(jk(this.i,this.A),this.L!=2&&(il(),jt(17)),fs(this),this.s=2,al(this)):CE(this,this.S-h)};function al(h){h.j.G==0||h.J||XE(h.j,h)}function fs(h){mp(h);var g=h.M;g&&typeof g.ma=="function"&&g.ma(),h.M=null,pE(h.U),h.g&&(g=h.g,h.g=null,g.abort(),g.ma())}function gp(h,g){try{var v=h.j;if(v.G!=0&&(v.g==h||_p(v.h,h))){if(!h.K&&_p(v.h,h)&&v.G==3){try{var x=v.Da.g.parse(g)}catch{x=null}if(Array.isArray(x)&&x.length==3){var U=x;if(U[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<h.F)Uc(v),Vc(v);else break e;Tp(v),jt(18)}}else v.za=U[1],0<v.za-v.T&&37500>U[2]&&v.F&&v.v==0&&!v.C&&(v.C=sl(m(v.Za,v),6e3));if(1>=PE(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else ms(v,11)}else if((h.K||v.g==h)&&Uc(v),!T(g))for(U=v.Da.g.parse(g),g=0;g<U.length;g++){let _e=U[g];if(v.T=_e[0],_e=_e[1],v.G==2)if(_e[0]=="c"){v.K=_e[1],v.ia=_e[2];const Lt=_e[3];Lt!=null&&(v.la=Lt,v.j.info("VER="+v.la));const Ut=_e[4];Ut!=null&&(v.Aa=Ut,v.j.info("SVER="+v.Aa));const Eo=_e[5];Eo!=null&&typeof Eo=="number"&&0<Eo&&(x=1.5*Eo,v.L=x,v.j.info("backChannelRequestTimeoutMs_="+x)),x=v;const Jn=h.g;if(Jn){const Oc=Jn.g?Jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oc){var q=x.h;q.g||Oc.indexOf("spdy")==-1&&Oc.indexOf("quic")==-1&&Oc.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(yp(q,q.h),q.h=null))}if(x.D){const Ip=Jn.g?Jn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ip&&(x.ya=Ip,ke(x.I,x.D,Ip))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-h.F,v.j.info("Handshake RTT: "+v.R+"ms")),x=v;var K=h;if(x.qa=tT(x,x.J?x.ia:null,x.W),K.K){NE(x.h,K);var Re=K,Ct=x.L;Ct&&(Re.I=Ct),Re.B&&(mp(Re),xc(Re)),x.g=K}else QE(x);0<v.i.length&&Lc(v)}else _e[0]!="stop"&&_e[0]!="close"||ms(v,7);else v.G==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?ms(v,7):Ep(v):_e[0]!="noop"&&v.l&&v.l.ta(_e),v.v=0)}}il(4)}catch{}}var Xk=class{constructor(h,g){this.g=h,this.map=g}};function RE(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xE(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function PE(h){return h.h?1:h.g?h.g.size:0}function _p(h,g){return h.h?h.h==g:h.g?h.g.has(g):!1}function yp(h,g){h.g?h.g.add(g):h.h=g}function NE(h,g){h.h&&h.h==g?h.h=null:h.g&&h.g.has(g)&&h.g.delete(g)}RE.prototype.cancel=function(){if(this.i=bE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function bE(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let g=h.i;for(const v of h.g.values())g=g.concat(v.D);return g}return C(h.i)}function Zk(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var g=[],v=h.length,x=0;x<v;x++)g.push(h[x]);return g}g=[],v=0;for(x in h)g[v++]=h[x];return g}function eD(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var g=[];h=h.length;for(var v=0;v<h;v++)g.push(v);return g}g=[],v=0;for(const x in h)g[v++]=x;return g}}}function kE(h,g){if(h.forEach&&typeof h.forEach=="function")h.forEach(g,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,g,void 0);else for(var v=eD(h),x=Zk(h),U=x.length,q=0;q<U;q++)g.call(void 0,x[q],v&&v[q],h)}var DE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tD(h,g){if(h){h=h.split("&");for(var v=0;v<h.length;v++){var x=h[v].indexOf("="),U=null;if(0<=x){var q=h[v].substring(0,x);U=h[v].substring(x+1)}else q=h[v];g(q,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function ps(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof ps){this.h=h.h,Pc(this,h.j),this.o=h.o,this.g=h.g,Nc(this,h.s),this.l=h.l;var g=h.i,v=new cl;v.i=g.i,g.g&&(v.g=new Map(g.g),v.h=g.h),ME(this,v),this.m=h.m}else h&&(g=String(h).match(DE))?(this.h=!1,Pc(this,g[1]||"",!0),this.o=ll(g[2]||""),this.g=ll(g[3]||"",!0),Nc(this,g[4]),this.l=ll(g[5]||"",!0),ME(this,g[6]||"",!0),this.m=ll(g[7]||"")):(this.h=!1,this.i=new cl(null,this.h))}ps.prototype.toString=function(){var h=[],g=this.j;g&&h.push(ul(g,VE,!0),":");var v=this.g;return(v||g=="file")&&(h.push("//"),(g=this.o)&&h.push(ul(g,VE,!0),"@"),h.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&h.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&h.push("/"),h.push(ul(v,v.charAt(0)=="/"?iD:rD,!0))),(v=this.i.toString())&&h.push("?",v),(v=this.m)&&h.push("#",ul(v,oD)),h.join("")};function Pr(h){return new ps(h)}function Pc(h,g,v){h.j=v?ll(g,!0):g,h.j&&(h.j=h.j.replace(/:$/,""))}function Nc(h,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);h.s=g}else h.s=null}function ME(h,g,v){g instanceof cl?(h.i=g,aD(h.i,h.h)):(v||(g=ul(g,sD)),h.i=new cl(g,h.h))}function ke(h,g,v){h.i.set(g,v)}function bc(h){return ke(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function ll(h,g){return h?g?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ul(h,g,v){return typeof h=="string"?(h=encodeURI(h).replace(g,nD),v&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function nD(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var VE=/[#\/\?@]/g,rD=/[#\?:]/g,iD=/[#\?]/g,sD=/[#\?@]/g,oD=/#/g;function cl(h,g){this.h=this.g=null,this.i=h||null,this.j=!!g}function di(h){h.g||(h.g=new Map,h.h=0,h.i&&tD(h.i,function(g,v){h.add(decodeURIComponent(g.replace(/\+/g," ")),v)}))}t=cl.prototype,t.add=function(h,g){di(this),this.i=null,h=yo(this,h);var v=this.g.get(h);return v||this.g.set(h,v=[]),v.push(g),this.h+=1,this};function LE(h,g){di(h),g=yo(h,g),h.g.has(g)&&(h.i=null,h.h-=h.g.get(g).length,h.g.delete(g))}function UE(h,g){return di(h),g=yo(h,g),h.g.has(g)}t.forEach=function(h,g){di(this),this.g.forEach(function(v,x){v.forEach(function(U){h.call(g,U,x,this)},this)},this)},t.na=function(){di(this);const h=Array.from(this.g.values()),g=Array.from(this.g.keys()),v=[];for(let x=0;x<g.length;x++){const U=h[x];for(let q=0;q<U.length;q++)v.push(g[x])}return v},t.V=function(h){di(this);let g=[];if(typeof h=="string")UE(this,h)&&(g=g.concat(this.g.get(yo(this,h))));else{h=Array.from(this.g.values());for(let v=0;v<h.length;v++)g=g.concat(h[v])}return g},t.set=function(h,g){return di(this),this.i=null,h=yo(this,h),UE(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[g]),this.h+=1,this},t.get=function(h,g){return h?(h=this.V(h),0<h.length?String(h[0]):g):g};function FE(h,g,v){LE(h,g),0<v.length&&(h.i=null,h.g.set(yo(h,g),C(v)),h.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],g=Array.from(this.g.keys());for(var v=0;v<g.length;v++){var x=g[v];const q=encodeURIComponent(String(x)),K=this.V(x);for(x=0;x<K.length;x++){var U=q;K[x]!==""&&(U+="="+encodeURIComponent(String(K[x]))),h.push(U)}}return this.i=h.join("&")};function yo(h,g){return g=String(g),h.j&&(g=g.toLowerCase()),g}function aD(h,g){g&&!h.j&&(di(h),h.i=null,h.g.forEach(function(v,x){var U=x.toLowerCase();x!=U&&(LE(this,x),FE(this,U,v))},h)),h.j=g}function lD(h,g){const v=new ol;if(a.Image){const x=new Image;x.onload=_(hi,v,"TestLoadImage: loaded",!0,g,x),x.onerror=_(hi,v,"TestLoadImage: error",!1,g,x),x.onabort=_(hi,v,"TestLoadImage: abort",!1,g,x),x.ontimeout=_(hi,v,"TestLoadImage: timeout",!1,g,x),a.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=h}else g(!1)}function uD(h,g){const v=new ol,x=new AbortController,U=setTimeout(()=>{x.abort(),hi(v,"TestPingServer: timeout",!1,g)},1e4);fetch(h,{signal:x.signal}).then(q=>{clearTimeout(U),q.ok?hi(v,"TestPingServer: ok",!0,g):hi(v,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(U),hi(v,"TestPingServer: error",!1,g)})}function hi(h,g,v,x,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),x(v)}catch{}}function cD(){this.g=new Wk}function dD(h,g,v){const x=v||"";try{kE(h,function(U,q){let K=U;u(U)&&(K=lp(U)),g.push(x+q+"="+encodeURIComponent(K))})}catch(U){throw g.push(x+"type="+encodeURIComponent("_badmap")),U}}function kc(h){this.l=h.Ub||null,this.j=h.eb||!1}E(kc,up),kc.prototype.g=function(){return new Dc(this.l,this.j)},kc.prototype.i=function(h){return function(){return h}}({});function Dc(h,g){Vt.call(this),this.D=h,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Dc,Vt),t=Dc.prototype,t.open=function(h,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=g,this.readyState=1,hl(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(g.body=h),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dl(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,hl(this)),this.g&&(this.readyState=3,hl(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;OE(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function OE(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var g=h.value?h.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!h.done}))&&(this.response=this.responseText+=g)}h.done?dl(this):hl(this),this.readyState==3&&OE(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,dl(this))},t.Qa=function(h){this.g&&(this.response=h,dl(this))},t.ga=function(){this.g&&dl(this)};function dl(h){h.readyState=4,h.l=null,h.j=null,h.v=null,hl(h)}t.setRequestHeader=function(h,g){this.u.append(h,g)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],g=this.h.entries();for(var v=g.next();!v.done;)v=v.value,h.push(v[0]+": "+v[1]),v=g.next();return h.join(`\r
`)};function hl(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Dc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function BE(h){let g="";return M(h,function(v,x){g+=x,g+=":",g+=v,g+=`\r
`}),g}function vp(h,g,v){e:{for(x in v){var x=!1;break e}x=!0}x||(v=BE(v),typeof h=="string"?v!=null&&encodeURIComponent(String(v)):ke(h,g,v))}function je(h){Vt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(je,Vt);var hD=/^https?$/i,fD=["POST","PUT"];t=je.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,g,v,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);g=g?g.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():hp.g(),this.v=this.o?mE(this.o):mE(hp),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(g,String(h),!0),this.B=!1}catch(q){qE(this,q);return}if(h=v||"",v=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var U in x)v.set(U,x[U]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const q of x.keys())v.set(q,x.get(q));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(v.keys()).find(q=>q.toLowerCase()=="content-type"),U=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(fD,g,void 0))||x||U||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,K]of v)this.g.setRequestHeader(q,K);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{HE(this),this.u=!0,this.g.send(h),this.u=!1}catch(q){qE(this,q)}};function qE(h,g){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=g,h.m=5,GE(h),Mc(h)}function GE(h){h.A||(h.A=!0,Jt(h,"complete"),Jt(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Jt(this,"complete"),Jt(this,"abort"),Mc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mc(this,!0)),je.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?$E(this):this.bb())},t.bb=function(){$E(this)};function $E(h){if(h.h&&typeof o<"u"&&(!h.v[1]||Nr(h)!=4||h.Z()!=2)){if(h.u&&Nr(h)==4)dE(h.Ea,0,h);else if(Jt(h,"readystatechange"),Nr(h)==4){h.h=!1;try{const K=h.Z();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var v;if(!(v=g)){var x;if(x=K===0){var U=String(h.D).match(DE)[1]||null;!U&&a.self&&a.self.location&&(U=a.self.location.protocol.slice(0,-1)),x=!hD.test(U?U.toLowerCase():"")}v=x}if(v)Jt(h,"complete"),Jt(h,"success");else{h.m=6;try{var q=2<Nr(h)?h.g.statusText:""}catch{q=""}h.l=q+" ["+h.Z()+"]",GE(h)}}finally{Mc(h)}}}}function Mc(h,g){if(h.g){HE(h);const v=h.g,x=h.v[0]?()=>{}:null;h.g=null,h.v=null,g||Jt(h,"ready");try{v.onreadystatechange=x}catch{}}}function HE(h){h.I&&(a.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function Nr(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<Nr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var g=this.g.responseText;return h&&g.indexOf(h)==0&&(g=g.substring(h.length)),zk(g)}};function zE(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function pD(h){const g={};h=(h.g&&2<=Nr(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<h.length;x++){if(T(h[x]))continue;var v=k(h[x]);const U=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const q=g[U]||[];g[U]=q,q.push(v)}R(g,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fl(h,g,v){return v&&v.internalChannelParams&&v.internalChannelParams[h]||g}function WE(h){this.Aa=0,this.i=[],this.j=new ol,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fl("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fl("baseRetryDelayMs",5e3,h),this.cb=fl("retryDelaySeedMs",1e4,h),this.Wa=fl("forwardChannelMaxRetries",2,h),this.wa=fl("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new RE(h&&h.concurrentRequestLimit),this.Da=new cD,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=WE.prototype,t.la=8,t.G=1,t.connect=function(h,g,v,x){jt(0),this.W=h,this.H=g||{},v&&x!==void 0&&(this.H.OSID=v,this.H.OAID=x),this.F=this.X,this.I=tT(this,null,this.W),Lc(this)};function Ep(h){if(KE(h),h.G==3){var g=h.U++,v=Pr(h.I);if(ke(v,"SID",h.K),ke(v,"RID",g),ke(v,"TYPE","terminate"),pl(h,v),g=new ci(h,h.j,g),g.L=2,g.v=bc(Pr(v)),v=!1,a.navigator&&a.navigator.sendBeacon)try{v=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!v&&a.Image&&(new Image().src=g.v,v=!0),v||(g.g=nT(g.j,null),g.g.ea(g.v)),g.F=Date.now(),xc(g)}eT(h)}function Vc(h){h.g&&(wp(h),h.g.cancel(),h.g=null)}function KE(h){Vc(h),h.u&&(a.clearTimeout(h.u),h.u=null),Uc(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function Lc(h){if(!xE(h.h)&&!h.s){h.s=!0;var g=h.Ga;At||se(),Q||(At(),Q=!0),ie.add(g,h),h.B=0}}function mD(h,g){return PE(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=g.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=sl(m(h.Ga,h,g),ZE(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const U=new ci(this,this.j,h);let q=this.o;if(this.S&&(q?(q=I(q),N(q,this.S)):q=this.S),this.m!==null||this.O||(U.H=q,q=null),this.P)e:{for(var g=0,v=0;v<this.i.length;v++){t:{var x=this.i[v];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(g+=x,4096<g){g=v;break e}if(g===4096||v===this.i.length-1){g=v+1;break e}}g=1e3}else g=1e3;g=jE(this,U,g),v=Pr(this.I),ke(v,"RID",h),ke(v,"CVER",22),this.D&&ke(v,"X-HTTP-Session-Id",this.D),pl(this,v),q&&(this.O?g="headers="+encodeURIComponent(String(BE(q)))+"&"+g:this.m&&vp(v,this.m,q)),yp(this.h,U),this.Ua&&ke(v,"TYPE","init"),this.P?(ke(v,"$req",g),ke(v,"SID","null"),U.T=!0,pp(U,v,null)):pp(U,v,g),this.G=2}}else this.G==3&&(h?JE(this,h):this.i.length==0||xE(this.h)||JE(this))};function JE(h,g){var v;g?v=g.l:v=h.U++;const x=Pr(h.I);ke(x,"SID",h.K),ke(x,"RID",v),ke(x,"AID",h.T),pl(h,x),h.m&&h.o&&vp(x,h.m,h.o),v=new ci(h,h.j,v,h.B+1),h.m===null&&(v.H=h.o),g&&(h.i=g.D.concat(h.i)),g=jE(h,v,1e3),v.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),yp(h.h,v),pp(v,x,g)}function pl(h,g){h.H&&M(h.H,function(v,x){ke(g,x,v)}),h.l&&kE({},function(v,x){ke(g,x,v)})}function jE(h,g,v){v=Math.min(h.i.length,v);var x=h.l?m(h.l.Na,h.l,h):null;e:{var U=h.i;let q=-1;for(;;){const K=["count="+v];q==-1?0<v?(q=U[0].g,K.push("ofs="+q)):q=0:K.push("ofs="+q);let Re=!0;for(let Ct=0;Ct<v;Ct++){let _e=U[Ct].g;const Lt=U[Ct].map;if(_e-=q,0>_e)q=Math.max(0,U[Ct].g-100),Re=!1;else try{dD(Lt,K,"req"+_e+"_")}catch{x&&x(Lt)}}if(Re){x=K.join("&");break e}}}return h=h.i.splice(0,v),g.D=h,x}function QE(h){if(!h.g&&!h.u){h.Y=1;var g=h.Fa;At||se(),Q||(At(),Q=!0),ie.add(g,h),h.v=0}}function Tp(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=sl(m(h.Fa,h),ZE(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,YE(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=sl(m(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,jt(10),Vc(this),YE(this))};function wp(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function YE(h){h.g=new ci(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var g=Pr(h.qa);ke(g,"RID","rpc"),ke(g,"SID",h.K),ke(g,"AID",h.T),ke(g,"CI",h.F?"0":"1"),!h.F&&h.ja&&ke(g,"TO",h.ja),ke(g,"TYPE","xmlhttp"),pl(h,g),h.m&&h.o&&vp(g,h.m,h.o),h.L&&(h.g.I=h.L);var v=h.g;h=h.ia,v.L=1,v.v=bc(Pr(g)),v.m=null,v.P=!0,SE(v,h)}t.Za=function(){this.C!=null&&(this.C=null,Vc(this),Tp(this),jt(19))};function Uc(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function XE(h,g){var v=null;if(h.g==g){Uc(h),wp(h),h.g=null;var x=2}else if(_p(h.h,g))v=g.D,NE(h.h,g),x=1;else return;if(h.G!=0){if(g.o)if(x==1){v=g.m?g.m.length:0,g=Date.now()-g.F;var U=h.B;x=Ac(),Jt(x,new EE(x,v)),Lc(h)}else QE(h);else if(U=g.s,U==3||U==0&&0<g.X||!(x==1&&mD(h,g)||x==2&&Tp(h)))switch(v&&0<v.length&&(g=h.h,g.i=g.i.concat(v)),U){case 1:ms(h,5);break;case 4:ms(h,10);break;case 3:ms(h,6);break;default:ms(h,2)}}}function ZE(h,g){let v=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(v*=2),v*g}function ms(h,g){if(h.j.info("Error code "+g),g==2){var v=m(h.fb,h),x=h.Xa;const U=!x;x=new ps(x||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Pc(x,"https"),bc(x),U?lD(x.toString(),v):uD(x.toString(),v)}else jt(2);h.G=0,h.l&&h.l.sa(g),eT(h),KE(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),jt(2)):(this.j.info("Failed to ping google.com"),jt(1))};function eT(h){if(h.G=0,h.ka=[],h.l){const g=bE(h.h);(g.length!=0||h.i.length!=0)&&(A(h.ka,g),A(h.ka,h.i),h.h.i.length=0,C(h.i),h.i.length=0),h.l.ra()}}function tT(h,g,v){var x=v instanceof ps?Pr(v):new ps(v);if(x.g!="")g&&(x.g=g+"."+x.g),Nc(x,x.s);else{var U=a.location;x=U.protocol,g=g?g+"."+U.hostname:U.hostname,U=+U.port;var q=new ps(null);x&&Pc(q,x),g&&(q.g=g),U&&Nc(q,U),v&&(q.l=v),x=q}return v=h.D,g=h.ya,v&&g&&ke(x,v,g),ke(x,"VER",h.la),pl(h,x),x}function nT(h,g,v){if(g&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=h.Ca&&!h.pa?new je(new kc({eb:v})):new je(h.pa),g.Ha(h.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function rT(){}t=rT.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Fc(){}Fc.prototype.g=function(h,g){return new Tn(h,g)};function Tn(h,g){Vt.call(this),this.g=new WE(g),this.l=h,this.h=g&&g.messageUrlParams||null,h=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(h?h["X-WebChannel-Content-Type"]=g.messageContentType:h={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(h?h["X-WebChannel-Client-Profile"]=g.va:h={"X-WebChannel-Client-Profile":g.va}),this.g.S=h,(h=g&&g.Sb)&&!T(h)&&(this.g.m=h),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!T(g)&&(this.g.D=g,h=this.h,h!==null&&g in h&&(h=this.h,g in h&&delete h[g])),this.j=new vo(this)}E(Tn,Vt),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){Ep(this.g)},Tn.prototype.o=function(h){var g=this.g;if(typeof h=="string"){var v={};v.__data__=h,h=v}else this.u&&(v={},v.__data__=lp(h),h=v);g.i.push(new Xk(g.Ya++,h)),g.G==3&&Lc(g)},Tn.prototype.N=function(){this.g.l=null,delete this.j,Ep(this.g),delete this.g,Tn.aa.N.call(this)};function iT(h){cp.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var g=h.__sm__;if(g){e:{for(const v in g){h=v;break e}h=void 0}(this.i=h)&&(h=this.i,g=g!==null&&h in g?g[h]:void 0),this.data=g}else this.data=h}E(iT,cp);function sT(){dp.call(this),this.status=1}E(sT,dp);function vo(h){this.g=h}E(vo,rT),vo.prototype.ua=function(){Jt(this.g,"a")},vo.prototype.ta=function(h){Jt(this.g,new iT(h))},vo.prototype.sa=function(h){Jt(this.g,new sT)},vo.prototype.ra=function(){Jt(this.g,"b")},Fc.prototype.createWebChannel=Fc.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,nP=function(){return new Fc},tP=function(){return Ac()},eP=hs,Rg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Cc.NO_ERROR=0,Cc.TIMEOUT=8,Cc.HTTP_ERROR=6,Md=Cc,TE.COMPLETE="complete",Zx=TE,gE.EventType=rl,rl.OPEN="a",rl.CLOSE="b",rl.ERROR="c",rl.MESSAGE="d",Vt.prototype.listen=Vt.prototype.K,ql=gE,je.prototype.listenOnce=je.prototype.L,je.prototype.getLastError=je.prototype.Ka,je.prototype.getLastErrorCode=je.prototype.Ba,je.prototype.getStatus=je.prototype.Z,je.prototype.getResponseJson=je.prototype.Oa,je.prototype.getResponseText=je.prototype.oa,je.prototype.send=je.prototype.ea,je.prototype.setWithCredentials=je.prototype.Ha,Xx=je}).apply(typeof id<"u"?id:typeof self<"u"?self:typeof window<"u"?window:{});const n0="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $a="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi=new uf("@firebase/firestore");function xo(){return zi.logLevel}function OB(t){zi.setLogLevel(t)}function $(t,...e){if(zi.logLevel<=de.DEBUG){const n=e.map(qy);zi.debug(`Firestore (${$a}): ${t}`,...n)}}function rt(t,...e){if(zi.logLevel<=de.ERROR){const n=e.map(qy);zi.error(`Firestore (${$a}): ${t}`,...n)}}function Cr(t,...e){if(zi.logLevel<=de.WARN){const n=e.map(qy);zi.warn(`Firestore (${$a}): ${t}`,...n)}}function qy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(t="Unexpected state"){const e=`FIRESTORE (${$a}) INTERNAL ASSERTION FAILED: `+t;throw rt(e),new Error(e)}function te(t,e){t||X()}function BB(t,e){t||X()}function j(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends Ht{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class qB{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Et.UNAUTHENTICATED))}shutdown(){}}class GB{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class $B{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){te(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new bt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new bt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{$("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):($("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new bt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?($("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string"),new rP(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string"),new Et(e)}}class HB{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Et.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class zB{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new HB(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Et.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class WB{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class KB{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){te(this.o===void 0);const r=s=>{s.error!=null&&$("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,$("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{$("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):$("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(te(typeof n.token=="string"),this.R=n.token,new WB(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=JB(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function le(t,e){return t<e?-1:t>e?1:0}function Ta(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function sP(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new G(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ge.fromMillis(Date.now())}static fromDate(e){return Ge.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ge(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new Ge(0,0))}static max(){return new re(new Ge(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n,r){n===void 0?n=0:n>e.length&&X(),r===void 0?r=e.length-n:r>e.length-n&&X(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ou.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ou?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class fe extends Ou{construct(e,n,r){return new fe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new fe(n)}static emptyPath(){return new fe([])}}const jB=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Be extends Ou{construct(e,n,r){return new Be(e,n,r)}static isValidIdentifier(e){return jB.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Be.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Be(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new G(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new G(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new G(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new G(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Be(n)}static emptyPath(){return new Be([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(fe.fromString(e))}static fromName(e){return new J(fe.fromString(e).popFirst(5))}static empty(){return new J(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return fe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new fe(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function xg(t){return t.fields.find(e=>e.kind===2)}function Es(t){return t.fields.filter(e=>e.kind!==2)}Ih.UNKNOWN_ID=-1;class Vd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Bu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Bu(0,Nn.min())}}function oP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=re.fromTimestamp(r===1e9?new Ge(n+1,0):new Ge(n,r));return new Nn(i,J.empty(),e)}function aP(t){return new Nn(t.readTime,t.key,-1)}class Nn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Nn(re.min(),J.empty(),-1)}static max(){return new Nn(re.max(),J.empty(),-1)}}function Gy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ss(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==lP)throw t;$("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(i=>i?F.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new F((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new F((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new bt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new iu(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=$y(r.target.error);this.V.reject(new iu(e,i))}}static open(e,n,r,i){try{return new Tf(n,e.transaction(i,r))}catch(s){throw new iu(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||($("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new YB(n)}}class wr{constructor(e,n,r){this.name=e,this.version=n,this.p=r,wr.S(Ke())===12.2&&rt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return $("SimpleDb","Removing database:",e),ws(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Nu())return!1;if(wr.v())return!0;const e=Ke(),n=wr.S(e),r=0<n&&n<10,i=cP(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||($("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new iu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new G(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new G(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new iu(e,o))},i.onupgradeneeded=s=>{$("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{$("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Tf.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),F.reject(u))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if($("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class QB{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ws(this.B.delete())}}class iu extends G{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function os(t){return t.name==="IndexedDbTransactionError"}class YB{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?($("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):($("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ws(r)}add(e){return $("SimpleDb","ADD",this.store.name,e,e),ws(this.store.add(e))}get(e){return ws(this.store.get(e)).next(n=>(n===void 0&&(n=null),$("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return $("SimpleDb","DELETE",this.store.name,e),ws(this.store.delete(e))}count(){return $("SimpleDb","COUNT",this.store.name),ws(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new F((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new F((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){$("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new F((r,i)=>{n.onerror=s=>{const o=$y(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new F((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new QB(a),u=n(a.primaryKey,a.value,l);if(u instanceof F){const d=u.catch(p=>(l.done(),F.reject(p)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>F.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ws(t){return new F((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=$y(r.target.error);n(i)}})}let r0=!1;function $y(t){const e=wr.S(Ke());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new G("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return r0||(r0=!0,setTimeout(()=>{throw r},0)),r}}return t}class XB{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){$("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{$("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){os(n)?$("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await ss(n)}await this.X(6e4)})}}class ZB{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return F.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return $("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>($("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=aP(s);Gy(o,r)>0&&(r=o)}),new Nn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}mn.oe=-1;function dc(t){return t==null}function qu(t){return t===0&&1/t==-1/0}function dP(t){return typeof t=="number"&&Number.isInteger(t)&&!qu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=i0(e)),e=e4(t.get(n),e);return i0(e)}function e4(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function i0(t){return t+""}function yr(t){const e=t.length;if(te(e>=2),e===2)return te(t.charAt(0)===""&&t.charAt(1)===""),fe.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&X(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:X()}s=o+2}return new fe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ld(t,e){return[t,rn(e)]}function hP(t,e,n){return[t,rn(e),n]}const t4={},n4=["prefixPath","collectionGroup","readTime","documentId"],r4=["prefixPath","collectionGroup","documentId"],i4=["collectionGroup","readTime","prefixPath","documentId"],s4=["canonicalId","targetId"],o4=["targetId","path"],a4=["path","targetId"],l4=["collectionId","parent"],u4=["indexId","uid"],c4=["uid","sequenceNumber"],d4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],h4=["indexId","uid","orderedDocumentKey"],f4=["userId","collectionPath","documentId"],p4=["userId","collectionPath","largestBatchId"],m4=["userId","collectionGroup","largestBatchId"],fP=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],g4=[...fP,"documentOverlays"],pP=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],mP=pP,Hy=[...mP,"indexConfiguration","indexState","indexEntries"],_4=Hy,y4=[...Hy,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg extends uP{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function _t(t,e){const n=j(t);return wr.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function uo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e,n){this.comparator=e,this.root=n||xt.EMPTY}insert(e,n){return new be(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,xt.BLACK,null,null))}remove(e){return new be(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sd(this.root,e,this.comparator,!1)}getReverseIterator(){return new sd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sd(this.root,e,this.comparator,!0)}}class sd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??xt.RED,this.left=i??xt.EMPTY,this.right=s??xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new xt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return xt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw X();const e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}}xt.EMPTY=null,xt.RED=!0,xt.BLACK=!1;xt.EMPTY=new class{constructor(){this.size=0}get key(){throw X()}get value(){throw X()}get color(){throw X()}get left(){throw X()}get right(){throw X()}copy(e,n,r,i,s){return this}insert(e,n,r){return new xt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.comparator=e,this.data=new be(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new a0(this.data.getIterator())}getIteratorFrom(e){return new a0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ae)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ae(this.comparator);return n.data=e,n}}class a0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Io(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.fields=e,e.sort(Be.comparator)}static empty(){return new gn([])}unionWith(e){let n=new Ae(Be.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new gn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ta(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _P("Invalid base64 string: "+s):s}}(e);return new Ze(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ze(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ze.EMPTY_BYTE_STRING=new Ze("");const E4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qr(t){if(te(!!t),typeof t=="string"){let e=0;const n=E4.exec(t);if(te(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Fe(t.seconds),nanos:Fe(t.nanos)}}function Fe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Wi(t){return typeof t=="string"?Ze.fromBase64String(t):Ze.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function zy(t){const e=t.mapValue.fields.__previous_value__;return wf(e)?zy(e):e}function Gu(t){const e=Qr(t.mapValue.fields.__local_write_time__.timestampValue);return new Ge(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Ki{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ki("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ki&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ud={nullValue:"NULL_VALUE"};function Ks(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wf(t)?4:yP(t)?9007199254740991:If(t)?10:11:X()}function Rr(t,e){if(t===e)return!0;const n=Ks(t);if(n!==Ks(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Gu(t).isEqual(Gu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Qr(i.timestampValue),a=Qr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Wi(i.bytesValue).isEqual(Wi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Fe(i.geoPointValue.latitude)===Fe(s.geoPointValue.latitude)&&Fe(i.geoPointValue.longitude)===Fe(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Fe(i.integerValue)===Fe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Fe(i.doubleValue),a=Fe(s.doubleValue);return o===a?qu(o)===qu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ta(t.arrayValue.values||[],e.arrayValue.values||[],Rr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(o0(o)!==o0(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Rr(o[l],a[l])))return!1;return!0}(t,e);default:return X()}}function $u(t,e){return(t.values||[]).find(n=>Rr(n,e))!==void 0}function Ji(t,e){if(t===e)return 0;const n=Ks(t),r=Ks(e);if(n!==r)return le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return le(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Fe(s.integerValue||s.doubleValue),l=Fe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return l0(t.timestampValue,e.timestampValue);case 4:return l0(Gu(t),Gu(e));case 5:return le(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Wi(s),l=Wi(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=le(a[u],l[u]);if(d!==0)return d}return le(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=le(Fe(s.latitude),Fe(o.latitude));return a!==0?a:le(Fe(s.longitude),Fe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return u0(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,d;const p=s.fields||{},m=o.fields||{},_=(a=p.value)===null||a===void 0?void 0:a.arrayValue,E=(l=m.value)===null||l===void 0?void 0:l.arrayValue,C=le(((u=_==null?void 0:_.values)===null||u===void 0?void 0:u.length)||0,((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0);return C!==0?C:u0(_,E)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Pi.mapValue&&o===Pi.mapValue)return 0;if(s===Pi.mapValue)return 1;if(o===Pi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let p=0;p<l.length&&p<d.length;++p){const m=le(l[p],d[p]);if(m!==0)return m;const _=Ji(a[l[p]],u[d[p]]);if(_!==0)return _}return le(l.length,d.length)}(t.mapValue,e.mapValue);default:throw X()}}function l0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return le(t,e);const n=Qr(t),r=Qr(e),i=le(n.seconds,r.seconds);return i!==0?i:le(n.nanos,r.nanos)}function u0(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Ji(n[i],r[i]);if(s)return s}return le(n.length,r.length)}function wa(t){return Ng(t)}function Ng(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Qr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Wi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Ng(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Ng(n.fields[o])}`;return i+"}"}(t.mapValue):X()}function Js(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function bg(t){return!!t&&"integerValue"in t}function Hu(t){return!!t&&"arrayValue"in t}function c0(t){return!!t&&"nullValue"in t}function d0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fd(t){return!!t&&"mapValue"in t}function If(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function su(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return uo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=su(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=su(t.arrayValue.values[n]);return e}return Object.assign({},t)}function yP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const vP={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function w4(t){return"nullValue"in t?Ud:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Js(Ki.empty(),J.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?If(t)?vP:{mapValue:{}}:X()}function I4(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Js(Ki.empty(),J.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?vP:"mapValue"in t?If(t)?{mapValue:{}}:Pi:X()}function h0(t,e){const n=Ji(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function f0(t,e){const n=Ji(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.value=e}static empty(){return new Pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Fd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=su(n)}setAll(e){let n=Be.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=su(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Fd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Rr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Fd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){uo(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Pt(su(this.value))}}function EP(t){const e=[];return uo(t.fields,(n,r)=>{const i=new Be([n]);if(Fd(r)){const s=EP(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Me(e,0,re.min(),re.min(),re.min(),Pt.empty(),0)}static newFoundDocument(e,n,r,i){return new Me(e,1,n,re.min(),r,i,0)}static newNoDocument(e,n){return new Me(e,2,n,re.min(),re.min(),Pt.empty(),0)}static newUnknownDocument(e,n){return new Me(e,3,n,re.min(),re.min(),Pt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Me&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Me(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,n){this.position=e,this.inclusive=n}}function p0(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=Ji(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function m0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Rr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n="asc"){this.field=e,this.dir=n}}function S4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{}class pe extends TP{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new A4(e,n,r):n==="array-contains"?new x4(e,r):n==="in"?new RP(e,r):n==="not-in"?new P4(e,r):n==="array-contains-any"?new N4(e,r):new pe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new C4(e,r):new R4(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ji(n,this.value)):n!==null&&Ks(this.value)===Ks(n)&&this.matchesComparison(Ji(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ie extends TP{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Ie(e,n)}matches(e){return Ia(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ia(t){return t.op==="and"}function kg(t){return t.op==="or"}function Wy(t){return wP(t)&&Ia(t)}function wP(t){for(const e of t.filters)if(e instanceof Ie)return!1;return!0}function Dg(t){if(t instanceof pe)return t.field.canonicalString()+t.op.toString()+wa(t.value);if(Wy(t))return t.filters.map(e=>Dg(e)).join(",");{const e=t.filters.map(n=>Dg(n)).join(",");return`${t.op}(${e})`}}function IP(t,e){return t instanceof pe?function(r,i){return i instanceof pe&&r.op===i.op&&r.field.isEqual(i.field)&&Rr(r.value,i.value)}(t,e):t instanceof Ie?function(r,i){return i instanceof Ie&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&IP(o,i.filters[a]),!0):!1}(t,e):void X()}function SP(t,e){const n=t.filters.concat(e);return Ie.create(n,t.op)}function AP(t){return t instanceof pe?function(n){return`${n.field.canonicalString()} ${n.op} ${wa(n.value)}`}(t):t instanceof Ie?function(n){return n.op.toString()+" {"+n.getFilters().map(AP).join(" ,")+"}"}(t):"Filter"}class A4 extends pe{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class C4 extends pe{constructor(e,n){super(e,"in",n),this.keys=CP("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class R4 extends pe{constructor(e,n){super(e,"not-in",n),this.keys=CP("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function CP(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class x4 extends pe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hu(n)&&$u(n.arrayValue,this.value)}}class RP extends pe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&$u(this.value.arrayValue,n)}}class P4 extends pe{constructor(e,n){super(e,"not-in",n)}matches(e){if($u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!$u(this.value.arrayValue,n)}}class N4 extends pe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>$u(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Mg(t,e=null,n=[],r=[],i=null,s=null,o=null){return new b4(t,e,n,r,i,s,o)}function js(t){const e=j(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Dg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),dc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>wa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>wa(r)).join(",")),e.ue=n}return e.ue}function hc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!S4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!IP(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!m0(t.startAt,e.startAt)&&m0(t.endAt,e.endAt)}function Sh(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Ah(t,e){return t.filters.filter(n=>n instanceof pe&&n.field.isEqual(e))}function g0(t,e,n){let r=Ud,i=!0;for(const s of Ah(t,e)){let o=Ud,a=!0;switch(s.op){case"<":case"<=":o=w4(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ud}h0({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];h0({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function _0(t,e,n){let r=Pi,i=!0;for(const s of Ah(t,e)){let o=Pi,a=!0;switch(s.op){case">=":case">":o=I4(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Pi}f0({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];f0({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function xP(t,e,n,r,i,s,o,a){return new ii(t,e,n,r,i,s,o,a)}function Ha(t){return new ii(t)}function y0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ky(t){return t.collectionGroup!==null}function sa(t){const e=j(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ae(Be.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new zu(s,r))}),n.has(Be.keyField().canonicalString())||e.ce.push(new zu(Be.keyField(),r))}return e.ce}function sn(t){const e=j(t);return e.le||(e.le=k4(e,sa(t))),e.le}function k4(t,e){if(t.limitType==="F")return Mg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new zu(i.field,s)});const n=t.endAt?new ji(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ji(t.startAt.position,t.startAt.inclusive):null;return Mg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Vg(t,e){const n=t.filters.concat([e]);return new ii(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ch(t,e,n){return new ii(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fc(t,e){return hc(sn(t),sn(e))&&t.limitType===e.limitType}function PP(t){return`${js(sn(t))}|lt:${t.limitType}`}function Po(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>AP(i)).join(", ")}]`),dc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>wa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>wa(i)).join(",")),`Target(${r})`}(sn(t))}; limitType=${t.limitType})`}function pc(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):J.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of sa(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=p0(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,sa(r),i)||r.endAt&&!function(o,a,l){const u=p0(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,sa(r),i))}(t,e)}function NP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function bP(t){return(e,n)=>{let r=!1;for(const i of sa(t)){const s=D4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function D4(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Ji(l,u):X()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){uo(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return gP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4=new be(J.comparator);function _n(){return M4}const kP=new be(J.comparator);function Gl(...t){let e=kP;for(const n of t)e=e.insert(n.key,n);return e}function DP(t){let e=kP;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function vr(){return ou()}function MP(){return ou()}function ou(){return new as(t=>t.toString(),(t,e)=>t.isEqual(e))}const V4=new be(J.comparator),L4=new Ae(J.comparator);function ce(...t){let e=L4;for(const n of t)e=e.add(n);return e}const U4=new Ae(le);function Jy(){return U4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qu(e)?"-0":e}}function VP(t){return{integerValue:""+t}}function LP(t,e){return dP(e)?VP(e):jy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(){this._=void 0}}function F4(t,e,n){return t instanceof Sa?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&wf(s)&&(s=zy(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Qs?FP(t,e):t instanceof Ys?OP(t,e):function(i,s){const o=UP(i,s),a=v0(o)+v0(i.Pe);return bg(o)&&bg(i.Pe)?VP(a):jy(i.serializer,a)}(t,e)}function O4(t,e,n){return t instanceof Qs?FP(t,e):t instanceof Ys?OP(t,e):n}function UP(t,e){return t instanceof Aa?function(r){return bg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Sa extends Sf{}class Qs extends Sf{constructor(e){super(),this.elements=e}}function FP(t,e){const n=BP(e);for(const r of t.elements)n.some(i=>Rr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ys extends Sf{constructor(e){super(),this.elements=e}}function OP(t,e){let n=BP(e);for(const r of t.elements)n=n.filter(i=>!Rr(i,r));return{arrayValue:{values:n}}}class Aa extends Sf{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function v0(t){return Fe(t.integerValue||t.doubleValue)}function BP(t){return Hu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,n){this.field=e,this.transform=n}}function B4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Qs&&i instanceof Qs||r instanceof Ys&&i instanceof Ys?Ta(r.elements,i.elements,Rr):r instanceof Aa&&i instanceof Aa?Rr(r.Pe,i.Pe):r instanceof Sa&&i instanceof Sa}(t.transform,e.transform)}class q4{constructor(e,n){this.version=e,this.transformResults=n}}class qe{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new qe}static exists(e){return new qe(void 0,e)}static updateTime(e){return new qe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Od(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Af{}function qP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wa(t.key,qe.none()):new za(t.key,t.data,qe.none());{const n=t.data,r=Pt.empty();let i=new Ae(Be.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new si(t.key,r,new gn(i.toArray()),qe.none())}}function G4(t,e,n){t instanceof za?function(i,s,o){const a=i.value.clone(),l=T0(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof si?function(i,s,o){if(!Od(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=T0(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(GP(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function au(t,e,n,r){return t instanceof za?function(s,o,a,l){if(!Od(s.precondition,o))return a;const u=s.value.clone(),d=w0(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof si?function(s,o,a,l){if(!Od(s.precondition,o))return a;const u=w0(s.fieldTransforms,l,o),d=o.data;return d.setAll(GP(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return Od(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function $4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=UP(r.transform,i||null);s!=null&&(n===null&&(n=Pt.empty()),n.set(r.field,s))}return n||null}function E0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ta(r,i,(s,o)=>B4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class za extends Af{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class si extends Af{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function GP(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function T0(t,e,n){const r=new Map;te(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,O4(o,a,n[i]))}return r}function w0(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,F4(s,o,e))}return r}class Wa extends Af{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Qy extends Af{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&G4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=au(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=au(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=MP();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=qP(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&Ta(this.mutations,e.mutations,(n,r)=>E0(n,r))&&Ta(this.baseMutations,e.baseMutations,(n,r)=>E0(n,r))}}class Xy{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){te(e.mutations.length===r.length);let i=function(){return V4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Xy(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt,me;function $P(t){switch(t){default:return X();case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0}}function HP(t){if(t===void 0)return rt("GRPC error has no .code"),B.UNKNOWN;switch(t){case lt.OK:return B.OK;case lt.CANCELLED:return B.CANCELLED;case lt.UNKNOWN:return B.UNKNOWN;case lt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case lt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case lt.INTERNAL:return B.INTERNAL;case lt.UNAVAILABLE:return B.UNAVAILABLE;case lt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case lt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case lt.NOT_FOUND:return B.NOT_FOUND;case lt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case lt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case lt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case lt.ABORTED:return B.ABORTED;case lt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case lt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case lt.DATA_LOSS:return B.DATA_LOSS;default:return X()}}(me=lt||(lt={}))[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4=new Us([4294967295,4294967295],0);function I0(t){const e=zP().encode(t),n=new Yx;return n.update(e),new Uint8Array(n.digest())}function S0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Us([n,r],0),new Us([i,s],0)]}class ev{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $l(`Invalid padding: ${n}`);if(r<0)throw new $l(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $l(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new $l(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Us.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Us.fromNumber(r)));return i.compare(z4)===1&&(i=new Us([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=I0(e),[r,i]=S0(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new ev(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=I0(e),[r,i]=S0(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class $l extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,_c.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new gc(re.min(),i,new be(le),_n(),ce())}}class _c{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new _c(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class WP{constructor(e,n){this.targetId=e,this.me=n}}class KP{constructor(e,n,r=Ze.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class A0{constructor(){this.fe=0,this.ge=R0(),this.pe=Ze.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ce(),n=ce(),r=ce();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:X()}}),new _c(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=R0()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class W4{constructor(e){this.Le=e,this.Be=new Map,this.ke=_n(),this.qe=C0(),this.Qe=new be(le)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:X()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Sh(s))if(r===0){const o=new J(s.path);this.Ue(n,o,Me.newNoDocument(o,re.min()))}else te(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Wi(r).toUint8Array()}catch(l){if(l instanceof _P)return Cr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new ev(o,i,s)}catch(l){return Cr(l instanceof $l?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&Sh(a.target)){const l=new J(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Me.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=ce();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new gc(e,n,this.Qe,this.ke,r);return this.ke=_n(),this.qe=C0(),this.Qe=new be(le),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new A0,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ae(le),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||$("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new A0),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function C0(){return new be(J.comparator)}function R0(){return new be(J.comparator)}const K4={asc:"ASCENDING",desc:"DESCENDING"},J4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},j4={and:"AND",or:"OR"};class Q4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Lg(t,e){return t.useProto3Json||dc(e)?e:{value:e}}function Ca(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Y4(t,e){return Ca(t,e.toTimestamp())}function st(t){return te(!!t),re.fromTimestamp(function(n){const r=Qr(n);return new Ge(r.seconds,r.nanos)}(t))}function tv(t,e){return Ug(t,e).canonicalString()}function Ug(t,e){const n=function(i){return new fe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function jP(t){const e=fe.fromString(t);return te(sN(e)),e}function Wu(t,e){return tv(t.databaseId,e.path)}function Ir(t,e){const n=jP(e);if(n.get(1)!==t.databaseId.projectId)throw new G(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(XP(n))}function QP(t,e){return tv(t.databaseId,e)}function YP(t){const e=jP(t);return e.length===4?fe.emptyPath():XP(e)}function Fg(t){return new fe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function XP(t){return te(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function x0(t,e,n){return{name:Wu(t,e),fields:n.value.mapValue.fields}}function ZP(t,e,n){const r=Ir(t,e.name),i=st(e.updateTime),s=e.createTime?st(e.createTime):re.min(),o=new Pt({mapValue:{fields:e.fields}}),a=Me.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function X4(t,e){return"found"in e?function(r,i){te(!!i.found),i.found.name,i.found.updateTime;const s=Ir(r,i.found.name),o=st(i.found.updateTime),a=i.found.createTime?st(i.found.createTime):re.min(),l=new Pt({mapValue:{fields:i.found.fields}});return Me.newFoundDocument(s,o,a,l)}(t,e):"missing"in e?function(r,i){te(!!i.missing),te(!!i.readTime);const s=Ir(r,i.missing),o=st(i.readTime);return Me.newNoDocument(s,o)}(t,e):X()}function Z4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:X()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(te(d===void 0||typeof d=="string"),Ze.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Ze.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?B.UNKNOWN:HP(u.code);return new G(d,u.message||"")}(o);n=new KP(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ir(t,r.document.name),s=st(r.document.updateTime),o=r.document.createTime?st(r.document.createTime):re.min(),a=new Pt({mapValue:{fields:r.document.fields}}),l=Me.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Bd(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ir(t,r.document),s=r.readTime?st(r.readTime):re.min(),o=Me.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Bd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ir(t,r.document),s=r.removedTargetIds||[];n=new Bd([],s,i,null)}else{if(!("filter"in e))return X();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new H4(i,s),a=r.targetId;n=new WP(a,o)}}return n}function Ku(t,e){let n;if(e instanceof za)n={update:x0(t,e.key,e.value)};else if(e instanceof Wa)n={delete:Wu(t,e.key)};else if(e instanceof si)n={update:x0(t,e.key,e.data),updateMask:sq(e.fieldMask)};else{if(!(e instanceof Qy))return X();n={verify:Wu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Sa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Qs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ys)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Aa)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw X()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Y4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:X()}(t,e.precondition)),n}function Og(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?qe.updateTime(st(s.updateTime)):s.exists!==void 0?qe.exists(s.exists):qe.none()}(e.currentDocument):qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)te(a.setToServerValue==="REQUEST_TIME"),l=new Sa;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new Qs(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Ys(d)}else"increment"in a?l=new Aa(o,a.increment):X();const u=Be.fromServerFormat(a.fieldPath);return new mc(u,l)}(t,i)):[];if(e.update){e.update.name;const i=Ir(t,e.update.name),s=new Pt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new gn(u.map(d=>Be.fromServerFormat(d)))}(e.updateMask);return new si(i,s,o,n,r)}return new za(i,s,n,r)}if(e.delete){const i=Ir(t,e.delete);return new Wa(i,n)}if(e.verify){const i=Ir(t,e.verify);return new Qy(i,n)}return X()}function eq(t,e){return t&&t.length>0?(te(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?st(i.updateTime):st(s);return o.isEqual(re.min())&&(o=st(s)),new q4(o,i.transformResults||[])}(n,e))):[]}function eN(t,e){return{documents:[QP(t,e.path)]}}function tN(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=QP(t,i);const s=function(u){if(u.length!==0)return iN(Ie.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:No(m.field),direction:nq(m.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Lg(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function nN(t){let e=YP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){te(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(p){const m=rN(p);return m instanceof Ie&&Wy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(E){return new zu(bo(E.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,dc(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(p){const m=!!p.before,_=p.values||[];return new ji(_,m)}(n.startAt));let u=null;return n.endAt&&(u=function(p){const m=!p.before,_=p.values||[];return new ji(_,m)}(n.endAt)),xP(e,i,o,s,a,"F",l,u)}function tq(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function rN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=bo(n.unaryFilter.field);return pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=bo(n.unaryFilter.field);return pe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bo(n.unaryFilter.field);return pe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bo(n.unaryFilter.field);return pe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(t):t.fieldFilter!==void 0?function(n){return pe.create(bo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ie.create(n.compositeFilter.filters.map(r=>rN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return X()}}(n.compositeFilter.op))}(t):X()}function nq(t){return K4[t]}function rq(t){return J4[t]}function iq(t){return j4[t]}function No(t){return{fieldPath:t.canonicalString()}}function bo(t){return Be.fromServerFormat(t.fieldPath)}function iN(t){return t instanceof pe?function(n){if(n.op==="=="){if(d0(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NAN"}};if(c0(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(d0(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NAN"}};if(c0(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:No(n.field),op:rq(n.op),value:n.value}}}(t):t instanceof Ie?function(n){const r=n.getFilters().map(i=>iN(i));return r.length===1?r[0]:{compositeFilter:{op:iq(n.op),filters:r}}}(t):X()}function sq(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n,r,i,s=re.min(),o=re.min(),a=Ze.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Fr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e){this.ct=e}}function oq(t,e){let n;if(e.document)n=ZP(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=J.fromSegments(e.noDocument.path),i=Zs(e.noDocument.readTime);n=Me.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return X();{const r=J.fromSegments(e.unknownDocument.path),i=Zs(e.unknownDocument.version);n=Me.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Ge(i[0],i[1]);return re.fromTimestamp(s)}(e.readTime)),n}function P0(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Rh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Wu(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ca(s,o.version.toTimestamp()),createTime:Ca(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Xs(e.version)};else{if(!e.isUnknownDocument())return X();r.unknownDocument={path:n.path.toArray(),version:Xs(e.version)}}return r}function Rh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Xs(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zs(t){const e=new Ge(t.seconds,t.nanoseconds);return re.fromTimestamp(e)}function Is(t,e){const n=(e.baseMutations||[]).map(s=>Og(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Og(t.ct,s)),i=Ge.fromMillis(e.localWriteTimeMs);return new Yy(e.batchId,i,n,r)}function Hl(t){const e=Zs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Zs(t.lastLimboFreeSnapshotVersion):re.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return te(s.documents.length===1),sn(Ha(YP(s.documents[0])))}(t.query):function(s){return sn(nN(s))}(t.query),new Fr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ze.fromBase64String(t.resumeToken))}function aN(t,e){const n=Xs(e.snapshotVersion),r=Xs(e.lastLimboFreeSnapshotVersion);let i;i=Sh(e.target)?eN(t.ct,e.target):tN(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:js(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nv(t){const e=nN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ch(e,e.limit,"L"):e}function am(t,e){return new Zy(e.largestBatchId,Og(t.ct,e.overlayMutation))}function N0(t,e){const n=e.path.lastSegment();return[t,rn(e.path.popLast()),n]}function b0(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Xs(r.readTime),documentKey:rn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aq{getBundleMetadata(e,n){return k0(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Zs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return k0(e).put(function(i){return{bundleId:i.id,createTime:Xs(st(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return D0(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nv(s.bundledQuery),readTime:Zs(s.readTime)}}(r)})}saveNamedQuery(e,n){return D0(e).put(function(i){return{name:i.name,readTime:Xs(st(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function k0(t){return _t(t,"bundles")}function D0(t){return _t(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Cf(e,r)}getOverlay(e,n){return Cl(e).get(N0(this.userId,n)).next(r=>r?am(this.serializer,r):null)}getOverlays(e,n){const r=vr();return F.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Zy(n,o);i.push(this.ht(e,a))}),F.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(rn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Cl(e).j("collectionPathOverlayIndex",a))}),F.waitFor(s)}getOverlaysForCollection(e,n,r){const i=vr(),s=rn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Cl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=am(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=vr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Cl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,u,d)=>{const p=am(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return Cl(e).put(function(i,s,o){const[a,l,u]=N0(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ku(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Cl(t){return _t(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lq{Pt(e){return _t(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Ze.fromUint8Array(r):Ze.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Fe(e.integerValue));else if("doubleValue"in e){const r=Fe(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),qu(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Qr(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(Wi(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?yP(e)?this.dt(n,Number.MAX_SAFE_INTEGER):If(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):X()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(Fe(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),J.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Ss.vt=new Ss;function uq(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function M0(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=uq(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class cq{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=M0(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=M0(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class dq{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class hq{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Rl{constructor(){this.jt=new cq,this.Ht=new dq(this.jt),this.Jt=new hq(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new As(this.indexId,this.documentKey,this.arrayValue,r)}}function mi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=V0(t.arrayValue,e.arrayValue),n!==0?n:(n=V0(t.directionalValue,e.directionalValue),n!==0?n:J.comparator(t.documentKey,e.documentKey)))}function V0(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e){this.Xt=new Ae((n,r)=>Be.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(te(e.collectionGroup===this.collectionId),this.nn)return!1;const n=xg(e);if(n!==void 0&&!this.sn(n))return!1;const r=Es(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ae(Be.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Vd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Vd(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Vd(r.field,r.dir==="asc"?0:1)));return new Ih(Ih.UNKNOWN_ID,this.collectionId,n,Bu.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lN(t){var e,n;if(te(t instanceof pe||t instanceof Ie),t instanceof pe){if(t instanceof RP){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>pe.create(t.field,"==",s)))||[];return Ie.create(i,"or")}return t}const r=t.filters.map(i=>lN(i));return Ie.create(r,t.op)}function fq(t){if(t.getFilters().length===0)return[];const e=Gg(lN(t));return te(uN(e)),Bg(e)||qg(e)?[e]:e.getFilters()}function Bg(t){return t instanceof pe}function qg(t){return t instanceof Ie&&Wy(t)}function uN(t){return Bg(t)||qg(t)||function(n){if(n instanceof Ie&&kg(n)){for(const r of n.getFilters())if(!Bg(r)&&!qg(r))return!1;return!0}return!1}(t)}function Gg(t){if(te(t instanceof pe||t instanceof Ie),t instanceof pe)return t;if(t.filters.length===1)return Gg(t.filters[0]);const e=t.filters.map(r=>Gg(r));let n=Ie.create(e,t.op);return n=xh(n),uN(n)?n:(te(n instanceof Ie),te(Ia(n)),te(n.filters.length>1),n.filters.reduce((r,i)=>rv(r,i)))}function rv(t,e){let n;return te(t instanceof pe||t instanceof Ie),te(e instanceof pe||e instanceof Ie),n=t instanceof pe?e instanceof pe?function(i,s){return Ie.create([i,s],"and")}(t,e):U0(t,e):e instanceof pe?U0(e,t):function(i,s){if(te(i.filters.length>0&&s.filters.length>0),Ia(i)&&Ia(s))return SP(i,s.getFilters());const o=kg(i)?i:s,a=kg(i)?s:i,l=o.filters.map(u=>rv(u,a));return Ie.create(l,"or")}(t,e),xh(n)}function U0(t,e){if(Ia(e))return SP(e,t.getFilters());{const n=e.filters.map(r=>rv(t,r));return Ie.create(n,"or")}}function xh(t){if(te(t instanceof pe||t instanceof Ie),t instanceof pe)return t;const e=t.getFilters();if(e.length===1)return xh(e[0]);if(wP(t))return t;const n=e.map(i=>xh(i)),r=[];return n.forEach(i=>{i instanceof pe?r.push(i):i instanceof Ie&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ie.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pq{constructor(){this.un=new iv}addToCollectionParentIndex(e,n){return this.un.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(Nn.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(Nn.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class iv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ae(fe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ae(fe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const od=new Uint8Array(0);class mq{constructor(e,n){this.databaseId=n,this.cn=new iv,this.ln=new as(r=>js(r),(r,i)=>hc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:rn(i)};return F0(e).put(s)}return F.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[sP(n),""],!1,!0);return F0(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(yr(o.parent))}return r})}addFieldIndex(e,n){const r=xl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Ao(e);return s.next(a=>{o.put(b0(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=xl(e),i=Ao(e),s=So(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=xl(e),r=So(e),i=Ao(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return F.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new L0(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=So(e);let i=!0;const s=new Map;return F.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ce();const a=[];return F.forEach(s,(l,u)=>{$("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(l)} to execute ${js(n)}`);const d=function(S,D){const L=xg(D);if(L===void 0)return null;for(const M of Ah(S,L.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(u,l),p=function(S,D){const L=new Map;for(const M of Es(D))for(const R of Ah(S,M.fieldPath))switch(R.op){case"==":case"in":L.set(M.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return L.set(M.fieldPath.canonicalString(),R.value),Array.from(L.values())}return null}(u,l),m=function(S,D){const L=[];let M=!0;for(const R of Es(D)){const I=R.kind===0?g0(S,R.fieldPath,S.startAt):_0(S,R.fieldPath,S.startAt);L.push(I.value),M&&(M=I.inclusive)}return new ji(L,M)}(u,l),_=function(S,D){const L=[];let M=!0;for(const R of Es(D)){const I=R.kind===0?_0(S,R.fieldPath,S.endAt):g0(S,R.fieldPath,S.endAt);L.push(I.value),M&&(M=I.inclusive)}return new ji(L,M)}(u,l),E=this.In(l,u,m),C=this.In(l,u,_),A=this.Tn(l,u,p),w=this.En(l.indexId,d,E,m.inclusive,C,_.inclusive,A);return F.forEach(w,T=>r.G(T,n.limit).next(S=>{S.forEach(D=>{const L=J.fromSegments(D.documentKey);o.has(L)||(o=o.add(L),a.push(L))})}))}).next(()=>a)}return F.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=fq(Ie.create(e.filters,"and")).map(r=>Mg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),d=[];for(let p=0;p<l;++p){const m=n?this.dn(n[p/u]):od,_=this.An(e,m,r[p%u],i),E=this.Rn(e,m,s[p%u],o),C=a.map(A=>this.An(e,m,A,!0));d.push(...this.createRange(_,E,C))}return d}An(e,n,r,i){const s=new As(e,J.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new As(e,J.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new L0(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return F.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Ae(Be.comparator),d=!1;for(const p of l.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:u=u.add(m.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new Rl;for(const i of Es(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);Ss.vt.It(s,o)}return r.zt()}dn(e){const n=new Rl;return Ss.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Rl;return Ss.vt.It(Js(this.databaseId,n),r.Yt(function(s){const o=Es(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new Rl);let s=0;for(const o of Es(e)){const a=r[s++];for(const l of i)if(this.fn(n,o.fieldPath)&&Hu(a))i=this.gn(i,o,a);else{const u=l.Yt(o.kind);Ss.vt.It(a,u)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Rl;l.seed(a.zt()),Ss.vt.It(o,l.Yt(n.kind)),s.push(l)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof pe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=xl(e),i=Ao(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return F.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,p){const m=p?new Bu(p.sequenceNumber,new Nn(Zs(p.readTime),new J(yr(p.documentKey)),p.largestBatchId)):Bu.empty(),_=d.fields.map(([E,C])=>new Vd(Be.fromServerFormat(E),C));return new Ih(d.indexId,d.collectionGroup,_,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:le(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=xl(e),s=Ao(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>F.forEach(a,l=>s.put(b0(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return F.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?F.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),F.forEach(a,l=>this.wn(e,i,l).next(u=>{const d=this.Sn(s,l);return u.isEqual(d)?F.resolve():this.bn(e,s,l,u,d)}))))})}Dn(e,n,r,i){return So(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return So(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=So(e);let s=new Ae(mi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{s=s.add(new As(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,n){let r=new Ae(mi);const i=this.Vn(n,e);if(i==null)return r;const s=xg(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Hu(o))for(const a of o.arrayValue.values||[])r=r.add(new As(n.indexId,e.key,this.dn(a),i))}else r=r.add(new As(n.indexId,e.key,od,i));return r}bn(e,n,r,i,s){$("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,u,d,p,m){const _=l.getIterator(),E=u.getIterator();let C=Io(_),A=Io(E);for(;C||A;){let w=!1,T=!1;if(C&&A){const S=d(C,A);S<0?T=!0:S>0&&(w=!0)}else C!=null?T=!0:w=!0;w?(p(A),A=Io(E)):T?(m(C),C=Io(_)):(C=Io(_),A=Io(E))}}(i,s,mi,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),F.waitFor(o)}yn(e){let n=1;return Ao(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>mi(o,a)).filter((o,a,l)=>!a||mi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=mi(o,e),l=mi(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,od,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,od,[]];s.push(IDBKeyRange.bound(a,l))}return s}Cn(e,n){return mi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(O0)}getMinOffset(e,n){return F.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||X())).next(O0)}}function F0(t){return _t(t,"collectionParents")}function So(t){return _t(t,"indexEntries")}function xl(t){return _t(t,"indexConfiguration")}function Ao(t){return _t(t,"indexState")}function O0(t){te(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Gy(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Nn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class hn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cN(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,p,m)=>(a++,m.delete()));s.push(l.next(()=>{te(a===1)}));const u=[];for(const d of n.mutations){const p=hP(e,d.key.path,n.batchId);s.push(i.delete(p)),u.push(d.key)}return F.waitFor(s).next(()=>u)}function Ph(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw X();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(41943040,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class Rf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){te(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Rf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=ko(e),o=gi(e);return o.add({}).next(a=>{te(typeof a=="number");const l=new Yy(a,n,r,i),u=function(_,E,C){const A=C.baseMutations.map(T=>Ku(_.ct,T)),w=C.mutations.map(T=>Ku(_.ct,T));return{userId:E,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:A,mutations:w}}(this.serializer,this.userId,l),d=[];let p=new Ae((m,_)=>le(m.canonicalString(),_.canonicalString()));for(const m of i){const _=hP(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),d.push(o.put(u)),d.push(s.put(_,t4))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),F.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return gi(e).get(n).next(r=>r?(te(r.userId===this.userId),Is(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?F.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return gi(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(te(a.batchId>=r),s=Is(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return gi(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gi(e).U("userMutationsIndex",n).next(r=>r.map(i=>Is(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ld(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ko(e).J({range:i},(o,a,l)=>{const[u,d,p]=o,m=yr(d);if(u===this.userId&&n.path.isEqual(m))return gi(e).get(p).next(_=>{if(!_)throw X();te(_.userId===this.userId),s.push(Is(this.serializer,_))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(le);const i=[];return n.forEach(s=>{const o=Ld(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=ko(e).J({range:a},(u,d,p)=>{const[m,_,E]=u,C=yr(_);m===this.userId&&s.path.isEqual(C)?r=r.add(E):p.done()});i.push(l)}),F.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Ld(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ae(le);return ko(e).J({range:o},(l,u,d)=>{const[p,m,_]=l,E=yr(m);p===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(_)):d.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(gi(e).get(s).next(o=>{if(o===null)throw X();te(o.userId===this.userId),r.push(Is(this.serializer,o))}))}),F.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return cN(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),F.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return F.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ko(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=yr(s[1]);i.push(l)}else a.done()}).next(()=>{te(i.length===0)})})}containsKey(e,n){return dN(e,this.userId,n)}Nn(e){return hN(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function dN(t,e,n){const r=Ld(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return ko(t).J({range:s,H:!0},(a,l,u)=>{const[d,p,m]=a;d===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function gi(t){return _t(t,"mutations")}function ko(t){return _t(t,"documentMutations")}function hN(t){return _t(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new eo(0)}static kn(){return new eo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gq{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new eo(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>re.fromTimestamp(new Ge(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Co(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(te(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Co(e).J((o,a)=>{const l=Hl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>F.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Co(e).J((r,i)=>{const s=Hl(i);n(s)})}qn(e){return q0(e).get("targetGlobalKey").next(n=>(te(n!==null),n))}Qn(e,n){return q0(e).put("targetGlobalKey",n)}Kn(e,n){return Co(e).put(aN(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=js(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Co(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const u=Hl(a);hc(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Ii(e);return n.forEach(o=>{const a=rn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),F.waitFor(i)}removeMatchingKeys(e,n,r){const i=Ii(e);return F.forEach(n,s=>{const o=rn(s.path);return F.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Ii(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Ii(e);let s=ce();return i.J({range:r,H:!0},(o,a,l)=>{const u=yr(o[1]),d=new J(u);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=rn(n.path),i=IDBKeyRange.bound([r],[sP(r)],!1,!0);let s=0;return Ii(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,n){return Co(e).get(n).next(r=>r?Hl(r):null)}}function Co(t){return _t(t,"targets")}function q0(t){return _t(t,"targetGlobal")}function Ii(t){return _t(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0([t,e],[n,r]){const i=le(t,n);return i===0?le(e,r):i}class _q{constructor(e){this.Un=e,this.buffer=new Ae(G0),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();G0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class yq{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){$("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){os(n)?$("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ss(n)}await this.Hn(3e5)})}}class vq{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return F.resolve(mn.oe);const r=new _q(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?($("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(B0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?($("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),B0):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?($("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),xo()<=de.DEBUG&&$("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function Eq(t,e){return new vq(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tq{constructor(e,n){this.db=e,this.garbageCollector=Eq(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return ad(e,r)}removeReference(e,n,r){return ad(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ad(e,n)}nr(e,n){return function(i,s){let o=!1;return hN(i).Y(a=>dN(i,a,s).next(l=>(l&&(o=!0),F.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=n){const l=this.nr(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,re.min()),Ii(e).delete(function(p){return[0,rn(p.path)]}(o))))});i.push(l)}}).next(()=>F.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ad(e,n)}tr(e,n){const r=Ii(e);let i,s=mn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==mn.oe&&n(new J(yr(i)),s),s=u,i=l):s=mn.oe}).next(()=>{s!==mn.oe&&n(new J(yr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ad(t,e){return Ii(t).put(function(r,i){return{targetId:0,path:rn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(){this.changes=new as(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Me.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return gs(e).put(r)}removeEntry(e,n,r){return gs(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Rh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Me.newInvalidDocument(n);return gs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Pl(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:Me.newInvalidDocument(n)};return gs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Pl(n))},(i,s)=>{r={document:this.ir(n,s),size:Ph(s)}}).next(()=>r)}getEntries(e,n){let r=_n();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=_n(),i=new be(J.comparator);return this._r(e,n,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,Ph(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return F.resolve();let i=new Ae(z0);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Pl(i.first()),Pl(i.last())),o=i.getIterator();let a=o.getNext();return gs(e).J({index:"documentKeyIndex",range:s},(l,u,d)=>{const p=J.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&z0(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(Pl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Rh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gs(e).U(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=_n();for(const p of u){const m=this.ir(J.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(pc(n,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=_n();const o=H0(n,r),a=H0(n,Nn.max());return gs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,d)=>{const p=this.ir(J.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new Iq(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return $0(e).get("remoteDocumentGlobalKey").next(n=>(te(!!n),n))}rr(e,n){return $0(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=oq(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(re.min())))return r}return Me.newInvalidDocument(e)}}function pN(t){return new wq(t)}class Iq extends fN{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new as(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ae((s,o)=>le(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=P0(this.cr.serializer,o);i=i.add(s.path.popLast());const u=Ph(l);r+=u-a.size,n.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=P0(this.cr.serializer,o.convertToNoDocument(re.min()));n.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),F.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function $0(t){return _t(t,"remoteDocumentGlobal")}function gs(t){return _t(t,"remoteDocumentsV14")}function Pl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function H0(t,e){const n=e.documentKey.path.toArray();return[t,Rh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function z0(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=le(n[s],r[s]),i)return i;return i=le(n.length,r.length),i||(i=le(n[n.length-2],r[r.length-2]),i||le(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sq{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&au(r.mutation,i,gn.empty(),Ge.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const i=vr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Gl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=vr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=_n();const o=ou(),a=function(){return ou()}();return n.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof si)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),au(d.mutation,u,d.mutation.getFieldMask(),Ge.now())):o.set(u.key,gn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var p;return a.set(u,new Sq(d,(p=o.get(u))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){const r=ou();let i=new be((o,a)=>o-a),s=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||gn.empty();d=a.applyToLocalView(u,d),r.set(l,d);const p=(i.get(a.batchId)||ce()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,p=MP();d.forEach(m=>{if(!s.has(m)){const _=qP(n.get(m),r.get(m));_!==null&&p.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ky(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):F.resolve(vr());let a=-1,l=s;return o.next(u=>F.forEach(u,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?F.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ce())).next(d=>({batchId:a,changes:DP(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let i=Gl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Gl();return this.indexManager.getCollectionParents(e,s).next(a=>F.forEach(a,l=>{const u=function(p,m){return new ii(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Me.newInvalidDocument(d)))});let a=Gl();return o.forEach((l,u)=>{const d=s.get(l);d!==void 0&&au(d.mutation,u,gn.empty(),Ge.now()),pc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aq{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return F.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:st(i.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:nv(i.bundledQuery),readTime:st(i.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cq{constructor(){this.overlays=new be(J.comparator),this.Ir=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=vr();return F.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const i=vr(),s=n.length+1,o=new J(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return F.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new be((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=vr(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=vr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return F.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Zy(n,r));let s=this.Ir.get(n);s===void 0&&(s=ce(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rq{constructor(){this.sessionToken=Ze.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.Tr=new Ae(yt.Er),this.dr=new Ae(yt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new yt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new yt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new J(new fe([])),r=new yt(n,e),i=new yt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new J(new fe([])),r=new yt(n,e),i=new yt(n,e+1);let s=ce();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new yt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class yt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return J.comparator(e.key,n.key)||le(e.wr,n.wr)}static Ar(e,n){return le(e.wr,n.wr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xq{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ae(yt.Er)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Yy(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new yt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return F.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new yt(n,0),i=new yt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),F.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(le);return n.forEach(i=>{const s=new yt(i,0),o=new yt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),F.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;J.isDocumentKey(s)||(s=s.child(""));const o=new yt(new J(s),0);let a=new Ae(le);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.wr)),!0)},o),F.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){te(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return F.forEach(n.mutations,i=>{const s=new yt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new yt(n,0),i=this.br.firstAfterOrEqual(r);return F.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pq{constructor(e){this.Mr=e,this.docs=function(){return new be(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():Me.newInvalidDocument(n))}getEntries(e,n){let r=_n();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Me.newInvalidDocument(i))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=_n();const o=n.path,a=new J(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Gy(aP(d),r)<=0||(i.has(d.key)||pc(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return F.resolve(s)}getAllFromCollectionGroup(e,n,r,i){X()}Or(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Nq(this)}getSize(e){return F.resolve(this.size)}}class Nq extends fN{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bq{constructor(e){this.persistence=e,this.Nr=new as(n=>js(n),hc),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Lr=0,this.Br=new sv,this.targetCount=0,this.kr=eo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),F.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new eo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.Kn(n),F.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),F.waitFor(s).next(()=>i)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),F.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,n){this.qr={},this.overlays={},this.Qr=new mn(0),this.Kr=!1,this.Kr=!0,this.$r=new Rq,this.referenceDelegate=e(this),this.Ur=new bq(this),this.indexManager=new pq,this.remoteDocumentCache=function(i){return new Pq(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new oN(n),this.Gr=new Aq(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Cq,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new xq(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){$("MemoryPersistence","Starting transaction:",e);const i=new kq(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return F.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class kq extends uP{constructor(e){super(),this.currentSequenceNumber=e}}class xf{constructor(e){this.persistence=e,this.Jr=new sv,this.Yr=null}static Zr(e){return new xf(e)}get Xr(){if(this.Yr)return this.Yr;throw X()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),F.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Xr,r=>{const i=J.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,re.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return F.or([()=>F.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dq{constructor(e){this.serializer=e}O(e,n,r,i){const s=new Tf("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",s0,{unique:!0}),l.createObjectStore("documentMutations")}(e),W0(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=F.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),W0(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",s0,{unique:!0});const p=u.store("mutations"),m=d.map(_=>p.put(_));return F.waitFor(m)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:f4});u.createIndex("collectionPathOverlayIndex",p4,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",m4,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:n4});u.createIndex("documentKeyIndex",r4),u.createIndex("collectionGroupIndex",i4)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:u4}).createIndex("sequenceNumberIndex",c4,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:d4}).createIndex("documentKeyIndex",h4,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Ph(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>F.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>F.forEach(a,l=>{te(l.userId===s.userId);const u=Is(this.serializer,l);return cN(e,s.userId,u).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new fe(o),u=function(p){return[0,rn(p)]}(l);s.push(n.get(u).next(d=>d?F.resolve():(p=>n.put({targetId:0,path:rn(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>F.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:l4});const r=n.store("collectionParents"),i=new iv,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:rn(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new fe(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],u)=>{const d=yr(a);return s(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=Hl(i),o=aN(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(p){return p.document?new J(fe.fromString(p.document.name).popFirst(5)):p.noDocument?J.fromSegments(p.noDocument.path):p.unknownDocument?J.fromSegments(p.unknownDocument.path):X()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>F.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=pN(this.serializer),s=new gN(xf.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var u;let d=(u=a.get(l.userId))!==null&&u!==void 0?u:ce();Is(this.serializer,l).keys().forEach(p=>d=d.add(p)),a.set(l.userId,d)}),F.forEach(a,(l,u)=>{const d=new Et(u),p=Cf.lt(this.serializer,d),m=s.getIndexManager(d),_=Rf.lt(d,this.serializer,m,s.referenceDelegate);return new mN(i,_,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Pg(n,mn.oe),l).next()})})}}function W0(t){t.createObjectStore("targetDocuments",{keyPath:o4}).createIndex("documentTargetsIndex",a4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",s4,{unique:!0}),t.createObjectStore("targetGlobal")}const lm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ov{constructor(e,n,r,i,s,o,a,l,u,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=u,this.li=d,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!ov.D())throw new G(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Tq(this,i),this.Ai=n+"main",this.serializer=new oN(l),this.Ri=new wr(this.Ai,this.hi,new Dq(this.serializer)),this.$r=new lq,this.Ur=new gq(this.referenceDelegate,this.serializer),this.remoteDocumentCache=pN(this.serializer),this.Gr=new aq,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&rt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new G(B.FAILED_PRECONDITION,lm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new mn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ld(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(os(e))return $("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return $("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Nl(e).get("owner").next(n=>F.resolve(this.vi(n)))}Ci(e){return ld(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=_t(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return F.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?F.resolve(!0):Nl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new G(B.FAILED_PRECONDITION,lm);return!1}}return!(!this.networkEnabled||!this.inForeground)||ld(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&$("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Pg(e,mn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ld(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Rf.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mq(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Cf.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){$("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?y4:l===16?_4:l===15?Hy:l===14?mP:l===13?pP:l===12?g4:l===11?fP:void X()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new Pg(a,this.Qr?this.Qr.next():mn.oe),n==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw rt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new G(B.FAILED_PRECONDITION,lP);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Nl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new G(B.FAILED_PRECONDITION,lm)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Nl(e).put("owner",n)}static D(){return wr.D()}bi(e){const n=Nl(e);return n.get("owner").next(r=>this.vi(r)?($("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):F.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(rt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;OR()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return $("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return rt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){rt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Nl(t){return _t(t,"owner")}function ld(t){return _t(t,"clientMetadata")}function av(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=ce(),i=ce();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new lv(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return OR()?8:cP(Ke())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Mq;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(xo()<=de.DEBUG&&$("QueryEngine","SDK will not create cache indexes for query:",Po(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),F.resolve()):(xo()<=de.DEBUG&&$("QueryEngine","Query:",Po(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(xo()<=de.DEBUG&&$("QueryEngine","The SDK decides to create cache indexes for query:",Po(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,sn(n))):F.resolve())}Yi(e,n){if(y0(n))return F.resolve(null);let r=sn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ch(n,null,"F"),r=sn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ce(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(n,a);return this.ns(n,u,o,l.readTime)?this.Yi(e,Ch(n,null,"F")):this.rs(e,u,n,l)}))})))}Zi(e,n,r,i){return y0(n)||i.isEqual(re.min())?F.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?F.resolve(null):(xo()<=de.DEBUG&&$("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Po(n)),this.rs(e,o,n,oP(i,-1)).next(a=>a))})}ts(e,n){let r=new Ae(bP(e));return n.forEach((i,s)=>{pc(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return xo()<=de.DEBUG&&$("QueryEngine","Using full collection scan to execute query:",Po(n)),this.Ji.getDocumentsMatchingQuery(e,n,Nn.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vq{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new be(le),this._s=new as(s=>js(s),hc),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mN(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function yN(t,e,n,r){return new Vq(t,e,n,r)}async function vN(t,e){const n=j(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ce();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function Lq(t,e){const n=j(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const p=u.batch,m=p.keys();let _=F.resolve();return m.forEach(E=>{_=_.next(()=>d.getEntry(l,E)).next(C=>{const A=u.docVersions.get(E);te(A!==null),C.version.compareTo(A)<0&&(p.applyToRemoteDocument(C,u),C.isValidDocument()&&(C.setReadTime(u.commitVersion),d.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ce();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function EN(t){const e=j(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function Uq(t,e){const n=j(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((d,p)=>{const m=i.get(p);if(!m)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,p)));let _=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?_=_.withResumeToken(Ze.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(p,_),function(C,A,w){return C.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,_,d)&&a.push(n.Ur.updateTargetData(s,_))});let l=_n(),u=ce();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(TN(s,o,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!r.isEqual(re.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(p=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return F.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.os=i,s))}function TN(t,e,n){let r=ce(),i=ce();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=_n();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(re.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):$("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function Fq(t,e){const n=j(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ra(t,e){const n=j(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,F.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new Fr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function xa(t,e,n){const r=j(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!os(o))throw o;$("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Nh(t,e,n){const r=j(t);let i=re.min(),s=ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const p=j(l),m=p._s.get(d);return m!==void 0?F.resolve(p.os.get(m)):p.Ur.getTargetData(u,d)}(r,o,sn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:re.min(),n?s:ce())).next(a=>(SN(r,NP(e),a),{documents:a,Ts:s})))}function wN(t,e){const n=j(t),r=j(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function IN(t,e){const n=j(t),r=n.us.get(e)||re.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,oP(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(SN(n,e,i),i))}function SN(t,e,n){let r=t.us.get(e)||re.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}async function Oq(t,e,n,r){const i=j(t);let s=ce(),o=_n();for(const u of n){const d=e.Es(u.metadata.name);u.document&&(s=s.add(d));const p=e.ds(u);p.setReadTime(e.As(u.metadata.readTime)),o=o.insert(d,p)}const a=i.cs.newChangeBuffer({trackRemovals:!0}),l=await Ra(i,function(d){return sn(Ha(fe.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>TN(u,a,o).next(d=>(a.apply(u),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(u,l.targetId).next(()=>i.Ur.addMatchingKeys(u,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,d.Ps,d.Is)).next(()=>d.Ps)))}async function Bq(t,e,n=ce()){const r=await Ra(t,sn(nv(e.bundledQuery))),i=j(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=st(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Gr.saveNamedQuery(s,e);const a=r.withResumeToken(Ze.EMPTY_BYTE_STRING,o);return i.os=i.os.insert(a.targetId,a),i.Ur.updateTargetData(s,a).next(()=>i.Ur.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Ur.addMatchingKeys(s,n,r.targetId)).next(()=>i.Gr.saveNamedQuery(s,e))})}function K0(t,e){return`firestore_clients_${t}_${e}`}function J0(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function um(t,e){return`firestore_targets_${t}_${e}`}class bh{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new G(i.error.code,i.error.message))),o?new bh(e,n,i.state,s):(rt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class lu{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new G(r.error.code,r.error.message))),s?new lu(e,r.state,i):(rt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class kh{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Jy();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=dP(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new kh(e,s):(rt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class uv{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new uv(n.clientId,n.onlineState):(rt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class $g{constructor(){this.activeTargetIds=Jy()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cm{constructor(e,n,r,i,s){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new be(le),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=K0(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new $g),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(K0(this.persistenceKey,r));if(i){const s=kh.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(um(this.persistenceKey,e));if(i){const s=lu.Rs(e,i);s&&(r=s.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(um(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return $("SharedClientState","READ",e,n),n}setItem(e,n){$("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){$("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if($("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void rt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(s){let o=mn.oe;if(s!=null)try{const a=JSON.parse(s);te(typeof a=="number"),o=a}catch(a){rt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==mn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new bh(this.currentUser,e,n,r),s=J0(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const n=J0(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=um(this.persistenceKey,e),s=new lu(e,n,r);this.setItem(i,s.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return kh.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return bh.Rs(new Et(s),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return lu.Rs(i,n)}Ls(e){return uv.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);$("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=Jy();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class AN{constructor(){this.so=new $g,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new $g,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qq{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){$("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){$("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ud=null;function dm(){return ud===null?ud=function(){return 268435456+Math.round(2147483648*Math.random())}():ud++,"0x"+ud.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $q{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bt="WebChannelConnection";class Hq extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=dm(),l=this.xo(n,r.toUriEncodedString());$("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(n,l,u,i).then(d=>($("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw Cr("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$a}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=Gq[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=dm();return new Promise((o,a)=>{const l=new Xx;l.setWithCredentials(!0),l.listenOnce(Zx.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Md.NO_ERROR:const d=l.getResponseJson();$(Bt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Md.TIMEOUT:$(Bt,`RPC '${e}' ${s} timed out`),a(new G(B.DEADLINE_EXCEEDED,"Request time out"));break;case Md.HTTP_ERROR:const p=l.getStatus();if($(Bt,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const E=function(A){const w=A.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(w)>=0?w:B.UNKNOWN}(_.status);a(new G(E,_.message))}else a(new G(B.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new G(B.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{$(Bt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);$(Bt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}Bo(e,n,r){const i=dm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=nP(),a=tP(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");$(Bt,`Creating RPC '${e}' stream ${i}: ${d}`,l);const p=o.createWebChannel(d,l);let m=!1,_=!1;const E=new $q({Io:A=>{_?$(Bt,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(m||($(Bt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),$(Bt,`RPC '${e}' stream ${i} sending:`,A),p.send(A))},To:()=>p.close()}),C=(A,w,T)=>{A.listen(w,S=>{try{T(S)}catch(D){setTimeout(()=>{throw D},0)}})};return C(p,ql.EventType.OPEN,()=>{_||($(Bt,`RPC '${e}' stream ${i} transport opened.`),E.yo())}),C(p,ql.EventType.CLOSE,()=>{_||(_=!0,$(Bt,`RPC '${e}' stream ${i} transport closed`),E.So())}),C(p,ql.EventType.ERROR,A=>{_||(_=!0,Cr(Bt,`RPC '${e}' stream ${i} transport errored:`,A),E.So(new G(B.UNAVAILABLE,"The operation could not be completed")))}),C(p,ql.EventType.MESSAGE,A=>{var w;if(!_){const T=A.data[0];te(!!T);const S=T,D=S.error||((w=S[0])===null||w===void 0?void 0:w.error);if(D){$(Bt,`RPC '${e}' stream ${i} received error:`,D);const L=D.status;let M=function(P){const N=lt[P];if(N!==void 0)return HP(N)}(L),R=D.message;M===void 0&&(M=B.INTERNAL,R="Unknown error status: "+L+" with message "+D.message),_=!0,E.So(new G(M,R)),p.close()}else $(Bt,`RPC '${e}' stream ${i} received:`,T),E.bo(T)}}),C(a,eP.STAT_EVENT,A=>{A.stat===Rg.PROXY?$(Bt,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===Rg.NOPROXY&&$(Bt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CN(){return typeof window<"u"?window:null}function qd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yc(t){return new Q4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&$("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e,n,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new cv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(rt(n.toString()),rt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new G(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return $("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():($("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zq extends RN{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=Z4(this.serializer,e),r=function(s){if(!("targetChange"in s))return re.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?st(o.readTime):re.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Fg(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Sh(l)?{documents:eN(s,l)}:{query:tN(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=JP(s,o.resumeToken);const u=Lg(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(re.min())>0){a.readTime=Ca(s,o.snapshotVersion.toTimestamp());const u=Lg(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=tq(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Fg(this.serializer),n.removeTarget=e,this.a_(n)}}class Wq extends RN{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return te(!!e.streamToken),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=eq(e.writeResults,e.commitTime),r=st(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Fg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ku(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kq extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new G(B.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Ug(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(B.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Ug(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(B.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Jq{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(rt(n),this.D_=!1):$("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jq{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{ls(this)&&($("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=j(l);u.L_.add(4),await Ka(u),u.q_.set("Unknown"),u.L_.delete(4),await vc(u)}(this))})}),this.q_=new Jq(r,i)}}async function vc(t){if(ls(t))for(const e of t.B_)await e(!0)}async function Ka(t){for(const e of t.B_)await e(!1)}function Pf(t,e){const n=j(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),fv(n)?hv(n):ja(n).r_()&&dv(n,e))}function Pa(t,e){const n=j(t),r=ja(n);n.N_.delete(e),r.r_()&&xN(n,e),n.N_.size===0&&(r.r_()?r.o_():ls(n)&&n.q_.set("Unknown"))}function dv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ja(t).A_(e)}function xN(t,e){t.Q_.xe(e),ja(t).R_(e)}function hv(t){t.Q_=new W4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ja(t).start(),t.q_.v_()}function fv(t){return ls(t)&&!ja(t).n_()&&t.N_.size>0}function ls(t){return j(t).L_.size===0}function PN(t){t.Q_=void 0}async function Qq(t){t.q_.set("Online")}async function Yq(t){t.N_.forEach((e,n)=>{dv(t,e)})}async function Xq(t,e){PN(t),fv(t)?(t.q_.M_(e),hv(t)):t.q_.set("Unknown")}async function Zq(t,e,n){if(t.q_.set("Online"),e instanceof KP&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){$("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Dh(t,r)}else if(e instanceof Bd?t.Q_.Ke(e):e instanceof WP?t.Q_.He(e):t.Q_.We(e),!n.isEqual(re.min()))try{const r=await EN(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(Ze.EMPTY_BYTE_STRING,d.snapshotVersion)),xN(s,l);const p=new Fr(d.target,l,u,d.sequenceNumber);dv(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){$("RemoteStore","Failed to raise snapshot:",r),await Dh(t,r)}}async function Dh(t,e,n){if(!os(e))throw e;t.L_.add(1),await Ka(t),t.q_.set("Offline"),n||(n=()=>EN(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{$("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await vc(t)})}function NN(t,e){return e().catch(n=>Dh(t,n,e))}async function Ja(t){const e=j(t),n=Qi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;eG(e);)try{const i=await Fq(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,tG(e,i)}catch(i){await Dh(e,i)}bN(e)&&kN(e)}function eG(t){return ls(t)&&t.O_.length<10}function tG(t,e){t.O_.push(e);const n=Qi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function bN(t){return ls(t)&&!Qi(t).n_()&&t.O_.length>0}function kN(t){Qi(t).start()}async function nG(t){Qi(t).p_()}async function rG(t){const e=Qi(t);for(const n of t.O_)e.m_(n.mutations)}async function iG(t,e,n){const r=t.O_.shift(),i=Xy.from(r,e,n);await NN(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ja(t)}async function sG(t,e){e&&Qi(t).V_&&await async function(r,i){if(function(o){return $P(o)&&o!==B.ABORTED}(i.code)){const s=r.O_.shift();Qi(r).s_(),await NN(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ja(r)}}(t,e),bN(t)&&kN(t)}async function Q0(t,e){const n=j(t);n.asyncQueue.verifyOperationInProgress(),$("RemoteStore","RemoteStore received new credentials");const r=ls(n);n.L_.add(3),await Ka(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await vc(n)}async function Hg(t,e){const n=j(t);e?(n.L_.delete(2),await vc(n)):e||(n.L_.add(2),await Ka(n),n.q_.set("Unknown"))}function ja(t){return t.K_||(t.K_=function(n,r,i){const s=j(n);return s.w_(),new zq(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:Qq.bind(null,t),Ro:Yq.bind(null,t),mo:Xq.bind(null,t),d_:Zq.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),fv(t)?hv(t):t.q_.set("Unknown")):(await t.K_.stop(),PN(t))})),t.K_}function Qi(t){return t.U_||(t.U_=function(n,r,i){const s=j(n);return s.w_(),new Wq(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:nG.bind(null,t),mo:sG.bind(null,t),f_:rG.bind(null,t),g_:iG.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Ja(t)):(await t.U_.stop(),t.O_.length>0&&($("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new bt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new pv(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qa(t,e){if(rt("AsyncQueue",`${e}: ${t}`),os(t))return new G(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=Gl(),this.sortedSet=new be(this.comparator)}static emptySet(e){return new oa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof oa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new oa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(){this.W_=new be(J.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):X():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Na{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Na(e,n,oa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oG{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class aG{constructor(){this.queries=X0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=j(n),s=i.queries;i.queries=X0(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new G(B.ABORTED,"Firestore shutting down"))}}function X0(){return new as(t=>PP(t),fc)}async function mv(t,e){const n=j(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new oG,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Qa(o,`Initialization of query '${Po(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&_v(n)}async function gv(t,e){const n=j(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function lG(t,e){const n=j(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&_v(n)}function uG(t,e,n){const r=j(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function _v(t){t.Y_.forEach(e=>{e.next()})}var zg,Z0;(Z0=zg||(zg={})).ea="default",Z0.Cache="cache";class yv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Na(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Na.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==zg.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cG{constructor(e,n){this.aa=e,this.byteLength=n}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(e){this.serializer=e}Es(e){return Ir(this.serializer,e)}ds(e){return e.metadata.exists?ZP(this.serializer,e.document,!1):Me.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return st(e)}}class dG{constructor(e,n,r){this.ca=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=DN(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++n;const r=fe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ha(e){const n=new Map,r=new eI(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Es(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||ce()).add(s);n.set(o,a)}}return n}async complete(){const e=await Oq(this.localStore,new eI(this.serializer),this.documents,this.ca.id),n=this.ha(this.documents);for(const r of this.queries)await Bq(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function DN(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e){this.key=e}}class VN{constructor(e){this.key=e}}class LN{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ce(),this.mutatedKeys=ce(),this.Aa=bP(e),this.Ra=new oa(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Y0,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{const m=i.get(d),_=pc(this.query,p)?p:null,E=!!m&&this.mutatedKeys.has(m.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let A=!1;m&&_?m.data.isEqual(_.data)?E!==C&&(r.track({type:3,doc:_}),A=!0):this.ga(m,_)||(r.track({type:2,doc:_}),A=!0,(l&&this.Aa(_,l)>0||u&&this.Aa(_,u)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),A=!0):m&&!_&&(r.track({type:1,doc:m}),A=!0,(l||u)&&(a=!0)),A&&(_?(o=o.add(_),s=C?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,p)=>function(_,E){const C=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return C(_)-C(E)}(d.type,p.type)||this.Aa(d.doc,p.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new Na(this.query,e.Ra,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Y0,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ce(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new VN(r))}),this.da.forEach(r=>{e.has(r)||n.push(new MN(r))}),n}ba(e){this.Ta=e.Ts,this.da=ce();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Na.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class hG{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class fG{constructor(e){this.key=e,this.va=!1}}class pG{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new as(a=>PP(a),fc),this.Ma=new Map,this.xa=new Set,this.Oa=new be(J.comparator),this.Na=new Map,this.La=new sv,this.Ba={},this.ka=new Map,this.qa=eo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function mG(t,e,n=!0){const r=Nf(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await UN(r,e,n,!0),i}async function gG(t,e){const n=Nf(t);await UN(n,e,!0,!1)}async function UN(t,e,n,r){const i=await Ra(t.localStore,sn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await vv(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Pf(t.remoteStore,i),a}async function vv(t,e,n,r,i){t.Ka=(p,m,_)=>async function(C,A,w,T){let S=A.view.ma(w);S.ns&&(S=await Nh(C.localStore,A.query,!1).then(({documents:R})=>A.view.ma(R,S)));const D=T&&T.targetChanges.get(A.targetId),L=T&&T.targetMismatches.get(A.targetId)!=null,M=A.view.applyChanges(S,C.isPrimaryClient,D,L);return Wg(C,A.targetId,M.wa),M.snapshot}(t,p,m,_);const s=await Nh(t.localStore,e,!0),o=new LN(e,s.Ts),a=o.ma(s.documents),l=_c.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);Wg(t,n,u.wa);const d=new hG(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function _G(t,e,n){const r=j(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!fc(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xa(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Pa(r.remoteStore,i.targetId),ba(r,i.targetId)}).catch(ss)):(ba(r,i.targetId),await xa(r.localStore,i.targetId,!0))}async function yG(t,e){const n=j(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Pa(n.remoteStore,r.targetId))}async function vG(t,e,n){const r=Iv(t);try{const i=await function(o,a){const l=j(o),u=Ge.now(),d=a.reduce((_,E)=>_.add(E.key),ce());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=_n(),C=ce();return l.cs.getEntries(_,d).next(A=>{E=A,E.forEach((w,T)=>{T.isValidDocument()||(C=C.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,E)).next(A=>{p=A;const w=[];for(const T of a){const S=$4(T,p.get(T.key).overlayedDocument);S!=null&&w.push(new si(T.key,S,EP(S.value.mapValue),qe.exists(!0)))}return l.mutationQueue.addMutationBatch(_,u,w,a)}).next(A=>{m=A;const w=A.applyToLocalDocumentSet(p,C);return l.documentOverlayCache.saveOverlays(_,A.batchId,w)})}).then(()=>({batchId:m.batchId,changes:DP(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new be(le)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,n),await oi(r,i.changes),await Ja(r.remoteStore)}catch(i){const s=Qa(i,"Failed to persist write");n.reject(s)}}async function FN(t,e){const n=j(t);try{const r=await Uq(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?te(o.va):i.removedDocuments.size>0&&(te(o.va),o.va=!1))}),await oi(n,r,e)}catch(r){await ss(r)}}function tI(t,e,n){const r=j(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=j(o);l.onlineState=a;let u=!1;l.queries.forEach((d,p)=>{for(const m of p.j_)m.Z_(a)&&(u=!0)}),u&&_v(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function EG(t,e,n){const r=j(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new be(J.comparator);o=o.insert(s,Me.newNoDocument(s,re.min()));const a=ce().add(s),l=new gc(re.min(),new Map,new be(le),o,a);await FN(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),wv(r)}else await xa(r.localStore,e,!1).then(()=>ba(r,e,n)).catch(ss)}async function TG(t,e){const n=j(t),r=e.batch.batchId;try{const i=await Lq(n.localStore,e);Tv(n,r,null),Ev(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await oi(n,i)}catch(i){await ss(i)}}async function wG(t,e,n){const r=j(t);try{const i=await function(o,a){const l=j(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(te(p!==null),d=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);Tv(r,e,n),Ev(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await oi(r,i)}catch(i){await ss(i)}}async function IG(t,e){const n=j(t);ls(n.remoteStore)||$("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=j(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ka.get(r)||[];i.push(e),n.ka.set(r,i)}catch(r){const i=Qa(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Ev(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Tv(t,e,n){const r=j(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ba(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||ON(t,r)})}function ON(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Pa(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),wv(t))}function Wg(t,e,n){for(const r of n)r instanceof MN?(t.La.addReference(r.key,e),SG(t,r)):r instanceof VN?($("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||ON(t,r.key)):X()}function SG(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||($("SyncEngine","New document in limbo: "+n),t.xa.add(r),wv(t))}function wv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new J(fe.fromString(e)),r=t.qa.next();t.Na.set(r,new fG(n)),t.Oa=t.Oa.insert(n,r),Pf(t.remoteStore,new Fr(sn(Ha(n.path)),r,"TargetPurposeLimboResolution",mn.oe))}}async function oi(t,e,n){const r=j(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const p=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=lv.Wi(l.targetId,u);s.push(p)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,u){const d=j(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>F.forEach(u,m=>F.forEach(m.$i,_=>d.persistence.referenceDelegate.addReference(p,m.targetId,_)).next(()=>F.forEach(m.Ui,_=>d.persistence.referenceDelegate.removeReference(p,m.targetId,_)))))}catch(p){if(!os(p))throw p;$("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const m=p.targetId;if(!p.fromCache){const _=d.os.get(m),E=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(E);d.os=d.os.insert(m,C)}}}(r.localStore,s))}async function AG(t,e){const n=j(t);if(!n.currentUser.isEqual(e)){$("SyncEngine","User change. New user:",e.toKey());const r=await vN(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new G(B.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await oi(n,r.hs)}}function CG(t,e){const n=j(t),r=n.Na.get(e);if(r&&r.va)return ce().add(r.key);{let i=ce();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}async function RG(t,e){const n=j(t),r=await Nh(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&Wg(n,e.targetId,i.wa),i}async function xG(t,e){const n=j(t);return IN(n.localStore,e).then(r=>oi(n,r))}async function PG(t,e,n,r){const i=j(t),s=await function(a,l){const u=j(a),d=j(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",p=>d.Mn(p,l).next(m=>m?u.localDocuments.getDocuments(p,m):F.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Ja(i.remoteStore):n==="acknowledged"||n==="rejected"?(Tv(i,e,r||null),Ev(i,e),function(a,l){j(j(a).mutationQueue).On(l)}(i.localStore,e)):X(),await oi(i,s)):$("SyncEngine","Cannot apply mutation batch with id: "+e)}async function NG(t,e){const n=j(t);if(Nf(n),Iv(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await nI(n,r.toArray());n.Qa=!0,await Hg(n.remoteStore,!0);for(const s of i)Pf(n.remoteStore,s)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ba(n,o),xa(n.localStore,o,!0))),Pa(n.remoteStore,o)}),await i,await nI(n,r),function(o){const a=j(o);a.Na.forEach((l,u)=>{Pa(a.remoteStore,u)}),a.La.pr(),a.Na=new Map,a.Oa=new be(J.comparator)}(n),n.Qa=!1,await Hg(n.remoteStore,!1)}}async function nI(t,e,n){const r=j(t),i=[],s=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await Ra(r.localStore,sn(l[0]));for(const u of l){const d=r.Fa.get(u),p=await RG(r,d);p.snapshot&&s.push(p.snapshot)}}else{const u=await wN(r.localStore,o);a=await Ra(r.localStore,u),await vv(r,BN(u),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i}function BN(t){return xP(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function bG(t){return function(n){return j(j(n).persistence).Qi()}(j(t).localStore)}async function kG(t,e,n,r){const i=j(t);if(i.Qa)return void $("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await IN(i.localStore,NP(s[0])),a=gc.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Ze.EMPTY_BYTE_STRING);await oi(i,o,a);break}case"rejected":await xa(i.localStore,e,!0),ba(i,e,r);break;default:X()}}async function DG(t,e,n){const r=Nf(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){$("SyncEngine","Adding an already active target "+i);continue}const s=await wN(r.localStore,i),o=await Ra(r.localStore,s);await vv(r,BN(s),o.targetId,!1,o.resumeToken),Pf(r.remoteStore,o)}for(const i of n)r.Ma.has(i)&&await xa(r.localStore,i,!1).then(()=>{Pa(r.remoteStore,i),ba(r,i)}).catch(ss)}}function Nf(t){const e=j(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=FN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EG.bind(null,e),e.Ca.d_=lG.bind(null,e.eventManager),e.Ca.$a=uG.bind(null,e.eventManager),e}function Iv(t){const e=j(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=TG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wG.bind(null,e),e}function MG(t,e,n){const r=j(t);(async function(s,o,a){try{const l=await o.getMetadata();if(await function(_,E){const C=j(_),A=st(E.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",w=>C.Gr.getBundleMetadata(w,E.id)).then(w=>!!w&&w.createTime.compareTo(A)>=0)}(s.localStore,l))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(DN(l));const u=new dG(l,s.localStore,o.serializer);let d=await o.Ua();for(;d;){const m=await u.la(d);m&&a._updateProgress(m),d=await o.Ua()}const p=await u.complete();return await oi(s,p.Ia,void 0),await function(_,E){const C=j(_);return C.persistence.runTransaction("Save bundle","readwrite",A=>C.Gr.saveBundleMetadata(A,E))}(s.localStore,l),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(l){return Cr("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Ju{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return yN(this.persistence,new _N,e.initialUser,this.serializer)}Ga(e){return new gN(xf.Zr,this.serializer)}Wa(e){return new AN}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ju.provider={build:()=>new Ju};class qN extends Ju{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Iv(this.Ja.syncEngine),await Ja(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return yN(this.persistence,new _N,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new yq(r,e.asyncQueue,n)}Ha(e,n){const r=new ZB(n,this.persistence);return new XB(e.asyncQueue,r)}Ga(e){const n=av(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new ov(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,CN(),qd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new AN}}class VG extends qN{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof cm&&(this.sharedClientState.syncEngine={no:PG.bind(null,n),ro:kG.bind(null,n),io:DG.bind(null,n),Qi:bG.bind(null,n),eo:xG.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await NG(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=CN();if(!cm.D(n))throw new G(B.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=av(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new cm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class ju{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>tI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=AG.bind(null,this.syncEngine),await Hg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new aG}()}createDatastore(e){const n=yc(e.databaseInfo.databaseId),r=function(s){return new Hq(s)}(e.databaseInfo);return function(s,o,a,l){return new Kq(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new jq(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>tI(this.syncEngine,n,0),function(){return j0.D()?new j0:new qq}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,d){const p=new pG(i,s,o,a,l,u);return d&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=j(i);$("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ka(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}ju.provider={build:()=>new ju};function rI(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):rt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LG{constructor(e,n){this.Xa=e,this.serializer=n,this.metadata=new bt,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const n=this.eu.decode(e),r=Number(n);isNaN(r)&&this.ru(`length string (${n}) is not valid number`);const i=await this.iu(r);return new cG(JSON.parse(i),e.length+r)}su(){return this.buffer.findIndex(e=>e===123)}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const n=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UG{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new G(B.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const o=j(i),a={documents:s.map(p=>Wu(o.serializer,p))},l=await o.Lo("BatchGetDocuments",o.serializer.databaseId,fe.emptyPath(),a,s.length),u=new Map;l.forEach(p=>{const m=X4(o.serializer,p);u.set(m.key.toString(),m)});const d=[];return s.forEach(p=>{const m=u.get(p.toString());te(!!m),d.push(m)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Wa(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=J.fromPath(r);this.mutations.push(new Qy(i,this.precondition(i)))}),await async function(r,i){const s=j(r),o={writes:i.map(a=>Ku(s.serializer,a))};await s.Mo("Commit",s.serializer.databaseId,fe.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw X();n=re.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new G(B.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(re.min())?qe.exists(!1):qe.updateTime(n):qe.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(re.min()))throw new G(B.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qe.updateTime(n)}return qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FG{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new cv(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new UG(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!dc(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!$P(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OG{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Et.UNAUTHENTICATED,this.clientId=iP.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{$("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>($("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Qa(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function hm(t,e){t.asyncQueue.verifyOperationInProgress(),$("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await vN(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function iI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Sv(t);$("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Q0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Q0(e.remoteStore,i)),t._onlineComponents=e}async function Sv(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){$("FirestoreClient","Using user provided OfflineComponentProvider");try{await hm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Cr("Error using user provided cache. Falling back to memory cache: "+n),await hm(t,new Ju)}}else $("FirestoreClient","Using default OfflineComponentProvider"),await hm(t,new Ju);return t._offlineComponents}async function kf(t){return t._onlineComponents||(t._uninitializedComponentsProvider?($("FirestoreClient","Using user provided OnlineComponentProvider"),await iI(t,t._uninitializedComponentsProvider._online)):($("FirestoreClient","Using default OnlineComponentProvider"),await iI(t,new ju))),t._onlineComponents}function GN(t){return Sv(t).then(e=>e.persistence)}function Av(t){return Sv(t).then(e=>e.localStore)}function $N(t){return kf(t).then(e=>e.remoteStore)}function Cv(t){return kf(t).then(e=>e.syncEngine)}function BG(t){return kf(t).then(e=>e.datastore)}async function ka(t){const e=await kf(t),n=e.eventManager;return n.onListen=mG.bind(null,e.syncEngine),n.onUnlisten=_G.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=gG.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=yG.bind(null,e.syncEngine),n}function qG(t){return t.asyncQueue.enqueue(async()=>{const e=await GN(t),n=await $N(t);return e.setNetworkEnabled(!0),function(i){const s=j(i);return s.L_.delete(0),vc(s)}(n)})}function GG(t){return t.asyncQueue.enqueue(async()=>{const e=await GN(t),n=await $N(t);return e.setNetworkEnabled(!1),async function(i){const s=j(i);s.L_.add(0),await Ka(s),s.q_.set("Offline")}(n)})}function $G(t,e){const n=new bt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(u,d){const p=j(u);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new G(B.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=Qa(a,`Failed to get document '${s} from cache`);o.reject(l)}}(await Av(t),e,n)),n.promise}function HN(t,e,n={}){const r=new bt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new bf({next:m=>{d.Za(),o.enqueueAndForget(()=>gv(s,p));const _=m.docs.has(a);!_&&m.fromCache?u.reject(new G(B.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&l&&l.source==="server"?u.reject(new G(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new yv(Ha(a.path),d,{includeMetadataChanges:!0,_a:!0});return mv(s,p)}(await ka(t),t.asyncQueue,e,n,r)),r.promise}function HG(t,e){const n=new bt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await Nh(i,s,!0),l=new LN(s,a.Ts),u=l.ma(a.documents),d=l.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){const l=Qa(a,`Failed to execute query '${s} against cache`);o.reject(l)}}(await Av(t),e,n)),n.promise}function zN(t,e,n={}){const r=new bt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new bf({next:m=>{d.Za(),o.enqueueAndForget(()=>gv(s,p)),m.fromCache&&l.source==="server"?u.reject(new G(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new yv(a,d,{includeMetadataChanges:!0,_a:!0});return mv(s,p)}(await ka(t),t.asyncQueue,e,n,r)),r.promise}function zG(t,e){const n=new bf(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){j(i).Y_.add(s),s.next()}(await ka(t),n)),()=>{n.Za(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){j(i).Y_.delete(s)}(await ka(t),n))}}function WG(t,e,n,r){const i=function(o,a){let l;return l=typeof o=="string"?zP().encode(o):o,function(d,p){return new LG(d,p)}(function(d,p){if(d instanceof Uint8Array)return rI(d,p);if(d instanceof ArrayBuffer)return rI(new Uint8Array(d),p);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,yc(e));t.asyncQueue.enqueueAndForget(async()=>{MG(await Cv(t),i,r)})}function KG(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=j(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(await Av(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(t,e,n){if(!n)throw new G(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function KN(t,e,n,r){if(e===!0&&r===!0)throw new G(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function oI(t){if(!J.isDocumentKey(t))throw new G(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function aI(t){if(J.isDocumentKey(t))throw new G(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Df(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":X()}function ye(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Df(t);throw new G(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function JN(t,e){if(e<=0)throw new G(B.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WN((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new G(B.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ec{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lI({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new qB;switch(r.type){case"firstParty":return new zB(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=sI.get(n);r&&($("ComponentProvider","Removing Datastore"),sI.delete(n),r.terminate())}(this),Promise.resolve()}}function JG(t,e,n,r={}){var i;const s=(t=ye(t,Ec))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Cr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Et.MOCK_USER;else{a=VR(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new G(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Et(u)}t._authCredentials=new GB(new rP(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let on=class jN{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new jN(this.firestore,e,this._query)}},ze=class QN{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new QN(this.firestore,e,this._key)}},Bi=class YN extends on{constructor(e,n,r){super(e,n,Ha(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ze(this.firestore,null,new J(e))}withConverter(e){return new YN(this.firestore,e,this._path)}};function XN(t,e,...n){if(t=ne(t),Rv("collection","path",e),t instanceof Ec){const r=fe.fromString(e,...n);return aI(r),new Bi(t,null,r)}{if(!(t instanceof ze||t instanceof Bi))throw new G(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(fe.fromString(e,...n));return aI(r),new Bi(t.firestore,null,r)}}function jG(t,e){if(t=ye(t,Ec),Rv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new G(B.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new on(t,null,function(r){return new ii(fe.emptyPath(),r)}(e))}function Mh(t,e,...n){if(t=ne(t),arguments.length===1&&(e=iP.newId()),Rv("doc","path",e),t instanceof Ec){const r=fe.fromString(e,...n);return oI(r),new ze(t,null,new J(r))}{if(!(t instanceof ze||t instanceof Bi))throw new G(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(fe.fromString(e,...n));return oI(r),new ze(t.firestore,t instanceof Bi?t.converter:null,new J(r))}}function ZN(t,e){return t=ne(t),e=ne(e),(t instanceof ze||t instanceof Bi)&&(e instanceof ze||e instanceof Bi)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function eb(t,e){return t=ne(t),e=ne(e),t instanceof on&&e instanceof on&&t.firestore===e.firestore&&fc(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new cv(this,"async_queue_retry"),this.Vu=()=>{const r=qd();r&&$("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=qd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=qd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new bt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!os(e))throw e;$("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw rt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=pv.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&X()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Kg(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class QG{constructor(){this._progressObserver={},this._taskCompletionResolver=new bt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YG=-1;let ot=class extends Ec{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new uI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uI(e),this._firestoreClient=void 0,await e}}};function Wt(t){if(t._terminated)throw new G(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||tb(t),t._firestoreClient}function tb(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,u,d){return new T4(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,WN(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new OG(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function XG(t,e){Cr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return nb(t,ju.provider,{build:r=>new qN(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function ZG(t){Cr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();nb(t,ju.provider,{build:n=>new VG(n,e.cacheSizeBytes)})}function nb(t,e,n){if((t=ye(t,ot))._firestoreClient||t._terminated)throw new G(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new G(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},tb(t)}function e$(t){if(t._initialized&&!t._terminated)throw new G(B.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new bt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!wr.D())return Promise.resolve();const i=r+"main";await wr.delete(i)}(av(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function t$(t){return function(n){const r=new bt;return n.asyncQueue.enqueueAndForget(async()=>IG(await Cv(n),r)),r.promise}(Wt(t=ye(t,ot)))}function n$(t){return qG(Wt(t=ye(t,ot)))}function r$(t){return GG(Wt(t=ye(t,ot)))}function i$(t,e){const n=Wt(t=ye(t,ot)),r=new QG;return WG(n,t._databaseId,e,r),r}function s$(t,e){return KG(Wt(t=ye(t,ot)),e).then(n=>n?new on(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xr(Ze.fromBase64String(e))}catch(n){throw new G(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new xr(Ze.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yi=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let co=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o$=/^__.*__$/;class a${constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new si(e,this.data,this.fieldMask,n,this.fieldTransforms):new za(e,this.data,n,this.fieldTransforms)}}class rb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new si(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ib(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}class Vf{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Vf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Vh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ib(this.Cu)&&o$.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class l${constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yc(e)}Qu(e,n,r,i=!1){return new Vf({Cu:e,methodName:n,qu:r,path:Be.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ho(t){const e=t._freezeSettings(),n=yc(t._databaseId);return new l$(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Lf(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);Vv("Data must be an object, but it was:",o,r);const a=ab(r,o);let l,u;if(s.merge)l=new gn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const m=Jg(e,p,n);if(!o.contains(m))throw new G(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);ub(d,m)||d.push(m)}l=new gn(d),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new a$(new Pt(a),l,u)}class Tc extends co{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tc}}function sb(t,e,n){return new Vf({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Pv extends co{_toFieldTransform(e){return new mc(e.path,new Sa)}isEqual(e){return e instanceof Pv}}class Nv extends co{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=sb(this,e,!0),r=this.Ku.map(s=>fo(s,n)),i=new Qs(r);return new mc(e.path,i)}isEqual(e){return e instanceof Nv&&bu(this.Ku,e.Ku)}}class bv extends co{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=sb(this,e,!0),r=this.Ku.map(s=>fo(s,n)),i=new Ys(r);return new mc(e.path,i)}isEqual(e){return e instanceof bv&&bu(this.Ku,e.Ku)}}class kv extends co{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new Aa(e.serializer,LP(e.serializer,this.$u));return new mc(e.path,n)}isEqual(e){return e instanceof kv&&this.$u===e.$u}}function Dv(t,e,n,r){const i=t.Qu(1,e,n);Vv("Data must be an object, but it was:",i,r);const s=[],o=Pt.empty();uo(r,(l,u)=>{const d=Lv(e,l,n);u=ne(u);const p=i.Nu(d);if(u instanceof Tc)s.push(d);else{const m=fo(u,p);m!=null&&(s.push(d),o.set(d,m))}});const a=new gn(s);return new rb(o,a,i.fieldTransforms)}function Mv(t,e,n,r,i,s){const o=t.Qu(1,e,n),a=[Jg(e,r,n)],l=[i];if(s.length%2!=0)throw new G(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(Jg(e,s[m])),l.push(s[m+1]);const u=[],d=Pt.empty();for(let m=a.length-1;m>=0;--m)if(!ub(u,a[m])){const _=a[m];let E=l[m];E=ne(E);const C=o.Nu(_);if(E instanceof Tc)u.push(_);else{const A=fo(E,C);A!=null&&(u.push(_),d.set(_,A))}}const p=new gn(u);return new rb(d,p,o.fieldTransforms)}function ob(t,e,n,r=!1){return fo(n,t.Qu(r?4:3,e))}function fo(t,e){if(lb(t=ne(t)))return Vv("Unsupported field value:",e,t),ab(t,e);if(t instanceof co)return function(r,i){if(!ib(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=fo(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ne(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return LP(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ge.fromDate(r);return{timestampValue:Ca(i.serializer,s)}}if(r instanceof Ge){const s=new Ge(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ca(i.serializer,s)}}if(r instanceof Mf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof xr)return{bytesValue:JP(i.serializer,r._byteString)};if(r instanceof ze){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:tv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof xv)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return jy(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Df(r)}`)}(t,e)}function ab(t,e){const n={};return gP(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):uo(t,(r,i)=>{const s=fo(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function lb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ge||t instanceof Mf||t instanceof xr||t instanceof ze||t instanceof co||t instanceof xv)}function Vv(t,e,n){if(!lb(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Df(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Jg(t,e,n){if((e=ne(e))instanceof Yi)return e._internalPath;if(typeof e=="string")return Lv(t,e);throw Vh("Field path arguments must be of type string or ",t,!1,void 0,n)}const u$=new RegExp("[~\\*/\\[\\]]");function Lv(t,e,n){if(e.search(u$)>=0)throw Vh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Yi(...e.split("."))._internalPath}catch{throw Vh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Vh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new G(B.INVALID_ARGUMENT,a+t+l)}function ub(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new c$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Uf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class c$ extends Qu{data(){return super.data()}}function Uf(t,e){return typeof e=="string"?Lv(t,e):e instanceof Yi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Uv{}class wc extends Uv{}function _i(t,e,...n){let r=[];e instanceof Uv&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Fv).length,a=s.filter(l=>l instanceof Ff).length;if(o>1||o>0&&a>0)throw new G(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Ff extends wc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ff(e,n,r)}_apply(e){const n=this._parse(e);return hb(e._query,n),new on(e.firestore,e.converter,Vg(e._query,n))}_parse(e){const n=ho(e.firestore);return function(s,o,a,l,u,d,p){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new G(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){dI(p,d);const _=[];for(const E of p)_.push(cI(l,s,E));m={arrayValue:{values:_}}}else m=cI(l,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||dI(p,d),m=ob(a,o,p,d==="in"||d==="not-in");return pe.create(u,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function d$(t,e,n){const r=e,i=Uf("where",t);return Ff._create(i,r,n)}class Fv extends Uv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Fv(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ie.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)hb(o,l),o=Vg(o,l)}(e._query,n),new on(e.firestore,e.converter,Vg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ov extends wc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ov(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new G(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new G(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zu(s,o)}(e._query,this._field,this._direction);return new on(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ii(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function h$(t,e="asc"){const n=e,r=Uf("orderBy",t);return Ov._create(r,n)}class Of extends wc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Of(e,n,r)}_apply(e){return new on(e.firestore,e.converter,Ch(e._query,this._limit,this._limitType))}}function f$(t){return JN("limit",t),Of._create("limit",t,"F")}function p$(t){return JN("limitToLast",t),Of._create("limitToLast",t,"L")}class Bf extends wc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Bf(e,n,r)}_apply(e){const n=db(e,this.type,this._docOrFields,this._inclusive);return new on(e.firestore,e.converter,function(i,s){return new ii(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function m$(...t){return Bf._create("startAt",t,!0)}function g$(...t){return Bf._create("startAfter",t,!1)}class qf extends wc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new qf(e,n,r)}_apply(e){const n=db(e,this.type,this._docOrFields,this._inclusive);return new on(e.firestore,e.converter,function(i,s){return new ii(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function _$(...t){return qf._create("endBefore",t,!1)}function y$(...t){return qf._create("endAt",t,!0)}function db(t,e,n,r){if(n[0]=ne(n[0]),n[0]instanceof Qu)return function(s,o,a,l,u){if(!l)throw new G(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const p of sa(s))if(p.field.isKeyField())d.push(Js(o,l.key));else{const m=l.data.field(p.field);if(wf(m))throw new G(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const _=p.field.canonicalString();throw new G(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(m)}return new ji(d,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=ho(t.firestore);return function(o,a,l,u,d,p){const m=o.explicitOrderBy;if(d.length>m.length)throw new G(B.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let E=0;E<d.length;E++){const C=d[E];if(m[E].field.isKeyField()){if(typeof C!="string")throw new G(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof C}`);if(!Ky(o)&&C.indexOf("/")!==-1)throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${C}' contains a slash.`);const A=o.path.child(fe.fromString(C));if(!J.isDocumentKey(A))throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);const w=new J(A);_.push(Js(a,w))}else{const A=ob(l,u,C);_.push(A)}}return new ji(_,p)}(t._query,t.firestore._databaseId,i,e,n,r)}}function cI(t,e,n){if(typeof(n=ne(n))=="string"){if(n==="")throw new G(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ky(e)&&n.indexOf("/")!==-1)throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(fe.fromString(n));if(!J.isDocumentKey(r))throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Js(t,new J(r))}if(n instanceof ze)return Js(t,n._key);throw new G(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Df(n)}.`)}function dI(t,e){if(!Array.isArray(t)||t.length===0)throw new G(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hb(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Bv{convertValue(e,n="none"){switch(Ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Wi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw X()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return uo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Fe(o.doubleValue));return new xv(s)}convertGeoPoint(e){return new Mf(Fe(e.latitude),Fe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zy(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Gu(e));default:return null}}convertTimestamp(e){const n=Qr(e);return new Ge(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=fe.fromString(e);te(sN(r));const i=new Ki(r.get(1),r.get(3)),s=new J(r.popFirst(5));return i.isEqual(n)||rt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class v$ extends Bv{constructor(e){super(),this.firestore=e}convertBytes(e){return new xr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Yr=class extends Qu{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new uu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Uf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},uu=class extends Yr{data(e={}){return super.data(e)}},Xi=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new bs(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new uu(this._firestore,this._userDataWriter,r.key,r,new bs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new uu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new bs(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new uu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new bs(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:E$(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function E$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}function fb(t,e){return t instanceof Yr&&e instanceof Yr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Xi&&e instanceof Xi&&t._firestore===e._firestore&&eb(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T$(t){t=ye(t,ze);const e=ye(t.firestore,ot);return HN(Wt(e),t._key).then(n=>qv(e,t,n))}class po extends Bv{constructor(e){super(),this.firestore=e}convertBytes(e){return new xr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,n)}}function w$(t){t=ye(t,ze);const e=ye(t.firestore,ot),n=Wt(e),r=new po(e);return $G(n,t._key).then(i=>new Yr(e,r,t._key,i,new bs(i!==null&&i.hasLocalMutations,!0),t.converter))}function I$(t){t=ye(t,ze);const e=ye(t.firestore,ot);return HN(Wt(e),t._key,{source:"server"}).then(n=>qv(e,t,n))}function S$(t){t=ye(t,on);const e=ye(t.firestore,ot),n=Wt(e),r=new po(e);return cb(t._query),zN(n,t._query).then(i=>new Xi(e,r,t,i))}function A$(t){t=ye(t,on);const e=ye(t.firestore,ot),n=Wt(e),r=new po(e);return HG(n,t._query).then(i=>new Xi(e,r,t,i))}function C$(t){t=ye(t,on);const e=ye(t.firestore,ot),n=Wt(e),r=new po(e);return zN(n,t._query,{source:"server"}).then(i=>new Xi(e,r,t,i))}function hI(t,e,n){t=ye(t,ze);const r=ye(t.firestore,ot),i=Gf(t.converter,e,n);return Ic(r,[Lf(ho(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,qe.none())])}function fI(t,e,n,...r){t=ye(t,ze);const i=ye(t.firestore,ot),s=ho(i);let o;return o=typeof(e=ne(e))=="string"||e instanceof Yi?Mv(s,"updateDoc",t._key,e,n,r):Dv(s,"updateDoc",t._key,e),Ic(i,[o.toMutation(t._key,qe.exists(!0))])}function R$(t){return Ic(ye(t.firestore,ot),[new Wa(t._key,qe.none())])}function x$(t,e){const n=ye(t.firestore,ot),r=Mh(t),i=Gf(t.converter,e);return Ic(n,[Lf(ho(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,qe.exists(!1))]).then(()=>r)}function pb(t,...e){var n,r,i;t=ne(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Kg(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Kg(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,d;if(t instanceof ze)u=ye(t.firestore,ot),d=Ha(t._key.path),l={next:p=>{e[o]&&e[o](qv(u,t,p))},error:e[o+1],complete:e[o+2]};else{const p=ye(t,on);u=ye(p.firestore,ot),d=p._query;const m=new po(u);l={next:_=>{e[o]&&e[o](new Xi(u,m,p,_))},error:e[o+1],complete:e[o+2]},cb(t._query)}return function(m,_,E,C){const A=new bf(C),w=new yv(_,A,E);return m.asyncQueue.enqueueAndForget(async()=>mv(await ka(m),w)),()=>{A.Za(),m.asyncQueue.enqueueAndForget(async()=>gv(await ka(m),w))}}(Wt(u),d,a,l)}function P$(t,e){return zG(Wt(t=ye(t,ot)),Kg(e)?e:{next:e})}function Ic(t,e){return function(r,i){const s=new bt;return r.asyncQueue.enqueueAndForget(async()=>vG(await Cv(r),i,s)),s.promise}(Wt(t),e)}function qv(t,e,n){const r=n.docs.get(e._key),i=new po(t);return new Yr(t,i,e._key,r,new bs(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N$={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b$=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ho(e)}set(e,n,r){this._verifyNotCommitted();const i=Si(e,this._firestore),s=Gf(i.converter,n,r),o=Lf(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,qe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=Si(e,this._firestore);let o;return o=typeof(n=ne(n))=="string"||n instanceof Yi?Mv(this._dataReader,"WriteBatch.update",s._key,n,r,i):Dv(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,qe.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Si(e,this._firestore);return this._mutations=this._mutations.concat(new Wa(n._key,qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new G(B.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Si(t,e){if((t=ne(t)).firestore!==e)throw new G(B.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k$=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=ho(n)}get(n){const r=Si(n,this._firestore),i=new v$(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return X();const o=s[0];if(o.isFoundDocument())return new Qu(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Qu(this._firestore,i,r._key,null,r.converter);throw X()})}set(n,r,i){const s=Si(n,this._firestore),o=Gf(s.converter,r,i),a=Lf(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=Si(n,this._firestore);let a;return a=typeof(r=ne(r))=="string"||r instanceof Yi?Mv(this._dataReader,"Transaction.update",o._key,r,i,s):Dv(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=Si(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Si(e,this._firestore),r=new po(this._firestore);return super.get(e).then(i=>new Yr(this._firestore,r,n._key,i._document,new bs(!1,!1),n.converter))}};function D$(t,e,n){t=ye(t,ot);const r=Object.assign(Object.assign({},N$),n);return function(s){if(s.maxAttempts<1)throw new G(B.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new bt;return s.asyncQueue.enqueueAndForget(async()=>{const u=await BG(s);new FG(s.asyncQueue,u,a,o,l).au()}),l.promise}(Wt(t),i=>e(new k$(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M$(){return new Tc("deleteField")}function V$(){return new Pv("serverTimestamp")}function L$(...t){return new Nv("arrayUnion",t)}function U$(...t){return new bv("arrayRemove",t)}function F$(t){return new kv("increment",t)}(function(e,n=!0){(function(i){$a=i})(ti),Jr(new Hn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new ot(new $B(r.getProvider("auth-internal")),new KB(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new G(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ki(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),xn(n0,"4.7.3",e),xn(n0,"4.7.3","esm2017")})();const O$="@firebase/firestore-compat",B$="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new G("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(){if(typeof Uint8Array>"u")throw new G("unimplemented","Uint8Arrays are not available in this environment.")}function mI(){if(!v4())throw new G("unimplemented","Blobs are unavailable in Firestore in this environment.")}let mb=class jg{constructor(e){this._delegate=e}static fromBase64String(e){return mI(),new jg(xr.fromBase64String(e))}static fromUint8Array(e){return pI(),new jg(xr.fromUint8Array(e))}toBase64(){return mI(),this._delegate.toBase64()}toUint8Array(){return pI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(t){return q$(t,["next","error","complete"])}function q$(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G${enableIndexedDbPersistence(e,n){return XG(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return ZG(e._delegate)}clearIndexedDbPersistence(e){return e$(e._delegate)}}class gb{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ki||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Cr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){JG(this._delegate,e,n,r)}enableNetwork(){return n$(this._delegate)}disableNetwork(){return r$(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,KN("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return t$(this._delegate)}onSnapshotsInSync(e){return P$(this._delegate,e)}get app(){if(!this._appCompat)throw new G("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Da(this,XN(this._delegate,e))}catch(n){throw en(n,"collection()","Firestore.collection()")}}doc(e){try{return new Un(this,Mh(this._delegate,e))}catch(n){throw en(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Zt(this,jG(this._delegate,e))}catch(n){throw en(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return D$(this._delegate,n=>e(new _b(this,n)))}batch(){return Wt(this._delegate),new yb(new b$(this._delegate,e=>Ic(this._delegate,e)))}loadBundle(e){return i$(this._delegate,e)}namedQuery(e){return s$(this._delegate,e).then(n=>n?new Zt(this,n):null)}}class $f extends Bv{constructor(e){super(),this.firestore=e}convertBytes(e){return new mb(new xr(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Un.forKey(n,this.firestore,null)}}function $$(t){OB(t)}class _b{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new $f(e)}get(e){const n=ks(e);return this._delegate.get(n).then(r=>new Yu(this._firestore,new Yr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=ks(e);return r?(Gv("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=ks(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=ks(e);return this._delegate.delete(n),this}}class yb{constructor(e){this._delegate=e}set(e,n,r){const i=ks(e);return r?(Gv("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=ks(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=ks(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class to{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new uu(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Xu(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=to.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new to(e,new $f(e),n),i.set(n,s)),s}}to.INSTANCES=new WeakMap;class Un{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new $f(e)}static forPath(e,n,r){if(e.length%2!==0)throw new G("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Un(n,new ze(n._delegate,r,new J(e)))}static forKey(e,n,r){return new Un(n,new ze(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Da(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Da(this.firestore,XN(this._delegate,e))}catch(n){throw en(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ne(e),e instanceof ze?ZN(this._delegate,e):!1}set(e,n){n=Gv("DocumentReference.set",n);try{return n?hI(this._delegate,e,n):hI(this._delegate,e)}catch(r){throw en(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?fI(this._delegate,e):fI(this._delegate,e,n,...r)}catch(i){throw en(i,"updateDoc()","DocumentReference.update()")}}delete(){return R$(this._delegate)}onSnapshot(...e){const n=vb(e),r=Eb(e,i=>new Yu(this.firestore,new Yr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return pb(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=w$(this._delegate):(e==null?void 0:e.source)==="server"?n=I$(this._delegate):n=T$(this._delegate),n.then(r=>new Yu(this.firestore,new Yr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Un(this.firestore,e?this._delegate.withConverter(to.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function en(t,e,n){return t.message=t.message.replace(e,n),t}function vb(t){for(const e of t)if(typeof e=="object"&&!Qg(e))return e;return{}}function Eb(t,e){var n,r;let i;return Qg(t[0])?i=t[0]:Qg(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Yu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Un(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return fb(this._delegate,e._delegate)}}class Xu extends Yu{data(e){const n=this._delegate.data(e);return this._delegate._converter||BB(n!==void 0),n}}class Zt{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new $f(e)}where(e,n,r){try{return new Zt(this.firestore,_i(this._delegate,d$(e,n,r)))}catch(i){throw en(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Zt(this.firestore,_i(this._delegate,h$(e,n)))}catch(r){throw en(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Zt(this.firestore,_i(this._delegate,f$(e)))}catch(n){throw en(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Zt(this.firestore,_i(this._delegate,p$(e)))}catch(n){throw en(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Zt(this.firestore,_i(this._delegate,m$(...e)))}catch(n){throw en(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Zt(this.firestore,_i(this._delegate,g$(...e)))}catch(n){throw en(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Zt(this.firestore,_i(this._delegate,_$(...e)))}catch(n){throw en(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Zt(this.firestore,_i(this._delegate,y$(...e)))}catch(n){throw en(n,"endAt()","Query.endAt()")}}isEqual(e){return eb(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=A$(this._delegate):(e==null?void 0:e.source)==="server"?n=C$(this._delegate):n=S$(this._delegate),n.then(r=>new Yg(this.firestore,new Xi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=vb(e),r=Eb(e,i=>new Yg(this.firestore,new Xi(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return pb(this._delegate,n,r)}withConverter(e){return new Zt(this.firestore,e?this._delegate.withConverter(to.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class H${constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Xu(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Yg{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Zt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Xu(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new H$(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Xu(this._firestore,r))})}isEqual(e){return fb(this._delegate,e._delegate)}}class Da extends Zt{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Un(this.firestore,e):null}doc(e){try{return e===void 0?new Un(this.firestore,Mh(this._delegate)):new Un(this.firestore,Mh(this._delegate,e))}catch(n){throw en(n,"doc()","CollectionReference.doc()")}}add(e){return x$(this._delegate,e).then(n=>new Un(this.firestore,n))}isEqual(e){return ZN(this._delegate,e._delegate)}withConverter(e){return new Da(this.firestore,e?this._delegate.withConverter(to.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ks(t){return ye(t,ze)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(...e){this._delegate=new Yi(...e)}static documentId(){return new $v(Be.keyField().canonicalString())}isEqual(e){return e=ne(e),e instanceof Yi?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this._delegate=e}static serverTimestamp(){const e=V$();return e._methodName="FieldValue.serverTimestamp",new Cs(e)}static delete(){const e=M$();return e._methodName="FieldValue.delete",new Cs(e)}static arrayUnion(...e){const n=L$(...e);return n._methodName="FieldValue.arrayUnion",new Cs(n)}static arrayRemove(...e){const n=U$(...e);return n._methodName="FieldValue.arrayRemove",new Cs(n)}static increment(e){const n=F$(e);return n._methodName="FieldValue.increment",new Cs(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z$={Firestore:gb,GeoPoint:Mf,Timestamp:Ge,Blob:mb,Transaction:_b,WriteBatch:yb,DocumentReference:Un,DocumentSnapshot:Yu,Query:Zt,QueryDocumentSnapshot:Xu,QuerySnapshot:Yg,CollectionReference:Da,FieldPath:$v,FieldValue:Cs,setLogLevel:$$,CACHE_SIZE_UNLIMITED:YG};function W$(t,e){t.INTERNAL.registerComponent(new Hn("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},z$)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K$(t){W$(t,(e,n)=>new gb(e,n,new G$)),t.registerVersion(O$,B$)}K$(zn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tb="firebasestorage.googleapis.com",wb="storageBucket",J$=2*60*1e3,j$=10*60*1e3,Q$=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je extends Ht{constructor(e,n,r=0){super(fm(e),`Firebase Storage: ${n} (${fm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Je.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return fm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Le;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Le||(Le={}));function fm(t){return"storage/"+t}function Hv(){const t="An unknown error occurred, please check the error payload for server response.";return new Je(Le.UNKNOWN,t)}function Y$(t){return new Je(Le.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function X$(t){return new Je(Le.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Z$(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Je(Le.UNAUTHENTICATED,t)}function eH(){return new Je(Le.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function tH(t){return new Je(Le.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Ib(){return new Je(Le.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Sb(){return new Je(Le.CANCELED,"User canceled the upload/download.")}function nH(t){return new Je(Le.INVALID_URL,"Invalid URL '"+t+"'.")}function rH(t){return new Je(Le.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function iH(){return new Je(Le.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+wb+"' property when initializing the app?")}function Ab(){return new Je(Le.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function sH(){return new Je(Le.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function oH(){return new Je(Le.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function aH(t){return new Je(Le.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function aa(t){return new Je(Le.INVALID_ARGUMENT,t)}function Cb(){return new Je(Le.APP_DELETED,"The Firebase app was deleted.")}function Rb(t){return new Je(Le.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function cu(t,e){return new Je(Le.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function bl(t){throw new Je(Le.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Gt.makeFromUrl(e,n)}catch{return new Gt(e,"")}if(r.path==="")return r;throw rH(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function u(D){D.path_=decodeURIComponent(D.path)}const d="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${p}/${d}/b/${i}/o${m}`,"i"),E={bucket:1,path:3},C=n===Tb?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",w=new RegExp(`^https?://${C}/${i}/${A}`,"i"),S=[{regex:a,indices:l,postModify:s},{regex:_,indices:E,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let D=0;D<S.length;D++){const L=S[D],M=L.regex.exec(e);if(M){const R=M[L.indices.bucket];let I=M[L.indices.path];I||(I=""),r=new Gt(R,I),L.postModify(r);break}}if(r==null)throw nH(e);return r}}class lH{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uH(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let u=!1;function d(...A){u||(u=!0,e.apply(null,A))}function p(A){i=setTimeout(()=>{i=null,t(_,l())},A)}function m(){s&&clearTimeout(s)}function _(A,...w){if(u){m();return}if(A){m(),d.call(null,A,...w);return}if(l()||o){m(),d.call(null,A,...w);return}r<64&&(r*=2);let S;a===1?(a=2,S=0):S=(r+Math.random())*1e3,p(S)}let E=!1;function C(A){E||(E=!0,m(),!u&&(i!==null?(A||(a=2),clearTimeout(i),p(0)):A||(a=1)))}return p(0),s=setTimeout(()=>{o=!0,C(!0)},n),C}function cH(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dH(t){return t!==void 0}function hH(t){return typeof t=="function"}function fH(t){return typeof t=="object"&&!Array.isArray(t)}function Hf(t){return typeof t=="string"||t instanceof String}function gI(t){return zv()&&t instanceof Blob}function zv(){return typeof Blob<"u"}function Xg(t,e,n,r){if(r<e)throw aa(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw aa(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function xb(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Fs;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Fs||(Fs={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pH{constructor(e,n,r,i,s,o,a,l,u,d,p,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,E)=>{this.resolve_=_,this.reject_=E,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new cd(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Fs.NO_ERROR,l=s.getStatus();if(!a||Pb(l,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Fs.ABORT;r(!1,new cd(!1,null,d));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new cd(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());dH(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=Hv();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?Cb():Sb();o(l)}else{const l=Ib();o(l)}};this.canceled_?n(!1,new cd(!1,null,!0)):this.backoffId_=uH(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&cH(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class cd{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function mH(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function gH(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _H(t,e){e&&(t["X-Firebase-GMPID"]=e)}function yH(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function vH(t,e,n,r,i,s,o=!0){const a=xb(t.urlParams),l=t.url+a,u=Object.assign({},t.headers);return _H(u,e),mH(u,n),gH(u,s),yH(u,r),new pH(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EH(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function TH(...t){const e=EH();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(zv())return new Blob(t);throw new Je(Le.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function wH(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IH(t){if(typeof atob>"u")throw aH("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class pm{constructor(e,n){this.data=e,this.contentType=n||null}}function Nb(t,e){switch(t){case Fn.RAW:return new pm(bb(e));case Fn.BASE64:case Fn.BASE64URL:return new pm(kb(t,e));case Fn.DATA_URL:return new pm(AH(e),CH(e))}throw Hv()}function bb(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function SH(t){let e;try{e=decodeURIComponent(t)}catch{throw cu(Fn.DATA_URL,"Malformed data URL.")}return bb(e)}function kb(t,e){switch(t){case Fn.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw cu(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Fn.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw cu(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=IH(e)}catch(i){throw i.message.includes("polyfill")?i:cu(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class Db{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw cu(Fn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=RH(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function AH(t){const e=new Db(t);return e.base64?kb(Fn.BASE64,e.rest):SH(e.rest)}function CH(t){return new Db(t).contentType}function RH(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,n){let r=0,i="";gI(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(gI(this.data_)){const r=this.data_,i=wH(r,e,n);return i===null?null:new Dr(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Dr(r,!0)}}static getBlob(...e){if(zv()){const n=e.map(r=>r instanceof Dr?r.data_:r);return new Dr(TH.apply(null,n))}else{const n=e.map(o=>Hf(o)?Nb(Fn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Dr(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wv(t){let e;try{e=JSON.parse(t)}catch{return null}return fH(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xH(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function PH(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function Mb(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NH(t,e){return e}class Qt{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||NH}}let dd=null;function bH(t){return!Hf(t)||t.length<2?t:Mb(t)}function zf(){if(dd)return dd;const t=[];t.push(new Qt("bucket")),t.push(new Qt("generation")),t.push(new Qt("metageneration")),t.push(new Qt("name","fullPath",!0));function e(s,o){return bH(o)}const n=new Qt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Qt("size");return i.xform=r,t.push(i),t.push(new Qt("timeCreated")),t.push(new Qt("updated")),t.push(new Qt("md5Hash",null,!0)),t.push(new Qt("cacheControl",null,!0)),t.push(new Qt("contentDisposition",null,!0)),t.push(new Qt("contentEncoding",null,!0)),t.push(new Qt("contentLanguage",null,!0)),t.push(new Qt("contentType",null,!0)),t.push(new Qt("metadata","customMetadata",!0)),dd=t,dd}function kH(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Gt(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function DH(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return kH(r,t),r}function Vb(t,e,n){const r=Wv(e);return r===null?null:DH(t,r,n)}function MH(t,e,n,r){const i=Wv(e);if(i===null||!Hf(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const d=t.bucket,p=t.fullPath,m="/b/"+o(d)+"/o/"+o(p),_=us(m,n,r),E=xb({alt:"media",token:u});return _+E})[0]}function Kv(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="prefixes",yI="items";function VH(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[_I])for(const i of n[_I]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new Gt(e,s));r.prefixes.push(o)}if(n[yI])for(const i of n[yI]){const s=t._makeStorageReference(new Gt(e,i.name));r.items.push(s)}return r}function LH(t,e,n){const r=Wv(n);return r===null?null:VH(t,e,r)}class ai{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t){if(!t)throw Hv()}function Wf(t,e){function n(r,i){const s=Vb(t,i,e);return Sr(s!==null),s}return n}function UH(t,e){function n(r,i){const s=LH(t,e,i);return Sr(s!==null),s}return n}function FH(t,e){function n(r,i){const s=Vb(t,i,e);return Sr(s!==null),MH(s,i,t.host,t._protocol)}return n}function Ya(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=eH():i=Z$():n.getStatus()===402?i=X$(t.bucket):n.getStatus()===403?i=tH(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Kf(t){const e=Ya(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=Y$(t.path)),s.serverResponse=i.serverResponse,s}return n}function Lb(t,e,n){const r=e.fullServerUrl(),i=us(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new ai(i,s,Wf(t,n),o);return a.errorHandler=Kf(e),a}function OH(t,e,n,r,i){const s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=e.bucketOnlyServerUrl(),a=us(o,t.host,t._protocol),l="GET",u=t.maxOperationRetryTime,d=new ai(a,l,UH(t,e.bucket),u);return d.urlParams=s,d.errorHandler=Ya(e),d}function BH(t,e,n){const r=e.fullServerUrl(),i=us(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new ai(i,s,FH(t,n),o);return a.errorHandler=Kf(e),a}function qH(t,e,n,r){const i=e.fullServerUrl(),s=us(i,t.host,t._protocol),o="PATCH",a=Kv(n,r),l={"Content-Type":"application/json; charset=utf-8"},u=t.maxOperationRetryTime,d=new ai(s,o,Wf(t,r),u);return d.headers=l,d.body=a,d.errorHandler=Kf(e),d}function GH(t,e){const n=e.fullServerUrl(),r=us(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,u){}const a=new ai(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Kf(e),a}function $H(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Ub(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=$H(null,e)),r}function HH(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let S="";for(let D=0;D<2;D++)S=S+Math.random().toString().slice(2);return S}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const u=Ub(e,r,i),d=Kv(u,n),p="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,m=`\r
--`+l+"--",_=Dr.getBlob(p,r,m);if(_===null)throw Ab();const E={name:u.fullPath},C=us(s,t.host,t._protocol),A="POST",w=t.maxUploadRetryTime,T=new ai(C,A,Wf(t,n),w);return T.urlParams=E,T.headers=o,T.body=_.uploadData(),T.errorHandler=Ya(e),T}class Lh{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function Jv(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Sr(!1)}return Sr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function zH(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=Ub(e,r,i),a={name:o.fullPath},l=us(s,t.host,t._protocol),u="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},p=Kv(o,n),m=t.maxUploadRetryTime;function _(C){Jv(C);let A;try{A=C.getResponseHeader("X-Goog-Upload-URL")}catch{Sr(!1)}return Sr(Hf(A)),A}const E=new ai(l,u,_,m);return E.urlParams=a,E.headers=d,E.body=p,E.errorHandler=Ya(e),E}function WH(t,e,n,r){const i={"X-Goog-Upload-Command":"query"};function s(u){const d=Jv(u,["active","final"]);let p=null;try{p=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Sr(!1)}p||Sr(!1);const m=Number(p);return Sr(!isNaN(m)),new Lh(m,r.size(),d==="final")}const o="POST",a=t.maxUploadRetryTime,l=new ai(n,o,s,a);return l.headers=i,l.errorHandler=Ya(e),l}const vI=256*1024;function KH(t,e,n,r,i,s,o,a){const l=new Lh(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw sH();const u=l.total-l.current;let d=u;i>0&&(d=Math.min(d,i));const p=l.current,m=p+d;let _="";d===0?_="finalize":u===d?_="upload, finalize":_="upload";const E={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${l.current}`},C=r.slice(p,m);if(C===null)throw Ab();function A(D,L){const M=Jv(D,["active","final"]),R=l.current+d,I=r.size();let P;return M==="final"?P=Wf(e,s)(D,L):P=null,new Lh(R,I,M==="final",P)}const w="POST",T=e.maxUploadRetryTime,S=new ai(n,w,A,T);return S.headers=E,S.body=C.uploadData(),S.progressCallback=a||null,S.errorHandler=Ya(t),S}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JH={STATE_CHANGED:"state_changed"},tn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function mm(t){switch(t){case"running":case"pausing":case"canceling":return tn.RUNNING;case"paused":return tn.PAUSED;case"success":return tn.SUCCESS;case"canceled":return tn.CANCELED;case"error":return tn.ERROR;default:return tn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jH{constructor(e,n,r){if(hH(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class QH{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Fs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Fs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Fs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw bl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw bl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw bl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw bl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw bl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class YH extends QH{initXhr(){this.xhr_.responseType="text"}}function gr(){return new YH}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=zf(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Le.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(Pb(i.status,[]))if(s)i=Ib();else{this.sleepTime=Math.max(this.sleepTime*2,Q$),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Le.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=zH(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,gr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=WH(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,gr,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=vI*this._chunkMultiplier,n=new Lh(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=KH(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,gr,i,s,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){vI*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=Lb(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,gr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=HH(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,gr,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=Sb(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=mm(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new jH(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(mm(this._state)){case tn.SUCCESS:Ro(this._resolve.bind(null,this.snapshot))();break;case tn.CANCELED:case tn.ERROR:const n=this._reject;Ro(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(mm(this._state)){case tn.RUNNING:case tn.PAUSED:e.next&&Ro(e.next.bind(e,this.snapshot))();break;case tn.SUCCESS:e.complete&&Ro(e.complete.bind(e))();break;case tn.CANCELED:case tn.ERROR:e.error&&Ro(e.error.bind(e,this._error))();break;default:e.error&&Ro(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n){this._service=e,n instanceof Gt?this._location=n:this._location=Gt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new no(e,n)}get root(){const e=new Gt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Mb(this._location.path)}get storage(){return this._service}get parent(){const e=xH(this._location.path);if(e===null)return null;const n=new Gt(this._location.bucket,e);return new no(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Rb(e)}}function XH(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Fb(t,new Dr(e),n)}function ZH(t){const e={prefixes:[],items:[]};return Ob(t,e).then(()=>e)}async function Ob(t,e,n){const i=await Bb(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await Ob(t,e,i.nextPageToken)}function Bb(t,e){e!=null&&typeof e.maxResults=="number"&&Xg("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=OH(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,gr)}function ez(t){t._throwIfRoot("getMetadata");const e=Lb(t.storage,t._location,zf());return t.storage.makeRequestWithTokens(e,gr)}function tz(t,e){t._throwIfRoot("updateMetadata");const n=qH(t.storage,t._location,e,zf());return t.storage.makeRequestWithTokens(n,gr)}function nz(t){t._throwIfRoot("getDownloadURL");const e=BH(t.storage,t._location,zf());return t.storage.makeRequestWithTokens(e,gr).then(n=>{if(n===null)throw oH();return n})}function rz(t){t._throwIfRoot("deleteObject");const e=GH(t.storage,t._location);return t.storage.makeRequestWithTokens(e,gr)}function qb(t,e){const n=PH(t._location.path,e),r=new Gt(t._location.bucket,n);return new no(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iz(t){return/^[A-Za-z]+:\/\//.test(t)}function sz(t,e){return new no(t,e)}function Gb(t,e){if(t instanceof jv){const n=t;if(n._bucket==null)throw iH();const r=new no(n,n._bucket);return e!=null?Gb(r,e):r}else return e!==void 0?qb(t,e):t}function oz(t,e){if(e&&iz(e)){if(t instanceof jv)return sz(t,e);throw aa("To use ref(service, url), the first argument must be a Storage instance.")}else return Gb(t,e)}function EI(t,e){const n=e==null?void 0:e[wb];return n==null?null:Gt.makeFromBucketSpec(n,t)}function az(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:VR(i,t.app.options.projectId))}class jv{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=Tb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=J$,this._maxUploadRetryTime=j$,this._requests=new Set,i!=null?this._bucket=Gt.makeFromBucketSpec(i,this._host):this._bucket=EI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Gt.makeFromBucketSpec(this._url,e):this._bucket=EI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Xg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Xg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new no(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new lH(Cb());{const o=vH(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const TI="@firebase/storage",wI="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz="storage";function uz(t,e,n){return t=ne(t),XH(t,e,n)}function cz(t){return t=ne(t),ez(t)}function dz(t,e){return t=ne(t),tz(t,e)}function hz(t,e){return t=ne(t),Bb(t,e)}function fz(t){return t=ne(t),ZH(t)}function pz(t){return t=ne(t),nz(t)}function mz(t){return t=ne(t),rz(t)}function II(t,e){return t=ne(t),oz(t,e)}function gz(t,e){return qb(t,e)}function _z(t,e,n,r={}){az(t,e,n,r)}function yz(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new jv(n,r,i,e,ti)}function vz(){Jr(new Hn(lz,yz,"PUBLIC").setMultipleInstances(!0)),xn(TI,wI,""),xn(TI,wI,"esm2017")}vz();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new hd(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new hd(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new hd(o,this,this._ref)):s={next:n.next?o=>n.next(new hd(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class AI{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new Gr(e,this._service))}get items(){return this._delegate.items.map(e=>new Gr(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=gz(this._delegate,e);return new Gr(n,this.storage)}get root(){return new Gr(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new Gr(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new SI(uz(this._delegate,e,n),this)}putString(e,n=Fn.RAW,r){this._throwIfRoot("putString");const i=Nb(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new SI(new Fb(this._delegate,new Dr(i.data,!0),s),this)}listAll(){return fz(this._delegate).then(e=>new AI(e,this.storage))}list(e){return hz(this._delegate,e||void 0).then(n=>new AI(n,this.storage))}getMetadata(){return cz(this._delegate)}updateMetadata(e){return dz(this._delegate,e)}getDownloadURL(){return pz(this._delegate)}delete(){return this._throwIfRoot("delete"),mz(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw Rb(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(CI(e))throw aa("ref() expected a child path but got a URL, use refFromURL instead.");return new Gr(II(this._delegate,e),this)}refFromURL(e){if(!CI(e))throw aa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Gt.makeFromUrl(e,this._delegate.host)}catch{throw aa("refFromUrl() expected a valid full URL but got an invalid one.")}return new Gr(II(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){_z(this._delegate,e,n,r)}}function CI(t){return/^[A-Za-z]+:\/\//.test(t)}const Ez="@firebase/storage-compat",Tz="0.3.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wz="storage-compat";function Iz(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new $b(n,r)}function Sz(t){const e={TaskState:tn,TaskEvent:JH,StringFormat:Fn,Storage:$b,Reference:Gr};t.INTERNAL.registerComponent(new Hn(wz,Iz,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(Ez,Tz)}Sz(zn);var we=(t=>(t.ADMIN="ADMIN",t.MANAGER="MANAGER",t.EMPLOYEE="EMPLOYEE",t.GUEST="GUEST",t))(we||{}),Or=(t=>(t.PENDING="PENDING",t.ACTIVE="ACTIVE",t.REJECTED="REJECTED",t))(Or||{}),oe=(t=>(t.DRAFT="DRAFT",t.SUBMITTED="SUBMITTED",t.NEEDS_REVISION="NEEDS_REVISION",t.APPROVED="APPROVED",t.REJECTED="REJECTED",t.PUBLISHED="PUBLISHED",t.ARCHIVED="ARCHIVED",t))(oe||{});const Az=typeof window<"u"&&window.__firebase_config?JSON.parse(window.__firebase_config):{apiKey:"AIzaSyAMOU-IK6UfKk75UR0P_Rs80z0uEsssQ9o",authDomain:"epromdeploy.firebaseapp.com",projectId:"epromdeploy",storageBucket:"epromdeploy.firebasestorage.app",messagingSenderId:"179394609832",appId:"1:179394609832:web:cf8d21ea2eef70990cb89d",measurementId:"G-X5GVRLDBQQ"};zn.apps.length||zn.initializeApp(Az);zn.app();const gt=zn.firestore(),Jf=zn.auth();zn.storage();try{gt.settings({experimentalForceLongPolling:!0})}catch{}const Cz="https://script.google.com/macros/s/AKfycbywVx70i2DXMf90cuMkE84Jn3rNlIr6dQJwXdoVx7l9kzzSXU-9uxn1MnrbWnJRRu6b/exec",It={USERS:"users",IDEAS:"ideas",SETTINGS:"settings",TEMPLATES:"templates"},Zg="global_settings",Rz=t=>Jf.onAuthStateChanged(async e=>{if(e){const n=await gt.collection(It.USERS).doc(e.uid).get();n.exists?t(n.data()):t(null)}else t(null)}),xz=async(t,e)=>{const n=await Jf.signInWithEmailAndPassword(t,e);if(!n.user)throw new Error("Login failed.");const r=await gt.collection(It.USERS).doc(n.user.uid).get();if(!r.exists)throw new Error("User profile not found.");const i=r.data();if(i.status===Or.PENDING)throw new Error("Account pending admin approval");if(i.status===Or.REJECTED)throw new Error("Account rejected");return i},Pz=async t=>{if(!(await gt.collection(It.USERS).where("username","==",t.username).get()).empty)throw new Error("Username taken");const n=await Jf.createUserWithEmailAndPassword(t.email,t.password||"password");if(!n.user)throw new Error("Registration failed.");const r=t.email==="admin@eprom.com"?we.ADMIN:we.EMPLOYEE,i=t.email==="admin@eprom.com"?Or.ACTIVE:Or.PENDING,s={...t,id:n.user.uid,role:r,status:i,password:""};return await gt.collection(It.USERS).doc(s.id).set(s),s},Nz=async()=>{await Jf.signOut()},bz=async()=>(await gt.collection(It.USERS).get()).docs.map(e=>e.data()),RI=async(t,e,n)=>{const r=gt.collection(It.USERS).doc(t),i={status:e};n&&(i.role=n),await r.update(i)},kz=async(t,e)=>{await gt.collection(It.USERS).doc(t).update({role:e})},Dz=async t=>{await gt.collection(It.USERS).doc(t).delete()},Ma=async()=>(await gt.collection(It.IDEAS).get()).docs.map(e=>e.data()),e_=async t=>{await gt.collection(It.IDEAS).doc(t.id).set(t)},Mz=async t=>{await gt.collection(It.IDEAS).doc(t).delete()},Vz=async()=>{const t=await gt.collection(It.SETTINGS).doc(Zg).get();if(t.exists)return t.data();const e={appName:"EPROM Innovation Hub",logoUrl:"",departments:["Operations","Safety","Engineering","IT","HR"],categories:["Cost Reduction","Safety Improvement","Process Optimization","Innovation","Sustainability"]};return await gt.collection(It.SETTINGS).doc(Zg).set(e),e},gm=async t=>{await gt.collection(It.SETTINGS).doc(Zg).set(t)},Qv=async()=>{const e=(await gt.collection(It.TEMPLATES).get()).docs.map(n=>n.data());if(e.length===0){const n={id:"default-1",name:"Standard Operational Improvement",description:"Standard form for submitting operational efficiency and cost reduction ideas.",isActive:!0,ratingConfig:[{id:"impact",name:"Impact on Business Goals",description:"Reduces cost, increases revenue, improves safety.",weight:30},{id:"feasibility",name:"Feasibility",description:"Ease of implementation (resources, time).",weight:20},{id:"roi",name:"Cost vs. Benefit",description:"Estimated cost compared to expected benefits.",weight:20},{id:"innovation",name:"Innovation Level",description:"New approach vs incremental improvement.",weight:15},{id:"risk",name:"Risk Level",description:"Operational, financial, or safety risks (High Score = Low Risk).",weight:15}],fields:[{id:"benefits",label:"Benefits / Value Proposition",type:"textarea",required:!0},{id:"cost",label:"Estimated Cost",type:"text",required:!1},{id:"feasibility",label:"Implementation Feasibility",type:"select",options:["Easy","Moderate","Complex"],required:!0},{id:"priority",label:"Priority Level",type:"select",options:["Low","Medium","High"],required:!1},{id:"timeline",label:"Expected Timeline",type:"select",options:["Short-term","Long-term"],required:!1},{id:"collab",label:"Collaboration Needed?",type:"checkbox",required:!1},{id:"tags",label:"Tags/Keywords",type:"text",required:!1}]};return await gt.collection(It.TEMPLATES).doc(n.id).set(n),[n]}return e},Lz=async t=>{await gt.collection(It.TEMPLATES).doc(t.id).set(t)},Uz=async t=>{await gt.collection(It.TEMPLATES).doc(t).delete()},Hb=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=i=>n(i)}),zb=async t=>{if(!t.type.startsWith("image/"))throw new Error("Only image files are allowed for this field.");if(t.size>500*1024)throw new Error("Image is too large for the database. Please use an image under 500KB.");try{return console.log("Converting image to Base64..."),await Hb(t)}catch(e){throw console.error("Image encoding failed:",e),new Error("Failed to process image file.")}},Fz=async t=>{if(t.size>5*1024*1024)throw new Error("File size exceeds 5MB limit. Please upload a smaller file.");try{const n=(await Hb(t)).split(",")[1],r=t.name||"uploaded_file",i=t.type||"application/octet-stream",s={filename:r,name:r,mimeType:i,type:i,data:n,base64:n,file:n};console.log("Uploading file to Drive...",{fileName:r,mimeType:i});const o=await fetch(Cz,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(s)});if(!o.ok)throw new Error(`Server returned ${o.status} ${o.statusText}`);const a=await o.text();let l;try{l=JSON.parse(a)}catch{throw console.error("Invalid JSON response:",a),new Error("Invalid response format from server.")}if(l.error||l.status==="error")throw new Error(l.error||l.message||"Unknown server error");const u=l.url||l.fileUrl||l.link||l.downloadUrl;if(!u)throw new Error("No URL returned from upload script.");return u}catch(e){throw console.error("Drive Upload failed",e),new Error(e.message||"Upload failed. Please try a smaller file or checking internet connection.")}};var Oz={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Bz,qz;function Gz(){return{geminiUrl:Bz,vertexUrl:qz}}function $z(t,e,n,r){var i,s;if(!(t!=null&&t.baseUrl)){const o=Gz();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class li{}function Y(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(t,e,n){for(let s=0;s<e.length-1;s++){const o=e[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const d=l[u];f(d,e.slice(s+1),n[u])}else for(const u of l)f(u,e.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];f(l[0],e.slice(s+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in t){const o=t[s];return Array.isArray(o)?o.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function Hz(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),s=r.split("."),o=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&s.length>a)for(let l=a;l<s.length;l++){const u=s[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}t_(t,i,s,0,o)}}function t_(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2),a=t;if(o in a&&Array.isArray(a[o]))for(const l of a[o])t_(l,e,n,r+1,i)}else if(s==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,d]of Object.entries(l)){const p=[];for(const m of n.slice(r))m==="*"?p.push(u):p.push(m);f(o,p,d)}for(const u of a)delete o[u]}}else{const o=t;s in o&&t_(o[s],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yv(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zz(t){const e={},n=c(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function Wz(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],Jz(o)),e}function Kz(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["response"]);return o!=null&&f(e,["response"],jz(o)),e}function Jz(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Qz(o))),f(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function jz(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Yz(o))),f(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function Qz(t){const e={},n=c(t,["video"]);return n!=null&&f(e,["video"],r6(n)),e}function Yz(t){const e={},n=c(t,["_self"]);return n!=null&&f(e,["video"],i6(n)),e}function Xz(t){const e={},n=c(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function Zz(t){const e={},n=c(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function e6(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["response"]);return o!=null&&f(e,["response"],t6(o)),e}function t6(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&f(e,["parent"],r);const i=c(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function Wb(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["response"]);return o!=null&&f(e,["response"],n6(o)),e}function n6(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&f(e,["parent"],r);const i=c(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function r6(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],Yv(r));const i=c(t,["encoding"]);return i!=null&&f(e,["mimeType"],i),e}function i6(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],Yv(r));const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var xI;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(xI||(xI={}));var PI;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(PI||(PI={}));var NI;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(NI||(NI={}));var Zn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Zn||(Zn={}));var bI;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(bI||(bI={}));var kI;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(kI||(kI={}));var DI;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(DI||(DI={}));var MI;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(MI||(MI={}));var VI;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(VI||(VI={}));var LI;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(LI||(LI={}));var UI;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(UI||(UI={}));var FI;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(FI||(FI={}));var OI;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(OI||(OI={}));var BI;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(BI||(BI={}));var qI;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(qI||(qI={}));var GI;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(GI||(GI={}));var $I;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})($I||($I={}));var HI;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(HI||(HI={}));var zI;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(zI||(zI={}));var Uh;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Uh||(Uh={}));var WI;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(WI||(WI={}));var KI;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(KI||(KI={}));var JI;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(JI||(JI={}));var n_;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(n_||(n_={}));var jI;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(jI||(jI={}));var QI;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(QI||(QI={}));var YI;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(YI||(YI={}));var XI;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(XI||(XI={}));var ZI;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ZI||(ZI={}));var eS;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(eS||(eS={}));var tS;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(tS||(tS={}));var nS;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(nS||(nS={}));var rS;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(rS||(rS={}));var iS;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(iS||(iS={}));var sS;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(sS||(sS={}));var oS;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(oS||(oS={}));var aS;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(aS||(aS={}));var lS;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(lS||(lS={}));var uS;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(uS||(uS={}));var cS;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(cS||(cS={}));var dS;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(dS||(dS={}));var hS;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(hS||(hS={}));var fS;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(fS||(fS={}));var pS;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(pS||(pS={}));var mS;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(mS||(mS={}));var gS;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(gS||(gS={}));var _S;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(_S||(_S={}));var yS;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(yS||(yS={}));var vS;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(vS||(vS={}));var ES;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ES||(ES={}));var TS;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(TS||(TS={}));var wS;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(wS||(wS={}));var IS;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(IS||(IS={}));var SS;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(SS||(SS={}));var AS;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(AS||(AS={}));var Ko;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Ko||(Ko={}));class r_{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class kl{get text(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const p=[];for(const m of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[_,E]of Object.entries(m))_!=="text"&&_!=="thought"&&_!=="thoughtSignature"&&(E!==null||E!==void 0)&&p.push(_);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;d=!0,u+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const p of(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,_]of Object.entries(p))m!=="inlineData"&&(_!==null||_!==void 0)&&d.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,s,o,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,s,o,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(l=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class CS{}class RS{}class s6{}class o6{}class a6{}class l6{}class xS{}class PS{}class NS{}class u6{}class Fh{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Fh;let i;const s=e;return n?i=Kz(s):i=Wz(s),Object.assign(r,i),r}}class bS{}class kS{}class DS{}class MS{}class c6{}class d6{}class h6{}class Xv{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Xv,s=e6(e);return Object.assign(r,s),r}}class f6{}class p6{}class m6{}class VS{}class g6{get text(){var e,n,r;let i="",s=!1;const o=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,i+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,n,r;let i="";const s=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class _6{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Zv{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Zv,s=Wb(e);return Object.assign(r,s),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ve(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Kb(t,e){const n=ve(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function Jb(t){return Array.isArray(t)?t.map(e=>Oh(e)):[Oh(t)]}function Oh(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function jb(t){const e=Oh(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Qb(t){const e=Oh(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function LS(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Yb(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>LS(e)):[LS(t)]}function i_(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function US(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function FS(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function $t(t){if(t==null)throw new Error("ContentUnion is required");return i_(t)?t:{role:"user",parts:Yb(t)}}function eE(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=$t(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=$t(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>$t(n)):[$t(e)]}function qn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(US(t)||FS(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[$t(t)]}const e=[],n=[],r=i_(t[0]);for(const i of t){const s=i_(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(US(i)||FS(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:Yb(n)}),e}function y6(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Zn).includes(n[0].toUpperCase())?n[0].toUpperCase():Zn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Zn).includes(r.toUpperCase())?r.toUpperCase():Zn.TYPE_UNSPECIFIED})}}function la(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=t.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,t=s[1]):s[1].type==="null"&&(e.nullable=!0,t=s[0])),t.type instanceof Array&&y6(t.type,e);for(const[o,a]of Object.entries(t))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Zn).includes(a.toUpperCase())?a.toUpperCase():Zn.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=la(a);else if(r.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(la(u))}e[o]=l}else if(i.includes(o)){const l={};for(const[u,d]of Object.entries(a))l[u]=la(d);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function tE(t){return la(t)}function nE(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function rE(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Xa(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=la(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=la(e.response));return t}function Za(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function v6(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function ui(t,e){if(typeof e!="string")throw new Error("name must be a string");return v6(t,e,"cachedContents")}function Xb(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function cs(t){return Yv(t)}function E6(t){return t!=null&&typeof t=="object"&&"name"in t}function T6(t){return t!=null&&typeof t=="object"&&"video"in t}function w6(t){return t!=null&&typeof t=="object"&&"uri"in t}function Zb(t){var e;let n;if(E6(t)&&(n=t.name),!(w6(t)&&(n=t.uri,n===void 0))&&!(T6(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ek(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function tk(t){for(const e of["models","tunedModels","publisherModels"])if(I6(t,e))return t[e];return[]}function I6(t,e){return t!==null&&typeof t=="object"&&e in t}function S6(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function A6(t,e={}){const n=[],r=new Set;for(const i of t){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=S6(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function nk(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function C6(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function rk(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let s=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function el(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function ik(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R6(t){const e={},n=c(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>a3(o))),f(e,["inlinedResponses"],s)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["inlinedEmbedContentResponses"],s)}return e}function x6(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function P6(t){const e={},n=c(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&f(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Gd(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&f(e,["state"],ik(i));const s=c(t,["metadata","createTime"]);s!=null&&f(e,["createTime"],s);const o=c(t,["metadata","endTime"]);o!=null&&f(e,["endTime"],o);const a=c(t,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&f(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&f(e,["dest"],R6(rk(u))),e}function s_(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=c(t,["state"]);i!=null&&f(e,["state"],ik(i));const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["createTime"]);o!=null&&f(e,["createTime"],o);const a=c(t,["startTime"]);a!=null&&f(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&f(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&f(e,["updateTime"],u);const d=c(t,["model"]);d!=null&&f(e,["model"],d);const p=c(t,["inputConfig"]);p!=null&&f(e,["src"],N6(p));const m=c(t,["outputConfig"]);m!=null&&f(e,["dest"],x6(rk(m)));const _=c(t,["completionStats"]);return _!=null&&f(e,["completionStats"],_),e}function N6(t){const e={},n=c(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&f(e,["bigqueryUri"],i),e}function b6(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&f(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o3(t,o))),f(n,["requests","requests"],s)}return n}function k6(t){const e={},n=c(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&f(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function D6(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function M6(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],el(t,r)),n}function V6(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],el(t,r)),n}function L6(t){const e={},n=c(t,["content"]);n!=null&&f(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],U6(r));const i=c(t,["tokenCount"]);i!=null&&f(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&f(e,["finishReason"],s);const o=c(t,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=c(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&f(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const d=c(t,["safetyRatings"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(_=>_)),f(e,["safetyRatings"],m)}const p=c(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function U6(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["citations"],r)}return e}function sk(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>p3(s))),f(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function F6(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function O6(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&f(e,["outputConfig"],P6(C6(i))),n}function OS(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["src"]);i!=null&&f(n,["batch","inputConfig"],b6(t,nk(t,i)));const s=c(e,["config"]);return s!=null&&F6(s,n),n}function B6(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["model"],ve(t,r));const i=c(e,["src"]);i!=null&&f(n,["inputConfig"],k6(nk(t,i)));const s=c(e,["config"]);return s!=null&&O6(s,n),n}function q6(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function G6(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["src"]);i!=null&&f(n,["batch","inputConfig"],j6(t,i));const s=c(e,["config"]);return s!=null&&q6(s,n),n}function $6(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],el(t,r)),n}function H6(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],el(t,r)),n}function z6(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);return s!=null&&f(e,["error"],s),e}function W6(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);return s!=null&&f(e,["error"],s),e}function K6(t,e){const n={},r=c(e,["contents"]);if(r!=null){let s=eE(t,r);Array.isArray(s)&&(s=s.map(o=>o)),f(n,["requests[]","request","content"],s)}const i=c(e,["config"]);return i!=null&&(f(n,["_self"],J6(i,n)),Hz(n,{"requests[].*":"requests[].request.*"})),n}function J6(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&f(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&f(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function j6(t,e){const n={},r=c(e,["fileName"]);r!=null&&f(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&f(n,["requests"],K6(t,i)),n}function Q6(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Y6(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const r=c(t,["args"]);r!=null&&f(e,["args"],r);const i=c(t,["name"]);if(i!=null&&f(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function X6(t){const e={},n=c(t,["mode"]);n!=null&&f(e,["mode"],n);const r=c(t,["allowedFunctionNames"]);if(r!=null&&f(e,["allowedFunctionNames"],r),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Z6(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],sk($t(i)));const s=c(e,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&f(r,["topP"],o);const a=c(e,["topK"]);a!=null&&f(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const d=c(e,["stopSequences"]);d!=null&&f(r,["stopSequences"],d);const p=c(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=c(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const _=c(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const E=c(e,["frequencyPenalty"]);E!=null&&f(r,["frequencyPenalty"],E);const C=c(e,["seed"]);C!=null&&f(r,["seed"],C);const A=c(e,["responseMimeType"]);A!=null&&f(r,["responseMimeType"],A);const w=c(e,["responseSchema"]);w!=null&&f(r,["responseSchema"],tE(w));const T=c(e,["responseJsonSchema"]);if(T!=null&&f(r,["responseJsonSchema"],T),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=c(e,["safetySettings"]);if(n!==void 0&&S!=null){let b=S;Array.isArray(b)&&(b=b.map(Te=>m3(Te))),f(n,["safetySettings"],b)}const D=c(e,["tools"]);if(n!==void 0&&D!=null){let b=Za(D);Array.isArray(b)&&(b=b.map(Te=>_3(Xa(Te)))),f(n,["tools"],b)}const L=c(e,["toolConfig"]);if(n!==void 0&&L!=null&&f(n,["toolConfig"],g3(L)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=c(e,["cachedContent"]);n!==void 0&&M!=null&&f(n,["cachedContent"],ui(t,M));const R=c(e,["responseModalities"]);R!=null&&f(r,["responseModalities"],R);const I=c(e,["mediaResolution"]);I!=null&&f(r,["mediaResolution"],I);const P=c(e,["speechConfig"]);if(P!=null&&f(r,["speechConfig"],nE(P)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=c(e,["thinkingConfig"]);N!=null&&f(r,["thinkingConfig"],N);const k=c(e,["imageConfig"]);k!=null&&f(r,["imageConfig"],s3(k));const V=c(e,["enableEnhancedCivicAnswers"]);return V!=null&&f(r,["enableEnhancedCivicAnswers"],V),r}function e3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>L6(u))),f(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&f(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&f(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function t3(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],el(t,r)),n}function n3(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],el(t,r)),n}function r3(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function i3(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function s3(t){const e={},n=c(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=c(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),c(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function o3(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["request","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let a=qn(i);Array.isArray(a)&&(a=a.map(l=>sk(l))),f(n,["request","contents"],a)}const s=c(e,["metadata"]);s!=null&&f(n,["metadata"],s);const o=c(e,["config"]);return o!=null&&f(n,["request","generationConfig"],Z6(t,o,c(n,["request"],{}))),n}function a3(t){const e={},n=c(t,["response"]);n!=null&&f(e,["response"],e3(n));const r=c(t,["error"]);return r!=null&&f(e,["error"],r),e}function l3(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function u3(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&f(e,["_query","pageToken"],i);const s=c(t,["filter"]);return e!==void 0&&s!=null&&f(e,["_query","filter"],s),n}function c3(t){const e={},n=c(t,["config"]);return n!=null&&l3(n,e),e}function d3(t){const e={},n=c(t,["config"]);return n!=null&&u3(n,e),e}function h3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Gd(o))),f(e,["batchJobs"],s)}return e}function f3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>s_(o))),f(e,["batchJobs"],s)}return e}function p3(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&f(e,["fileData"],Q6(s));const o=c(t,["functionCall"]);o!=null&&f(e,["functionCall"],Y6(o));const a=c(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&f(e,["inlineData"],D6(l));const u=c(t,["text"]);u!=null&&f(e,["text"],u);const d=c(t,["thought"]);d!=null&&f(e,["thought"],d);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function m3(t){const e={},n=c(t,["category"]);if(n!=null&&f(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function g3(t){const e={},n=c(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],X6(n));const r=c(t,["retrievalConfig"]);return r!=null&&f(e,["retrievalConfig"],r),e}function _3(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(p=>p)),f(e,["functionDeclarations"],d)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=c(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const s=c(t,["fileSearch"]);s!=null&&f(e,["fileSearch"],s);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],r3(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],i3(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Xr;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(Xr||(Xr={}));class mo{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,s;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class y3 extends li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mo(Xr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=OS(this.apiClient,e),r=n._url,i=Y("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const d of l){const p=Object.assign({},d);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const _=p.request;_.systemInstruction=m,p.request=_}u.push(p)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const s=this.getGcsUri(e),o=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?r.dest=`${s.slice(0,-6)}/dest`:r.dest=`${s}_dest_${i}`;else if(o)r.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=B6(this.apiClient,e);return a=Y("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>s_(d))}else{const u=OS(this.apiClient,e);return a=Y("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>Gd(d))}}async createEmbeddingsInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=G6(this.apiClient,e);return s=Y("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>Gd(l))}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=n3(this.apiClient,e);return a=Y("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>s_(d))}else{const u=t3(this.apiClient,e);return a=Y("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>Gd(d))}}async cancel(e){var n,r,i,s;let o="",a={};if(this.apiClient.isVertexAI()){const l=V6(this.apiClient,e);o=Y("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=M6(this.apiClient,e);o=Y("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=d3(e);return a=Y("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=f3(d),m=new VS;return Object.assign(m,p),m})}else{const u=c3(e);return a=Y("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=h3(d),m=new VS;return Object.assign(m,p),m})}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=H6(this.apiClient,e);return a=Y("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>W6(d))}else{const u=$6(this.apiClient,e);return a=Y("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>z6(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function v3(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function BS(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>G3(s))),f(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function E3(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let d=qn(o);Array.isArray(d)&&(d=d.map(p=>BS(p))),f(e,["contents"],d)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],BS($t(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(p=>H3(p))),f(e,["tools"],d)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&f(e,["toolConfig"],$3(u)),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function T3(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&f(e,["expireTime"],i);const s=c(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=c(t,["contents"]);if(e!==void 0&&o!=null){let p=qn(o);Array.isArray(p)&&(p=p.map(m=>m)),f(e,["contents"],p)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],$t(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(m=>z3(m))),f(e,["tools"],p)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&f(e,["toolConfig"],u);const d=c(t,["kmsKeyName"]);return e!==void 0&&d!=null&&f(e,["encryption_spec","kmsKeyName"],d),n}function w3(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["model"],Kb(t,r));const i=c(e,["config"]);return i!=null&&E3(i,n),n}function I3(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["model"],Kb(t,r));const i=c(e,["config"]);return i!=null&&T3(i,n),n}function S3(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],ui(t,r)),n}function A3(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],ui(t,r)),n}function C3(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function R3(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function x3(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function P3(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const r=c(t,["args"]);r!=null&&f(e,["args"],r);const i=c(t,["name"]);if(i!=null&&f(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function N3(t){const e={},n=c(t,["mode"]);n!=null&&f(e,["mode"],n);const r=c(t,["allowedFunctionNames"]);if(r!=null&&f(e,["allowedFunctionNames"],r),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function b3(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const i=c(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&f(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function k3(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],ui(t,r)),n}function D3(t,e){const n={},r=c(e,["name"]);return r!=null&&f(n,["_url","name"],ui(t,r)),n}function M3(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function V3(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function L3(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function U3(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function F3(t){const e={},n=c(t,["config"]);return n!=null&&L3(n,e),e}function O3(t){const e={},n=c(t,["config"]);return n!=null&&U3(n,e),e}function B3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["cachedContents"],s)}return e}function q3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["cachedContents"],s)}return e}function G3(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&f(e,["fileData"],x3(s));const o=c(t,["functionCall"]);o!=null&&f(e,["functionCall"],P3(o));const a=c(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&f(e,["inlineData"],v3(l));const u=c(t,["text"]);u!=null&&f(e,["text"],u);const d=c(t,["thought"]);d!=null&&f(e,["thought"],d);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function $3(t){const e={},n=c(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],N3(n));const r=c(t,["retrievalConfig"]);return r!=null&&f(e,["retrievalConfig"],r),e}function H3(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(p=>p)),f(e,["functionDeclarations"],d)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=c(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const s=c(t,["fileSearch"]);s!=null&&f(e,["fileSearch"],s);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],M3(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],V3(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function z3(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>b3(m))),f(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=c(t,["computerUse"]);if(s!=null&&f(e,["computerUse"],s),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=c(t,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=c(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=c(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const d=c(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function W3(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function K3(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&f(e,["expireTime"],i),n}function J3(t,e){const n={},r=c(e,["name"]);r!=null&&f(n,["_url","name"],ui(t,r));const i=c(e,["config"]);return i!=null&&W3(i,n),n}function j3(t,e){const n={},r=c(e,["name"]);r!=null&&f(n,["_url","name"],ui(t,r));const i=c(e,["config"]);return i!=null&&K3(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Q3 extends li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mo(Xr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=I3(this.apiClient,e);return a=Y("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=w3(this.apiClient,e);return a=Y("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=D3(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=k3(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=A3(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=R3(d),m=new DS;return Object.assign(m,p),m})}else{const u=S3(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=C3(d),m=new DS;return Object.assign(m,p),m})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=j3(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>d)}else{const u=J3(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>d)}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=O3(e);return a=Y("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=q3(d),m=new MS;return Object.assign(m,p),m})}else{const u=F3(e);return a=Y("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=B3(d),m=new MS;return Object.assign(m,p),m})}}}function Bh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function qS(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ae(t){return this instanceof ae?(this.v=t,this):new ae(t)}function nr(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(E){return Promise.resolve(E).then(_,p)}}function a(_,E){r[_]&&(i[_]=function(C){return new Promise(function(A,w){s.push([_,C,A,w])>1||l(_,C)})},E&&(i[_]=E(i[_])))}function l(_,E){try{u(r[_](E))}catch(C){m(s[0][3],C)}}function u(_){_.value instanceof ae?Promise.resolve(_.value.v).then(d,p):m(s[0][2],_)}function d(_){l("next",_)}function p(_){l("throw",_)}function m(_,E){_(E),s.shift(),s.length&&l(s[0][0],s[0][1])}}function rr(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof qS=="function"?qS(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y3(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:ok(n)}function ok(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function X3(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function GS(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let s=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),s&&!ok(t[r])&&(s=!1),r++;s?e.push(...i):e.pop()}return e}class Z3{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new e5(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class e5{constructor(e,n,r,i={},s=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),X3(s)}async sendMessage(e){var n;await this.sendPromise;const r=$t(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const l=await i,u=(o=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,d=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];d!=null&&(m=(a=d.slice(p))!==null&&a!==void 0?a:[]);const _=u?[u]:[];this.recordHistory(r,_,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=$t(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(e=!1){const n=e?GS(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return nr(this,arguments,function*(){var i,s,o,a,l,u;const d=[];try{for(var p=!0,m=rr(e),_;_=yield ae(m.next()),i=_.done,!i;p=!0){a=_.value,p=!1;const E=a;if(Y3(E)){const C=(u=(l=E.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content;C!==void 0&&d.push(C)}yield yield ae(E)}}catch(E){s={error:E}}finally{try{!p&&!i&&(o=m.return)&&(yield ae(o.call(m)))}finally{if(s)throw s.error}}this.recordHistory(n,d)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...GS(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jf extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,jf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function t5(t){const e={},n=c(t,["file"]);return n!=null&&f(e,["file"],n),e}function n5(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function r5(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","file"],Zb(n)),e}function i5(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function s5(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","file"],Zb(n)),e}function o5(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function a5(t){const e={},n=c(t,["config"]);return n!=null&&o5(n,e),e}function l5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class u5 extends li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mo(Xr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=a5(e);return s=Y("files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=l5(l),d=new f6;return Object.assign(d,u),d})}}async createInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=t5(e);return s=Y("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=n5(l),d=new p6;return Object.assign(d,u),d})}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=s5(e);return s=Y("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=r5(e);return s=Y("files/{file}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=i5(l),d=new m6;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $d(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function c5(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>C5(s))),f(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function d5(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function h5(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const r=c(t,["args"]);r!=null&&f(e,["args"],r);const i=c(t,["name"]);if(i!=null&&f(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function f5(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const i=c(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&f(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function p5(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=c(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const i=c(t,["audioTimestamp"]);i!=null&&f(e,["audioTimestamp"],i);const s=c(t,["candidateCount"]);s!=null&&f(e,["candidateCount"],s);const o=c(t,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=c(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=c(t,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=c(t,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const d=c(t,["mediaResolution"]);d!=null&&f(e,["mediaResolution"],d);const p=c(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=c(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const _=c(t,["responseMimeType"]);_!=null&&f(e,["responseMimeType"],_);const E=c(t,["responseModalities"]);E!=null&&f(e,["responseModalities"],E);const C=c(t,["responseSchema"]);C!=null&&f(e,["responseSchema"],C);const A=c(t,["routingConfig"]);A!=null&&f(e,["routingConfig"],A);const w=c(t,["seed"]);w!=null&&f(e,["seed"],w);const T=c(t,["speechConfig"]);T!=null&&f(e,["speechConfig"],T);const S=c(t,["stopSequences"]);S!=null&&f(e,["stopSequences"],S);const D=c(t,["temperature"]);D!=null&&f(e,["temperature"],D);const L=c(t,["thinkingConfig"]);L!=null&&f(e,["thinkingConfig"],L);const M=c(t,["topK"]);M!=null&&f(e,["topK"],M);const R=c(t,["topP"]);if(R!=null&&f(e,["topP"],R),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function m5(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function g5(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function _5(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const d=c(t,["seed"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","seed"],d);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],rE(p));const m=c(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const _=c(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],_);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&f(e,["setup","systemInstruction"],c5($t(E)));const C=c(t,["tools"]);if(e!==void 0&&C!=null){let M=Za(C);Array.isArray(M)&&(M=M.map(R=>x5(Xa(R)))),f(e,["setup","tools"],M)}const A=c(t,["sessionResumption"]);e!==void 0&&A!=null&&f(e,["setup","sessionResumption"],R5(A));const w=c(t,["inputAudioTranscription"]);e!==void 0&&w!=null&&f(e,["setup","inputAudioTranscription"],w);const T=c(t,["outputAudioTranscription"]);e!==void 0&&T!=null&&f(e,["setup","outputAudioTranscription"],T);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&f(e,["setup","realtimeInputConfig"],S);const D=c(t,["contextWindowCompression"]);e!==void 0&&D!=null&&f(e,["setup","contextWindowCompression"],D);const L=c(t,["proactivity"]);if(e!==void 0&&L!=null&&f(e,["setup","proactivity"],L),c(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function y5(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],p5(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const d=c(t,["seed"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","seed"],d);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],rE(p));const m=c(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const _=c(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],_);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&f(e,["setup","systemInstruction"],$t(E));const C=c(t,["tools"]);if(e!==void 0&&C!=null){let R=Za(C);Array.isArray(R)&&(R=R.map(I=>P5(Xa(I)))),f(e,["setup","tools"],R)}const A=c(t,["sessionResumption"]);e!==void 0&&A!=null&&f(e,["setup","sessionResumption"],A);const w=c(t,["inputAudioTranscription"]);e!==void 0&&w!=null&&f(e,["setup","inputAudioTranscription"],w);const T=c(t,["outputAudioTranscription"]);e!==void 0&&T!=null&&f(e,["setup","outputAudioTranscription"],T);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&f(e,["setup","realtimeInputConfig"],S);const D=c(t,["contextWindowCompression"]);e!==void 0&&D!=null&&f(e,["setup","contextWindowCompression"],D);const L=c(t,["proactivity"]);e!==void 0&&L!=null&&f(e,["setup","proactivity"],L);const M=c(t,["explicitVadSignal"]);return e!==void 0&&M!=null&&f(e,["setup","explicitVadSignal"],M),n}function v5(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["setup","model"],ve(t,r));const i=c(e,["config"]);return i!=null&&f(n,["config"],_5(i,n)),n}function E5(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["setup","model"],ve(t,r));const i=c(e,["config"]);return i!=null&&f(n,["config"],y5(i,n)),n}function T5(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function w5(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["weightedPrompts"],r)}return e}function I5(t){const e={},n=c(t,["media"]);if(n!=null){let u=Jb(n);Array.isArray(u)&&(u=u.map(d=>$d(d))),f(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&f(e,["audio"],$d(Qb(r)));const i=c(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&f(e,["video"],$d(jb(s)));const o=c(t,["text"]);o!=null&&f(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function S5(t){const e={},n=c(t,["media"]);if(n!=null){let u=Jb(n);Array.isArray(u)&&(u=u.map(d=>d)),f(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&f(e,["audio"],Qb(r));const i=c(t,["audioStreamEnd"]);i!=null&&f(e,["audioStreamEnd"],i);const s=c(t,["video"]);s!=null&&f(e,["video"],jb(s));const o=c(t,["text"]);o!=null&&f(e,["text"],o);const a=c(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function A5(t){const e={},n=c(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&f(e,["toolCall"],i);const s=c(t,["toolCallCancellation"]);s!=null&&f(e,["toolCallCancellation"],s);const o=c(t,["usageMetadata"]);o!=null&&f(e,["usageMetadata"],N5(o));const a=c(t,["goAway"]);a!=null&&f(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);l!=null&&f(e,["sessionResumptionUpdate"],l);const u=c(t,["voiceActivityDetectionSignal"]);return u!=null&&f(e,["voiceActivityDetectionSignal"],u),e}function C5(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&f(e,["fileData"],d5(s));const o=c(t,["functionCall"]);o!=null&&f(e,["functionCall"],h5(o));const a=c(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&f(e,["inlineData"],$d(l));const u=c(t,["text"]);u!=null&&f(e,["text"],u);const d=c(t,["thought"]);d!=null&&f(e,["thought"],d);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function R5(t){const e={},n=c(t,["handle"]);if(n!=null&&f(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function x5(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(p=>p)),f(e,["functionDeclarations"],d)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=c(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const s=c(t,["fileSearch"]);s!=null&&f(e,["fileSearch"],s);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],m5(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],g5(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function P5(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>f5(m))),f(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=c(t,["computerUse"]);if(s!=null&&f(e,["computerUse"],s),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=c(t,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=c(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=c(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const d=c(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function N5(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&f(e,["responseTokenCount"],i);const s=c(t,["toolUsePromptTokenCount"]);s!=null&&f(e,["toolUsePromptTokenCount"],s);const o=c(t,["thoughtsTokenCount"]);o!=null&&f(e,["thoughtsTokenCount"],o);const a=c(t,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let _=l;Array.isArray(_)&&(_=_.map(E=>E)),f(e,["promptTokensDetails"],_)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let _=u;Array.isArray(_)&&(_=_.map(E=>E)),f(e,["cacheTokensDetails"],_)}const d=c(t,["candidatesTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(E=>E)),f(e,["responseTokensDetails"],_)}const p=c(t,["toolUsePromptTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(E=>E)),f(e,["toolUsePromptTokensDetails"],_)}const m=c(t,["trafficType"]);return m!=null&&f(e,["trafficType"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function b5(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function k5(t){const e={},n=c(t,["content"]);n!=null&&f(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],D5(r));const i=c(t,["tokenCount"]);i!=null&&f(e,["tokenCount"],i);const s=c(t,["finishReason"]);s!=null&&f(e,["finishReason"],s);const o=c(t,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=c(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&f(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const d=c(t,["safetyRatings"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(_=>_)),f(e,["safetyRatings"],m)}const p=c(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function D5(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),f(e,["citations"],r)}return e}function M5(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let s=qn(i);Array.isArray(s)&&(s=s.map(o=>o)),f(n,["contents"],s)}return n}function V5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["tokensInfo"],i)}return e}function L5(t){const e={},n=c(t,["values"]);n!=null&&f(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&f(e,["statistics"],U5(r)),e}function U5(t){const e={},n=c(t,["truncated"]);n!=null&&f(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&f(e,["tokenCount"],r),e}function Qf(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>W9(s))),f(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function F5(t){const e={},n=c(t,["controlType"]);n!=null&&f(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&f(e,["computeControl"],r),e}function O5(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function B5(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&f(e,["systemInstruction"],$t(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>ck(a))),f(e,["tools"],o)}const s=c(t,["generationConfig"]);return e!==void 0&&s!=null&&f(e,["generationConfig"],b9(s)),n}function q5(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let o=qn(i);Array.isArray(o)&&(o=o.map(a=>Qf(a))),f(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&O5(s),n}function G5(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let o=qn(i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&B5(s,n),n}function $5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&f(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&f(e,["cachedContentTokenCount"],i),e}function H5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&f(e,["totalTokens"],r),e}function z5(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],ve(t,r)),n}function W5(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],ve(t,r)),n}function K5(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function J5(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function j5(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&f(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&f(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const d=c(t,["personGeneration"]);e!==void 0&&d!=null&&f(e,["parameters","personGeneration"],d);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=c(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const _=c(t,["language"]);e!==void 0&&_!=null&&f(e,["parameters","language"],_);const E=c(t,["outputMimeType"]);e!==void 0&&E!=null&&f(e,["parameters","outputOptions","mimeType"],E);const C=c(t,["outputCompressionQuality"]);e!==void 0&&C!=null&&f(e,["parameters","outputOptions","compressionQuality"],C);const A=c(t,["addWatermark"]);e!==void 0&&A!=null&&f(e,["parameters","addWatermark"],A);const w=c(t,["labels"]);e!==void 0&&w!=null&&f(e,["labels"],w);const T=c(t,["editMode"]);e!==void 0&&T!=null&&f(e,["parameters","editMode"],T);const S=c(t,["baseSteps"]);return e!==void 0&&S!=null&&f(e,["parameters","editConfig","baseSteps"],S),n}function Q5(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(e,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>X9(l))),f(n,["instances[0]","referenceImages"],a)}const o=c(e,["config"]);return o!=null&&j5(o,n),n}function Y5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Yf(s))),f(e,["generatedImages"],i)}return e}function X5(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&f(e,["requests[]","title"],i);const s=c(t,["outputDimensionality"]);if(e!==void 0&&s!=null&&f(e,["requests[]","outputDimensionality"],s),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Z5(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&f(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&f(e,["instances[]","title"],i);const s=c(t,["outputDimensionality"]);e!==void 0&&s!=null&&f(e,["parameters","outputDimensionality"],s);const o=c(t,["mimeType"]);e!==void 0&&o!=null&&f(e,["instances[]","mimeType"],o);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&f(e,["parameters","autoTruncate"],a),n}function e9(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let a=eE(t,i);Array.isArray(a)&&(a=a.map(l=>l)),f(n,["requests[]","content"],a)}const s=c(e,["config"]);s!=null&&X5(s,n);const o=c(e,["model"]);return o!==void 0&&f(n,["requests[]","model"],ve(t,o)),n}function t9(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let o=eE(t,i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["instances[]","content"],o)}const s=c(e,["config"]);return s!=null&&Z5(s,n),n}function n9(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&f(e,["metadata"],i),e}function r9(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>L5(o))),f(e,["embeddings"],s)}const i=c(t,["metadata"]);return i!=null&&f(e,["metadata"],i),e}function i9(t){const e={},n=c(t,["endpoint"]);n!=null&&f(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&f(e,["deployedModelId"],r),e}function s9(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function o9(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const r=c(t,["args"]);r!=null&&f(e,["args"],r);const i=c(t,["name"]);if(i!=null&&f(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function a9(t){const e={},n=c(t,["mode"]);n!=null&&f(e,["mode"],n);const r=c(t,["allowedFunctionNames"]);if(r!=null&&f(e,["allowedFunctionNames"],r),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function l9(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const r=c(t,["name"]);r!=null&&f(e,["name"],r);const i=c(t,["parameters"]);i!=null&&f(e,["parameters"],i);const s=c(t,["parametersJsonSchema"]);s!=null&&f(e,["parametersJsonSchema"],s);const o=c(t,["response"]);o!=null&&f(e,["response"],o);const a=c(t,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function u9(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Qf($t(i)));const s=c(e,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&f(r,["topP"],o);const a=c(e,["topK"]);a!=null&&f(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const d=c(e,["stopSequences"]);d!=null&&f(r,["stopSequences"],d);const p=c(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=c(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const _=c(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const E=c(e,["frequencyPenalty"]);E!=null&&f(r,["frequencyPenalty"],E);const C=c(e,["seed"]);C!=null&&f(r,["seed"],C);const A=c(e,["responseMimeType"]);A!=null&&f(r,["responseMimeType"],A);const w=c(e,["responseSchema"]);w!=null&&f(r,["responseSchema"],tE(w));const T=c(e,["responseJsonSchema"]);if(T!=null&&f(r,["responseJsonSchema"],T),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=c(e,["safetySettings"]);if(n!==void 0&&S!=null){let b=S;Array.isArray(b)&&(b=b.map(Te=>Z9(Te))),f(n,["safetySettings"],b)}const D=c(e,["tools"]);if(n!==void 0&&D!=null){let b=Za(D);Array.isArray(b)&&(b=b.map(Te=>oW(Xa(Te)))),f(n,["tools"],b)}const L=c(e,["toolConfig"]);if(n!==void 0&&L!=null&&f(n,["toolConfig"],sW(L)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=c(e,["cachedContent"]);n!==void 0&&M!=null&&f(n,["cachedContent"],ui(t,M));const R=c(e,["responseModalities"]);R!=null&&f(r,["responseModalities"],R);const I=c(e,["mediaResolution"]);I!=null&&f(r,["mediaResolution"],I);const P=c(e,["speechConfig"]);if(P!=null&&f(r,["speechConfig"],nE(P)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=c(e,["thinkingConfig"]);N!=null&&f(r,["thinkingConfig"],N);const k=c(e,["imageConfig"]);k!=null&&f(r,["imageConfig"],L9(k));const V=c(e,["enableEnhancedCivicAnswers"]);return V!=null&&f(r,["enableEnhancedCivicAnswers"],V),r}function c9(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],$t(i));const s=c(e,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(e,["topP"]);o!=null&&f(r,["topP"],o);const a=c(e,["topK"]);a!=null&&f(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&f(r,["maxOutputTokens"],u);const d=c(e,["stopSequences"]);d!=null&&f(r,["stopSequences"],d);const p=c(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=c(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const _=c(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const E=c(e,["frequencyPenalty"]);E!=null&&f(r,["frequencyPenalty"],E);const C=c(e,["seed"]);C!=null&&f(r,["seed"],C);const A=c(e,["responseMimeType"]);A!=null&&f(r,["responseMimeType"],A);const w=c(e,["responseSchema"]);w!=null&&f(r,["responseSchema"],tE(w));const T=c(e,["responseJsonSchema"]);T!=null&&f(r,["responseJsonSchema"],T);const S=c(e,["routingConfig"]);S!=null&&f(r,["routingConfig"],S);const D=c(e,["modelSelectionConfig"]);D!=null&&f(r,["modelConfig"],D);const L=c(e,["safetySettings"]);if(n!==void 0&&L!=null){let dt=L;Array.isArray(dt)&&(dt=dt.map(At=>At)),f(n,["safetySettings"],dt)}const M=c(e,["tools"]);if(n!==void 0&&M!=null){let dt=Za(M);Array.isArray(dt)&&(dt=dt.map(At=>ck(Xa(At)))),f(n,["tools"],dt)}const R=c(e,["toolConfig"]);n!==void 0&&R!=null&&f(n,["toolConfig"],R);const I=c(e,["labels"]);n!==void 0&&I!=null&&f(n,["labels"],I);const P=c(e,["cachedContent"]);n!==void 0&&P!=null&&f(n,["cachedContent"],ui(t,P));const N=c(e,["responseModalities"]);N!=null&&f(r,["responseModalities"],N);const k=c(e,["mediaResolution"]);k!=null&&f(r,["mediaResolution"],k);const V=c(e,["speechConfig"]);V!=null&&f(r,["speechConfig"],nE(V));const b=c(e,["audioTimestamp"]);b!=null&&f(r,["audioTimestamp"],b);const Te=c(e,["thinkingConfig"]);Te!=null&&f(r,["thinkingConfig"],Te);const Mt=c(e,["imageConfig"]);if(Mt!=null&&f(r,["imageConfig"],U9(Mt)),c(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return r}function $S(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let o=qn(i);Array.isArray(o)&&(o=o.map(a=>Qf(a))),f(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&f(n,["generationConfig"],u9(t,s,n)),n}function HS(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["contents"]);if(i!=null){let o=qn(i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}const s=c(e,["config"]);return s!=null&&f(n,["generationConfig"],c9(t,s,n)),n}function zS(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>k5(u))),f(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&f(e,["modelVersion"],i);const s=c(t,["promptFeedback"]);s!=null&&f(e,["promptFeedback"],s);const o=c(t,["responseId"]);o!=null&&f(e,["responseId"],o);const a=c(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function WS(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>d)),f(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&f(e,["createTime"],i);const s=c(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const o=c(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&f(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&f(e,["usageMetadata"],l),e}function d9(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const s=c(t,["guidanceScale"]);if(e!==void 0&&s!=null&&f(e,["parameters","guidanceScale"],s),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&f(e,["parameters","safetySetting"],o);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&f(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&f(e,["parameters","includeRaiReason"],u);const d=c(t,["language"]);e!==void 0&&d!=null&&f(e,["parameters","language"],d);const p=c(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=c(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const _=c(t,["imageSize"]);if(e!==void 0&&_!=null&&f(e,["parameters","sampleImageSize"],_),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function h9(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&f(e,["parameters","negativePrompt"],i);const s=c(t,["numberOfImages"]);e!==void 0&&s!=null&&f(e,["parameters","sampleCount"],s);const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const d=c(t,["personGeneration"]);e!==void 0&&d!=null&&f(e,["parameters","personGeneration"],d);const p=c(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=c(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const _=c(t,["language"]);e!==void 0&&_!=null&&f(e,["parameters","language"],_);const E=c(t,["outputMimeType"]);e!==void 0&&E!=null&&f(e,["parameters","outputOptions","mimeType"],E);const C=c(t,["outputCompressionQuality"]);e!==void 0&&C!=null&&f(e,["parameters","outputOptions","compressionQuality"],C);const A=c(t,["addWatermark"]);e!==void 0&&A!=null&&f(e,["parameters","addWatermark"],A);const w=c(t,["labels"]);e!==void 0&&w!=null&&f(e,["labels"],w);const T=c(t,["imageSize"]);e!==void 0&&T!=null&&f(e,["parameters","sampleImageSize"],T);const S=c(t,["enhancePrompt"]);return e!==void 0&&S!=null&&f(e,["parameters","enhancePrompt"],S),n}function f9(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&d9(s,n),n}function p9(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(e,["config"]);return s!=null&&h9(s,n),n}function m9(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>R9(o))),f(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&f(e,["positivePromptSafetyAttributes"],lk(i)),e}function g9(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Yf(o))),f(e,["generatedImages"],s)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&f(e,["positivePromptSafetyAttributes"],uk(i)),e}function _9(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&f(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const o=c(t,["resolution"]);e!==void 0&&o!=null&&f(e,["parameters","resolution"],o);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&f(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&f(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=c(t,["lastFrame"]);e!==void 0&&d!=null&&f(e,["instances[0]","lastFrame"],Xf(d));const p=c(t,["referenceImages"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(_=>vW(_))),f(e,["instances[0]","referenceImages"],m)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function y9(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=c(t,["fps"]);e!==void 0&&s!=null&&f(e,["parameters","fps"],s);const o=c(t,["durationSeconds"]);e!==void 0&&o!=null&&f(e,["parameters","durationSeconds"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&f(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&f(e,["parameters","resolution"],u);const d=c(t,["personGeneration"]);e!==void 0&&d!=null&&f(e,["parameters","personGeneration"],d);const p=c(t,["pubsubTopic"]);e!==void 0&&p!=null&&f(e,["parameters","pubsubTopic"],p);const m=c(t,["negativePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","negativePrompt"],m);const _=c(t,["enhancePrompt"]);e!==void 0&&_!=null&&f(e,["parameters","enhancePrompt"],_);const E=c(t,["generateAudio"]);e!==void 0&&E!=null&&f(e,["parameters","generateAudio"],E);const C=c(t,["lastFrame"]);e!==void 0&&C!=null&&f(e,["instances[0]","lastFrame"],ar(C));const A=c(t,["referenceImages"]);if(e!==void 0&&A!=null){let S=A;Array.isArray(S)&&(S=S.map(D=>EW(D))),f(e,["instances[0]","referenceImages"],S)}const w=c(t,["mask"]);e!==void 0&&w!=null&&f(e,["instances[0]","mask"],yW(w));const T=c(t,["compressionQuality"]);return e!==void 0&&T!=null&&f(e,["parameters","compressionQuality"],T),n}function v9(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],I9(o)),e}function E9(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["response"]);return o!=null&&f(e,["response"],S9(o)),e}function T9(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&f(n,["instances[0]","image"],Xf(s));const o=c(e,["video"]);o!=null&&f(n,["instances[0]","video"],dk(o));const a=c(e,["source"]);a!=null&&A9(a,n);const l=c(e,["config"]);return l!=null&&_9(l,n),n}function w9(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(e,["image"]);s!=null&&f(n,["instances[0]","image"],ar(s));const o=c(e,["video"]);o!=null&&f(n,["instances[0]","video"],hk(o));const a=c(e,["source"]);a!=null&&C9(a,n);const l=c(e,["config"]);return l!=null&&y9(l,n),n}function I9(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>P9(o))),f(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function S9(t){const e={},n=c(t,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>N9(o))),f(e,["generatedVideos"],s)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&f(e,["raiMediaFilteredReasons"],i),e}function A9(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],Xf(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&f(e,["instances[0]","video"],dk(s)),n}function C9(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],ar(i));const s=c(t,["video"]);return e!==void 0&&s!=null&&f(e,["instances[0]","video"],hk(s)),n}function R9(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["image"],F9(n));const r=c(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&f(e,["safetyAttributes"],lk(i)),e}function Yf(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["image"],ak(n));const r=c(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&f(e,["safetyAttributes"],uk(i));const s=c(t,["prompt"]);return s!=null&&f(e,["enhancedPrompt"],s),e}function x9(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["mask"],ak(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["labels"],i)}return e}function P9(t){const e={},n=c(t,["video"]);return n!=null&&f(e,["video"],gW(n)),e}function N9(t){const e={},n=c(t,["_self"]);return n!=null&&f(e,["video"],_W(n)),e}function b9(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=c(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const i=c(t,["audioTimestamp"]);i!=null&&f(e,["audioTimestamp"],i);const s=c(t,["candidateCount"]);s!=null&&f(e,["candidateCount"],s);const o=c(t,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=c(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=c(t,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=c(t,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const d=c(t,["mediaResolution"]);d!=null&&f(e,["mediaResolution"],d);const p=c(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=c(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const _=c(t,["responseMimeType"]);_!=null&&f(e,["responseMimeType"],_);const E=c(t,["responseModalities"]);E!=null&&f(e,["responseModalities"],E);const C=c(t,["responseSchema"]);C!=null&&f(e,["responseSchema"],C);const A=c(t,["routingConfig"]);A!=null&&f(e,["routingConfig"],A);const w=c(t,["seed"]);w!=null&&f(e,["seed"],w);const T=c(t,["speechConfig"]);T!=null&&f(e,["speechConfig"],T);const S=c(t,["stopSequences"]);S!=null&&f(e,["stopSequences"],S);const D=c(t,["temperature"]);D!=null&&f(e,["temperature"],D);const L=c(t,["thinkingConfig"]);L!=null&&f(e,["thinkingConfig"],L);const M=c(t,["topK"]);M!=null&&f(e,["topK"],M);const R=c(t,["topP"]);if(R!=null&&f(e,["topP"],R),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function k9(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],ve(t,r)),n}function D9(t,e){const n={},r=c(e,["model"]);return r!=null&&f(n,["_url","name"],ve(t,r)),n}function M9(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function V9(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function L9(t){const e={},n=c(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=c(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),c(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function U9(t){const e={},n=c(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=c(t,["imageSize"]);r!=null&&f(e,["imageSize"],r);const i=c(t,["outputMimeType"]);i!=null&&f(e,["imageOutputOptions","mimeType"],i);const s=c(t,["outputCompressionQuality"]);return s!=null&&f(e,["imageOutputOptions","compressionQuality"],s),e}function F9(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&f(e,["imageBytes"],cs(n));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function ak(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&f(e,["imageBytes"],cs(r));const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Xf(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&f(e,["bytesBase64Encoded"],cs(n));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function ar(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&f(e,["bytesBase64Encoded"],cs(r));const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function O9(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],ek(t,a)),r}function B9(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(e,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(e,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],ek(t,a)),r}function q9(t,e){const n={},r=c(e,["config"]);return r!=null&&O9(t,r,n),n}function G9(t,e){const n={},r=c(e,["config"]);return r!=null&&B9(t,r,n),n}function $9(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=tk(i);Array.isArray(s)&&(s=s.map(o=>o_(o))),f(e,["models"],s)}return e}function H9(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let s=tk(i);Array.isArray(s)&&(s=s.map(o=>a_(o))),f(e,["models"],s)}return e}function z9(t){const e={},n=c(t,["maskMode"]);n!=null&&f(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&f(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&f(e,["dilation"],i),e}function o_(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=c(t,["description"]);i!=null&&f(e,["description"],i);const s=c(t,["version"]);s!=null&&f(e,["version"],s);const o=c(t,["_self"]);o!=null&&f(e,["tunedModelInfo"],aW(o));const a=c(t,["inputTokenLimit"]);a!=null&&f(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&f(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);u!=null&&f(e,["supportedActions"],u);const d=c(t,["temperature"]);d!=null&&f(e,["temperature"],d);const p=c(t,["maxTemperature"]);p!=null&&f(e,["maxTemperature"],p);const m=c(t,["topP"]);m!=null&&f(e,["topP"],m);const _=c(t,["topK"]);_!=null&&f(e,["topK"],_);const E=c(t,["thinking"]);return E!=null&&f(e,["thinking"],E),e}function a_(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["displayName"]);r!=null&&f(e,["displayName"],r);const i=c(t,["description"]);i!=null&&f(e,["description"],i);const s=c(t,["versionId"]);s!=null&&f(e,["version"],s);const o=c(t,["deployedModels"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(m=>i9(m))),f(e,["endpoints"],p)}const a=c(t,["labels"]);a!=null&&f(e,["labels"],a);const l=c(t,["_self"]);l!=null&&f(e,["tunedModelInfo"],lW(l));const u=c(t,["defaultCheckpointId"]);u!=null&&f(e,["defaultCheckpointId"],u);const d=c(t,["checkpoints"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["checkpoints"],p)}return e}function W9(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&f(e,["fileData"],s9(s));const o=c(t,["functionCall"]);o!=null&&f(e,["functionCall"],o9(o));const a=c(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&f(e,["inlineData"],b5(l));const u=c(t,["text"]);u!=null&&f(e,["text"],u);const d=c(t,["thought"]);d!=null&&f(e,["thought"],d);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function K9(t){const e={},n=c(t,["productImage"]);return n!=null&&f(e,["image"],ar(n)),e}function J9(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&f(e,["parameters","baseSteps"],i);const s=c(t,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const o=c(t,["seed"]);e!==void 0&&o!=null&&f(e,["parameters","seed"],o);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&f(e,["parameters","addWatermark"],u);const d=c(t,["outputMimeType"]);e!==void 0&&d!=null&&f(e,["parameters","outputOptions","mimeType"],d);const p=c(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","compressionQuality"],p);const m=c(t,["enhancePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m);const _=c(t,["labels"]);return e!==void 0&&_!=null&&f(e,["labels"],_),n}function j9(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["source"]);i!=null&&Y9(i,n);const s=c(e,["config"]);return s!=null&&J9(s,n),n}function Q9(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Yf(i))),f(e,["generatedImages"],r)}return e}function Y9(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&f(e,["instances[0]","personImage","image"],ar(i));const s=c(t,["productImages"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>K9(a))),f(e,["instances[0]","productImages"],o)}return n}function X9(t){const e={},n=c(t,["referenceImage"]);n!=null&&f(e,["referenceImage"],ar(n));const r=c(t,["referenceId"]);r!=null&&f(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&f(e,["referenceType"],i);const s=c(t,["maskImageConfig"]);s!=null&&f(e,["maskImageConfig"],z9(s));const o=c(t,["controlImageConfig"]);o!=null&&f(e,["controlImageConfig"],F5(o));const a=c(t,["styleImageConfig"]);a!=null&&f(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&f(e,["subjectImageConfig"],l),e}function lk(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&f(e,["contentType"],i),e}function uk(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&f(e,["contentType"],i),e}function Z9(t){const e={},n=c(t,["category"]);if(n!=null&&f(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function eW(t){const e={},n=c(t,["image"]);return n!=null&&f(e,["image"],ar(n)),e}function tW(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&f(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&f(e,["parameters","maxPredictions"],i);const s=c(t,["confidenceThreshold"]);e!==void 0&&s!=null&&f(e,["parameters","confidenceThreshold"],s);const o=c(t,["maskDilation"]);e!==void 0&&o!=null&&f(e,["parameters","maskDilation"],o);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&f(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&f(e,["labels"],l),n}function nW(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["source"]);i!=null&&iW(i,n);const s=c(e,["config"]);return s!=null&&tW(s,n),n}function rW(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>x9(i))),f(e,["generatedMasks"],r)}return e}function iW(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&f(e,["instances[0]","image"],ar(i));const s=c(t,["scribbleImage"]);return e!==void 0&&s!=null&&f(e,["instances[0]","scribble"],eW(s)),n}function sW(t){const e={},n=c(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],a9(n));const r=c(t,["retrievalConfig"]);return r!=null&&f(e,["retrievalConfig"],r),e}function oW(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(p=>p)),f(e,["functionDeclarations"],d)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=c(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const s=c(t,["fileSearch"]);s!=null&&f(e,["fileSearch"],s);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],M9(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],V9(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function ck(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>l9(m))),f(e,["functionDeclarations"],p)}const r=c(t,["retrieval"]);r!=null&&f(e,["retrieval"],r);const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=c(t,["computerUse"]);if(s!=null&&f(e,["computerUse"],s),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=c(t,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=c(t,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=c(t,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=c(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const d=c(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function aW(t){const e={},n=c(t,["baseModel"]);n!=null&&f(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&f(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&f(e,["updateTime"],i),e}function lW(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&f(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&f(e,["updateTime"],i),e}function uW(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&f(e,["defaultCheckpointId"],s),n}function cW(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);const s=c(t,["defaultCheckpointId"]);return e!==void 0&&s!=null&&f(e,["defaultCheckpointId"],s),n}function dW(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","name"],ve(t,r));const i=c(e,["config"]);return i!=null&&uW(i,n),n}function hW(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["config"]);return i!=null&&cW(i,n),n}function fW(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const i=c(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&f(e,["parameters","safetySetting"],i);const s=c(t,["personGeneration"]);e!==void 0&&s!=null&&f(e,["parameters","personGeneration"],s);const o=c(t,["includeRaiReason"]);e!==void 0&&o!=null&&f(e,["parameters","includeRaiReason"],o);const a=c(t,["outputMimeType"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","mimeType"],a);const l=c(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","compressionQuality"],l);const u=c(t,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const d=c(t,["imagePreservationFactor"]);e!==void 0&&d!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],d);const p=c(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=c(t,["numberOfImages"]);e!==void 0&&m!=null&&f(e,["parameters","sampleCount"],m);const _=c(t,["mode"]);return e!==void 0&&_!=null&&f(e,["parameters","mode"],_),n}function pW(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["_url","model"],ve(t,r));const i=c(e,["image"]);i!=null&&f(n,["instances[0]","image"],ar(i));const s=c(e,["upscaleFactor"]);s!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(e,["config"]);return o!=null&&fW(o,n),n}function mW(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Yf(s))),f(e,["generatedImages"],i)}return e}function gW(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],cs(r));const i=c(t,["encoding"]);return i!=null&&f(e,["mimeType"],i),e}function _W(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],cs(r));const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function yW(t){const e={},n=c(t,["image"]);n!=null&&f(e,["_self"],ar(n));const r=c(t,["maskMode"]);return r!=null&&f(e,["maskMode"],r),e}function vW(t){const e={},n=c(t,["image"]);n!=null&&f(e,["image"],Xf(n));const r=c(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function EW(t){const e={},n=c(t,["image"]);n!=null&&f(e,["image"],ar(n));const r=c(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function dk(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&f(e,["encodedVideo"],cs(r));const i=c(t,["mimeType"]);return i!=null&&f(e,["encoding"],i),e}function hk(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&f(e,["bytesBase64Encoded"],cs(r));const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TW(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["displayName"],r),n}function wW(t){const e={},n=c(t,["config"]);return n!=null&&TW(n,e),e}function IW(t,e){const n={},r=c(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function SW(t){const e={},n=c(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=c(t,["config"]);return r!=null&&IW(r,e),e}function AW(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function CW(t,e){const n={},r=c(t,["customMetadata"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["customMetadata"],s)}const i=c(t,["chunkingConfig"]);return e!==void 0&&i!=null&&f(e,["chunkingConfig"],i),n}function RW(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const r=c(t,["metadata"]);r!=null&&f(e,["metadata"],r);const i=c(t,["done"]);i!=null&&f(e,["done"],i);const s=c(t,["error"]);s!=null&&f(e,["error"],s);const o=c(t,["response"]);return o!=null&&f(e,["response"],PW(o)),e}function xW(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=c(t,["fileName"]);r!=null&&f(e,["fileName"],r);const i=c(t,["config"]);return i!=null&&CW(i,e),e}function PW(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&f(e,["parent"],r);const i=c(t,["documentName"]);return i!=null&&f(e,["documentName"],i),e}function NW(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function bW(t){const e={},n=c(t,["config"]);return n!=null&&NW(n,e),e}function kW(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["fileSearchStores"],s)}return e}function fk(t,e){const n={},r=c(t,["mimeType"]);e!==void 0&&r!=null&&f(e,["mimeType"],r);const i=c(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=c(t,["customMetadata"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),f(e,["customMetadata"],a)}const o=c(t,["chunkingConfig"]);return e!==void 0&&o!=null&&f(e,["chunkingConfig"],o),n}function DW(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=c(t,["config"]);return r!=null&&fk(r,e),e}function MW(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VW="Content-Type",LW="X-Server-Timeout",UW="User-Agent",l_="x-goog-api-client",FW="1.34.0",OW=`google-genai-sdk/${FW}`,BW="v1beta1",qW="v1beta";class GW{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:BW,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:qW,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))i.searchParams.append(o,String(a));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=o}return n&&n.extraBody!==null&&$W(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await KS(i),new r_(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await KS(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return nr(this,arguments,function*(){var r;const i=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";const a="data:",l=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:u,value:d}=yield ae(i.read());if(u){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=s.decode(d,{stream:!0});try{const E=JSON.parse(p);if("error"in E){const C=JSON.parse(JSON.stringify(E.error)),A=C.status,w=C.code,T=`got status: ${A}. ${JSON.stringify(E)}`;if(w>=400&&w<600)throw new jf({message:T,status:w})}}catch(E){if(E.name==="ApiError")throw E}o+=p;let m=-1,_=0;for(;;){m=-1,_=0;for(const A of l){const w=o.indexOf(A);w!==-1&&(m===-1||w<m)&&(m=w,_=A.length)}if(m===-1)break;const E=o.substring(0,m);o=o.substring(m+_);const C=E.trim();if(C.startsWith(a)){const A=C.substring(a.length).trim();try{const w=new Response(A,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ae(new r_(w))}catch(w){throw new Error(`exception parsing stream chunk ${A}. ${w}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=OW+" "+this.clientOptions.userAgentExtra;return e[UW]=n,e[l_]=n,e[VW]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))r.append(i,s);e.timeout&&e.timeout>0&&r.append(LW,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(e);i.sizeBytes=String(o.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l={file:i},u=this.getFileName(e),d=Y("upload/v1beta/files",l._url),p=await this.fetchUploadUrl(d,i.sizeBytes,i.mimeType,u,l,n==null?void 0:n.httpOptions);return s.upload(e,p,this)}async uploadFileToFileSearchStore(e,n,r){var i;const s=this.clientOptions.uploader,o=await s.stat(n),a=String(o.size),l=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,d=this.getFileName(n),p={};r!=null&&fk(r,p);const m=await this.fetchUploadUrl(u,a,l,d,p,r==null?void 0:r.httpOptions);return s.uploadToFileSearchStore(n,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,i,s,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function KS(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new jf({message:i,status:n}):new Error(i)}}function $W(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const s=JSON.parse(t.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const a=Object.assign({},s);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],d=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&d&&typeof d=="object"&&!Array.isArray(d)?a[l]=r(d,u):(d&&u&&typeof d!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof d}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const HW="mcp_used/unknown";let zW=!1;function pk(t){for(const e of t)if(WW(e)||typeof e=="object"&&"inputSchema"in e)return!0;return zW}function mk(t){var e;const n=(e=t[l_])!==null&&e!==void 0?e:"";t[l_]=(n+` ${HW}`).trimStart()}function WW(t){return t!==null&&typeof t=="object"&&t instanceof iE}function KW(t){return nr(this,arguments,function*(n,r=100){let i,s=0;for(;s<r;){const o=yield ae(n.listTools({cursor:i}));for(const a of o.tools)yield yield ae(a),s++;if(!o.nextCursor)break;i=o.nextCursor}})}class iE{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new iE(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const d of this.mcpClients)try{for(var a=!0,l=(n=void 0,rr(KW(d))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const p=i;o.push(p);const m=p.name;if(s[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);s[m]=d}}catch(p){n={error:p}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),A6(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function JW(t,e,n){const r=new _6;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class jW{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=XW(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const d=new Promise(S=>{u=S}),p=e.callbacks,m=function(){u({})},_=this.apiClient,E={onopen:m,onmessage:S=>{JW(_,p.onmessage,S)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(S){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(S){}},C=this.webSocketFactory.create(l,YW(o),E);C.connect(),await d;const T={setup:{model:ve(this.apiClient,e.model)}};return C.send(JSON.stringify(T)),new QW(C,this.apiClient)}}class QW{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=w5(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=T5(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ko.PLAY)}pause(){this.sendPlaybackControl(Ko.PAUSE)}stop(){this.sendPlaybackControl(Ko.STOP)}resetContext(){this.sendPlaybackControl(Ko.RESET_CONTEXT)}close(){this.conn.close()}}function YW(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function XW(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZW="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function eK(t,e,n){const r=new g6;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(t.isVertexAI()){const o=A5(s);Object.assign(r,o)}else Object.assign(r,s);e(r)}class tK{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new jW(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,s,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let d;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&pk(e.config.tools)&&mk(p);const m=sK(p);if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,d);else{const P=this.apiClient.getApiKey();let N="BidiGenerateContent",k="key";P!=null&&P.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",k="access_token"),d=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${N}?${k}=${P}`}let _=()=>{};const E=new Promise(P=>{_=P}),C=e.callbacks,A=function(){var P;(P=C==null?void 0:C.onopen)===null||P===void 0||P.call(C),_({})},w=this.apiClient,T={onopen:A,onmessage:P=>{eK(w,C.onmessage,P)},onerror:(n=C==null?void 0:C.onerror)!==null&&n!==void 0?n:function(P){},onclose:(r=C==null?void 0:C.onclose)!==null&&r!==void 0?r:function(P){}},S=this.webSocketFactory.create(d,iK(m),T);S.connect(),await E;let D=ve(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const P=this.apiClient.getProject(),N=this.apiClient.getLocation();D=`projects/${P}/locations/${N}/`+D}let L={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Uh.AUDIO]}:e.config.responseModalities=[Uh.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],R=[];for(const P of M)if(this.isCallableTool(P)){const N=P;R.push(await N.tool())}else R.push(P);R.length>0&&(e.config.tools=R);const I={model:D,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?L=E5(this.apiClient,I):L=v5(this.apiClient,I),delete L.config,S.send(JSON.stringify(L)),new rK(S,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const nK={turnComplete:!0};class rK{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=qn(n.turns),e.isVertexAI()||(r=r.map(i=>Qf(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(ZW)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},nK),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:S5(e)}:n={realtimeInput:I5(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function iK(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function sK(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JS=10;function jS(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(ua(o)){i=!0;break}if(!i)return!0;const s=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function ua(t){return"callTool"in t&&typeof t.callTool=="function"}function oK(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>ua(i)))!==null&&r!==void 0?r:!1}function QS(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,i)=>{if(ua(r))return;const s=r;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(i)}),n}function YS(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aK extends li{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,s,o,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!oK(n)||jS(n.config))return await this.generateContentInternal(l);const u=QS(n);if(u.length>0){const C=u.map(A=>`tools[${A}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${C}.`)}let d,p;const m=qn(l.contents),_=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:JS;let E=0;for(;E<_&&(d=await this.generateContentInternal(l),!(!d.functionCalls||d.functionCalls.length===0));){const C=d.candidates[0].content,A=[];for(const w of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(ua(w)){const S=await w.callTool(d.functionCalls);A.push(...S)}E++,p={role:"user",parts:A},l.contents=qn(l.contents),l.contents.push(C),l.contents.push(p),YS(l.config)&&(m.push(C),m.push(p))}return YS(l.config)&&(d.automaticFunctionCallingHistory=m),d},this.generateContentStream=async n=>{var r,i,s,o,a;if(this.maybeMoveToResponseJsonSchem(n),jS(n.config)){const p=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(p)}const l=QS(n);if(l.length>0){const p=l.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(s=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,d=(a=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:o.push(l);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new mo(Xr.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,s,o,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const s=(n=e.config)===null||n===void 0?void 0:n.tools;if(!s)return e;const o=await Promise.all(s.map(async l=>ua(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&pk(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),mk(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const s=new Map;for(const o of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(ua(o)){const a=o,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,a)}}return s}async processAfcStream(e){var n,r,i;const s=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:JS;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,d,p){return nr(this,arguments,function*(){for(var m,_,E,C,A,w;a<s;){o&&(a++,o=!1);const L=yield ae(u.processParamsMaybeAddMcpUsage(p)),M=yield ae(u.generateContentStreamInternal(L)),R=[],I=[];try{for(var T=!0,S=(_=void 0,rr(M)),D;D=yield ae(S.next()),m=D.done,!m;T=!0){C=D.value,T=!1;const P=C;if(yield yield ae(P),P.candidates&&(!((A=P.candidates[0])===null||A===void 0)&&A.content)){I.push(P.candidates[0].content);for(const N of(w=P.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(a<s&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(N.functionCall.name)){const k=yield ae(d.get(N.functionCall.name).callTool([N.functionCall]));R.push(...k)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(P){_={error:P}}finally{try{!T&&!m&&(E=S.return)&&(yield ae(E.call(S)))}finally{if(_)throw _.error}}if(R.length>0){o=!0;const P=new kl;P.candidates=[{content:{role:"user",parts:R}}],yield yield ae(P);const N=[];N.push(...I),N.push({role:"user",parts:R});const k=qn(p.contents).concat(N);p.contents=k}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HS(this.apiClient,e);return a=Y("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=WS(d),m=new kl;return Object.assign(m,p),m})}else{const u=$S(this.apiClient,e);return a=Y("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=zS(d),m=new kl;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HS(this.apiClient,e);return a=Y("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return nr(this,arguments,function*(){var m,_,E,C;try{for(var A=!0,w=rr(p),T;T=yield ae(w.next()),m=T.done,!m;A=!0){C=T.value,A=!1;const S=C,D=WS(yield ae(S.json()));D.sdkHttpResponse={headers:S.headers};const L=new kl;Object.assign(L,D),yield yield ae(L)}}catch(S){_={error:S}}finally{try{!A&&!m&&(E=w.return)&&(yield ae(E.call(w)))}finally{if(_)throw _.error}}})})}else{const u=$S(this.apiClient,e);return a=Y("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(p){return nr(this,arguments,function*(){var m,_,E,C;try{for(var A=!0,w=rr(p),T;T=yield ae(w.next()),m=T.done,!m;A=!0){C=T.value,A=!1;const S=C,D=zS(yield ae(S.json()));D.sdkHttpResponse={headers:S.headers};const L=new kl;Object.assign(L,D),yield yield ae(L)}}catch(S){_={error:S}}finally{try{!A&&!m&&(E=w.return)&&(yield ae(E.call(w)))}finally{if(_)throw _.error}}})})}}async embedContent(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=t9(this.apiClient,e);return a=Y("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=r9(d),m=new CS;return Object.assign(m,p),m})}else{const u=e9(this.apiClient,e);return a=Y("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=n9(d),m=new CS;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=p9(this.apiClient,e);return a=Y("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=g9(d),m=new RS;return Object.assign(m,p),m})}else{const u=f9(this.apiClient,e);return a=Y("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=m9(d),m=new RS;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=Q5(this.apiClient,e);return s=Y("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=Y5(l),d=new s6;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=pW(this.apiClient,e);return s=Y("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=mW(l),d=new o6;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=j9(this.apiClient,e);return s=Y("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=Q9(l),d=new a6;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=nW(this.apiClient,e);return s=Y("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=rW(l),d=new l6;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=D9(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>a_(d))}else{const u=k9(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>o_(d))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=G9(this.apiClient,e);return a=Y("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=H9(d),m=new xS;return Object.assign(m,p),m})}else{const u=q9(this.apiClient,e);return a=Y("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=$9(d),m=new xS;return Object.assign(m,p),m})}}async update(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=hW(this.apiClient,e);return a=Y("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>a_(d))}else{const u=dW(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>o_(d))}}async delete(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=W5(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=J5(d),m=new PS;return Object.assign(m,p),m})}else{const u=z5(this.apiClient,e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=K5(d),m=new PS;return Object.assign(m,p),m})}}async countTokens(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=G5(this.apiClient,e);return a=Y("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=H5(d),m=new NS;return Object.assign(m,p),m})}else{const u=q5(this.apiClient,e);return a=Y("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=$5(d),m=new NS;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=M5(this.apiClient,e);return s=Y("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const u=V5(l),d=new u6;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=w9(this.apiClient,e);return a=Y("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const p=E9(d),m=new Fh;return Object.assign(m,p),m})}else{const u=T9(this.apiClient,e);return a=Y("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o.then(d=>{const p=v9(d),m=new Fh;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lK extends li{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Zz(e);return a=Y("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o}else{const u=Xz(e);return a=Y("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),o}}async fetchPredictVideosOperationInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=zz(e);return s=Y("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uK(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function cK(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>vK(s))),f(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&f(e,["role"],r),e}function dK(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&f(n,["expireTime"],i);const s=c(e,["newSessionExpireTime"]);n!==void 0&&s!=null&&f(n,["newSessionExpireTime"],s);const o=c(e,["uses"]);n!==void 0&&o!=null&&f(n,["uses"],o);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],yK(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&f(n,["fieldMask"],l),r}function hK(t,e){const n={},r=c(e,["config"]);return r!=null&&f(n,["config"],dK(t,r,n)),n}function fK(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function pK(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const r=c(t,["args"]);r!=null&&f(e,["args"],r);const i=c(t,["name"]);if(i!=null&&f(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function mK(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function gK(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function _K(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","responseModalities"],i);const s=c(t,["temperature"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","temperature"],s);const o=c(t,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=c(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const d=c(t,["seed"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","seed"],d);const p=c(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],rE(p));const m=c(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const _=c(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],_);const E=c(t,["systemInstruction"]);e!==void 0&&E!=null&&f(e,["setup","systemInstruction"],cK($t(E)));const C=c(t,["tools"]);if(e!==void 0&&C!=null){let M=Za(C);Array.isArray(M)&&(M=M.map(R=>TK(Xa(R)))),f(e,["setup","tools"],M)}const A=c(t,["sessionResumption"]);e!==void 0&&A!=null&&f(e,["setup","sessionResumption"],EK(A));const w=c(t,["inputAudioTranscription"]);e!==void 0&&w!=null&&f(e,["setup","inputAudioTranscription"],w);const T=c(t,["outputAudioTranscription"]);e!==void 0&&T!=null&&f(e,["setup","outputAudioTranscription"],T);const S=c(t,["realtimeInputConfig"]);e!==void 0&&S!=null&&f(e,["setup","realtimeInputConfig"],S);const D=c(t,["contextWindowCompression"]);e!==void 0&&D!=null&&f(e,["setup","contextWindowCompression"],D);const L=c(t,["proactivity"]);if(e!==void 0&&L!=null&&f(e,["setup","proactivity"],L),c(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function yK(t,e){const n={},r=c(e,["model"]);r!=null&&f(n,["setup","model"],ve(t,r));const i=c(e,["config"]);return i!=null&&f(n,["config"],_K(i,n)),n}function vK(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&f(e,["executableCode"],i);const s=c(t,["fileData"]);s!=null&&f(e,["fileData"],fK(s));const o=c(t,["functionCall"]);o!=null&&f(e,["functionCall"],pK(o));const a=c(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&f(e,["inlineData"],uK(l));const u=c(t,["text"]);u!=null&&f(e,["text"],u);const d=c(t,["thought"]);d!=null&&f(e,["thought"],d);const p=c(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=c(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function EK(t){const e={},n=c(t,["handle"]);if(n!=null&&f(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function TK(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(p=>p)),f(e,["functionDeclarations"],d)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const i=c(t,["computerUse"]);i!=null&&f(e,["computerUse"],i);const s=c(t,["fileSearch"]);s!=null&&f(e,["fileSearch"],s);const o=c(t,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=c(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],mK(a));const l=c(t,["googleSearch"]);l!=null&&f(e,["googleSearch"],gK(l));const u=c(t,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wK(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);e.push(...i)}else e.push(n)}return e.join(",")}function IK(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(t.bidiGenerateContentSetup=s,n=s):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const s=wK(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?t.fieldMask=s:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class SK extends li{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=hK(this.apiClient,e);s=Y("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=IK(a,e.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AK(t,e){const n={},r=c(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function CK(t){const e={},n=c(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=c(t,["config"]);return r!=null&&AK(r,e),e}function RK(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function xK(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&f(e,["_query","pageToken"],i),n}function PK(t){const e={},n=c(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const r=c(t,["config"]);return r!=null&&xK(r,e),e}function NK(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const i=c(t,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["documents"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bK extends li{constructor(e){super(),this.apiClient=e,this.list=async n=>new mo(Xr.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=RK(e);return s=Y("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=CK(e);i=Y("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=PK(e);return s=Y("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=NK(l),d=new c6;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kK extends li{constructor(e,n=new bK(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new mo(Xr.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=wW(e);return s=Y("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=AW(e);return s=Y("{name}",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=SW(e);i=Y("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=bW(e);return s=Y("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=kW(l),d=new d6;return Object.assign(d,u),d})}}async uploadToFileSearchStoreInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=DW(e);return s=Y("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=MW(l),d=new h6;return Object.assign(d,u),d})}}async importFile(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=xW(e);return s=Y("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=RW(l),d=new Xv;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let gk=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return gk=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const DK=()=>gk();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u_(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const c_=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kn extends Error{}class an extends Kn{constructor(e,n,r,i){super(`${an.makeMessage(e,n,r)}`),this.status=e,this.headers=i,this.error=n}static makeMessage(e,n,r){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,r,i){if(!e||!i)return new Zf({message:r,cause:c_(n)});const s=n;return e===400?new yk(e,s,r,i):e===401?new vk(e,s,r,i):e===403?new Ek(e,s,r,i):e===404?new Tk(e,s,r,i):e===409?new wk(e,s,r,i):e===422?new Ik(e,s,r,i):e===429?new Sk(e,s,r,i):e>=500?new Ak(e,s,r,i):new an(e,s,r,i)}}class d_ extends an{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Zf extends an{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class _k extends Zf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class yk extends an{}class vk extends an{}class Ek extends an{}class Tk extends an{}class wk extends an{}class Ik extends an{}class Sk extends an{}class Ak extends an{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MK=/^[a-z][a-z0-9+.-]*:/i,VK=t=>MK.test(t);let h_=t=>(h_=Array.isArray,h_(t));const LK=h_;let UK=LK;const XS=UK;function FK(t){if(!t)return!0;for(const e in t)return!1;return!0}function OK(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const BK=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Kn(`${t} must be an integer`);if(e<0)throw new Kn(`${t} must be a positive integer`);return e},qK=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GK=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Do="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $K(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const HK=()=>{var t,e,n,r,i;const s=$K();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Do,"X-Stainless-OS":eA(Deno.build.os),"X-Stainless-Arch":ZS(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Do,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Do,"X-Stainless-OS":eA((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":ZS((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const o=zK();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Do,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Do,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function zK(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,o=r[3]||0;return{browser:e,version:`${i}.${s}.${o}`}}}return null}const ZS=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",eA=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let fd;const WK=()=>fd??(fd=HK());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KK(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Ck(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function JK(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Ck({start(){},async pull(n){const{done:r,value:i}=await e.next();r?n.close():n.enqueue(i)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function Rk(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function jK(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const r=t.getReader(),i=r.cancel();r.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const QK=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xk=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function _m(t,e,n){return xk(),new File(t,e??"unknown_file",n)}function YK(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const XK=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Pk=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",ZK=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Pk(t),e8=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function t8(t,e,n){if(xk(),t=await t,ZK(t))return t instanceof File?t:_m([await t.arrayBuffer()],t.name);if(e8(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),_m(await f_(i),e,n)}const r=await f_(t);if(e||(e=YK(t)),!(n!=null&&n.type)){const i=r.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof i=="string"&&(n=Object.assign(Object.assign({},n),{type:i}))}return _m(r,e,n)}async function f_(t){var e,n,r,i,s;let o=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)o.push(t);else if(Pk(t))o.push(t instanceof Blob?t:await t.arrayBuffer());else if(XK(t))try{for(var a=!0,l=rr(t),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const d=i;o.push(...await f_(d))}}catch(d){n={error:d}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}else{const d=(s=t==null?void 0:t.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof t}${d?`; constructor: ${d}`:""}${n8(t)}`)}return o}function n8(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Nk{constructor(e){this._client=e}}Nk._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bk(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const tA=Object.freeze(Object.create(null)),r8=(t=bk)=>function(n,...r){if(n.length===1)return n[0];let i=!1;const s=[],o=n.reduce((d,p,m)=>{var _,E,C;/[?#]/.test(p)&&(i=!0);const A=r[m];let w=(i?encodeURIComponent:t)(""+A);return m!==r.length&&(A==null||typeof A=="object"&&A.toString===((C=Object.getPrototypeOf((E=Object.getPrototypeOf((_=A.hasOwnProperty)!==null&&_!==void 0?_:tA))!==null&&E!==void 0?E:tA))===null||C===void 0?void 0:C.toString))&&(w=A+"",s.push({start:d.length+p.length,length:w.length,error:`Value of type ${Object.prototype.toString.call(A).slice(8,-1)} is not a valid path parameter`})),d+p+(m===r.length?"":w)},""),a=o.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=l.exec(a))!==null;)s.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(s.sort((d,p)=>d.start-p.start),s.length>0){let d=0;const p=s.reduce((m,_)=>{const E=" ".repeat(_.start-d),C="^".repeat(_.length);return d=_.start+_.length,m+E+C},"");throw new Kn(`Path parameters result in path with invalid segments:
${s.map(m=>m.error).join(`
`)}
${o}
${p}`)}return o},pd=r8(bk);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kk extends Nk{create(e,n){var r;const{api_version:i=this._client.apiVersion}=e,s=Bh(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new Kn("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new Kn("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(pd`/${i}/interactions`,Object.assign(Object.assign({body:s},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){const{api_version:i=this._client.apiVersion}=n??{};return this._client.delete(pd`/${i}/interactions/${e}`,r)}cancel(e,n={},r){const{api_version:i=this._client.apiVersion}=n??{};return this._client.post(pd`/${i}/interactions/${e}/cancel`,r)}get(e,n={},r){var i;const s=n??{},{api_version:o=this._client.apiVersion}=s,a=Bh(s,["api_version"]);return this._client.get(pd`/${o}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(i=n==null?void 0:n.stream)!==null&&i!==void 0?i:!1}))}}kk._key=Object.freeze(["interactions"]);class Dk extends kk{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i8(t){let e=0;for(const i of t)e+=i.length;const n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}let md;function sE(t){let e;return(md??(e=new globalThis.TextEncoder,md=e.encode.bind(e)))(t)}let gd;function nA(t){let e;return(gd??(e=new globalThis.TextDecoder,gd=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ep{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?sE(e):e;this.buffer=i8([this.buffer,n]);const r=[];let i;for(;(i=s8(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){r.push(nA(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,o=nA(this.buffer.subarray(0,s));r.push(o),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}ep.NEWLINE_CHARS=new Set([`
`,"\r"]);ep.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function s8(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function o8(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qh={off:0,error:200,warn:300,info:400,debug:500},rA=(t,e,n)=>{if(t){if(OK(qh,t))return t;Yt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(qh))}`)}};function zl(){}function _d(t,e,n){return!e||qh[t]>qh[n]?zl:e[t].bind(e)}const a8={error:zl,warn:zl,info:zl,debug:zl};let iA=new WeakMap;function Yt(t){var e;const n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return a8;const i=iA.get(n);if(i&&i[0]===r)return i[1];const s={error:_d("error",n,r),warn:_d("warn",n,r),info:_d("info",n,r),debug:_d("debug",n,r)};return iA.set(n,[r,s]),s}const Ts=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Jo{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let i=!1;const s=r?Yt(r):console;function o(){return nr(this,arguments,function*(){var l,u,d,p;if(i)throw new Kn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let m=!1;try{try{for(var _=!0,E=rr(l8(e,n)),C;C=yield ae(E.next()),l=C.done,!l;_=!0){p=C.value,_=!1;const A=p;if(!m)if(A.data.startsWith("[DONE]")){m=!0;continue}else try{yield yield ae(JSON.parse(A.data))}catch(w){throw s.error("Could not parse message into JSON:",A.data),s.error("From chunk:",A.raw),w}}}catch(A){u={error:A}}finally{try{!_&&!l&&(d=E.return)&&(yield ae(d.call(E)))}finally{if(u)throw u.error}}m=!0}catch(A){if(u_(A))return yield ae(void 0);throw A}finally{m||n.abort()}})}return new Jo(o,n,r)}static fromReadableStream(e,n,r){let i=!1;function s(){return nr(this,arguments,function*(){var l,u,d,p;const m=new ep,_=Rk(e);try{for(var E=!0,C=rr(_),A;A=yield ae(C.next()),l=A.done,!l;E=!0){p=A.value,E=!1;const w=p;for(const T of m.decode(w))yield yield ae(T)}}catch(w){u={error:w}}finally{try{!E&&!l&&(d=C.return)&&(yield ae(d.call(C)))}finally{if(u)throw u.error}}for(const w of m.flush())yield yield ae(w)})}function o(){return nr(this,arguments,function*(){var l,u,d,p;if(i)throw new Kn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let m=!1;try{try{for(var _=!0,E=rr(s()),C;C=yield ae(E.next()),l=C.done,!l;_=!0){p=C.value,_=!1;const A=p;m||A&&(yield yield ae(JSON.parse(A)))}}catch(A){u={error:A}}finally{try{!_&&!l&&(d=E.return)&&(yield ae(d.call(E)))}finally{if(u)throw u.error}}m=!0}catch(A){if(u_(A))return yield ae(void 0);throw A}finally{m||n.abort()}})}return new Jo(o,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),i=s=>({next:()=>{if(s.length===0){const o=r.next();e.push(o),n.push(o)}return s.shift()}});return[new Jo(()=>i(e),this.controller,this.client),new Jo(()=>i(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return Ck({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:i,done:s}=await n.next();if(s)return r.close();const o=sE(JSON.stringify(i)+`
`);r.enqueue(o)}catch(i){r.error(i)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}}function l8(t,e){return nr(this,arguments,function*(){var r,i,s,o;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Kn("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Kn("Attempted to iterate over a response with no body");const a=new c8,l=new ep,u=Rk(t.body);try{for(var d=!0,p=rr(u8(u)),m;m=yield ae(p.next()),r=m.done,!r;d=!0){o=m.value,d=!1;const _=o;for(const E of l.decode(_)){const C=a.decode(E);C&&(yield yield ae(C))}}}catch(_){i={error:_}}finally{try{!d&&!r&&(s=p.return)&&(yield ae(s.call(p)))}finally{if(i)throw i.error}}for(const _ of l.flush()){const E=a.decode(_);E&&(yield yield ae(E))}})}function u8(t){return nr(this,arguments,function*(){var n,r,i,s;let o=new Uint8Array;try{for(var a=!0,l=rr(t),u;u=yield ae(l.next()),n=u.done,!n;a=!0){s=u.value,a=!1;const d=s;if(d==null)continue;const p=d instanceof ArrayBuffer?new Uint8Array(d):typeof d=="string"?sE(d):d;let m=new Uint8Array(o.length+p.length);m.set(o),m.set(p,o.length),o=m;let _;for(;(_=o8(o))!==-1;)yield yield ae(o.slice(0,_)),o=o.slice(_)}}catch(d){r={error:d}}finally{try{!a&&!n&&(i=l.return)&&(yield ae(i.call(l)))}finally{if(r)throw r.error}}o.length>0&&(yield yield ae(o))})}class c8{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=d8(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function d8(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function h8(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:i,startTime:s}=e,o=await(async()=>{var a;if(e.options.stream)return Yt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Jo.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const l=n.headers.get("content-type"),u=(a=l==null?void 0:l.split(";")[0])===null||a===void 0?void 0:a.trim();return(u==null?void 0:u.includes("application/json"))||(u==null?void 0:u.endsWith("+json"))?await n.json():await n.text()})();return Yt(t).debug(`[${r}] response parsed`,Ts({retryOfRequestLogID:i,url:n.url,status:n.status,body:o,durationMs:Date.now()-s})),o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oE extends Promise{constructor(e,n,r=h8){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new oE(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Mk=Symbol("brand.privateNullableHeaders");function*f8(t){if(!t)return;if(Mk in t){const{values:r,nulls:i}=t;yield*r.entries();for(const s of i)yield[s,null];return}let e=!1,n;t instanceof Headers?n=t.entries():XS(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const i=r[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const s=XS(r[1])?r[1]:[r[1]];let o=!1;for(const a of s)a!==void 0&&(e&&!o&&(o=!0,yield[i,null]),yield[i,a])}}const Dl=t=>{const e=new Headers,n=new Set;for(const r of t){const i=new Set;for(const[s,o]of f8(r)){const a=s.toLowerCase();i.has(a)||(e.delete(s),i.add(a)),o===null?(e.delete(s),n.add(a)):(e.append(s,o),n.delete(a))}}return{[Mk]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ym=t=>{var e,n,r,i,s,o;if(typeof globalThis.process<"u")return(r=(n=(e=Oz)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(o=(s=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||s===void 0?void 0:s.call(i,t))===null||o===void 0?void 0:o.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Vk;class tp{constructor(e){var n,r,i,s,o,a,l,{baseURL:u=ym("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:d=(n=ym("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:p="v1beta"}=e,m=Bh(e,["baseURL","apiKey","apiVersion"]);const _=Object.assign(Object.assign({apiKey:d,apiVersion:p},m),{baseURL:u||"https://generativelanguage.googleapis.com"});this.baseURL=_.baseURL,this.timeout=(r=_.timeout)!==null&&r!==void 0?r:tp.DEFAULT_TIMEOUT,this.logger=(i=_.logger)!==null&&i!==void 0?i:console;const E="warn";this.logLevel=E,this.logLevel=(o=(s=rA(_.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:rA(ym("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&o!==void 0?o:E,this.fetchOptions=_.fetchOptions,this.maxRetries=(a=_.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(l=_.fetch)!==null&&l!==void 0?l:KK(),this.encoder=QK,this._options=_,this.apiKey=d,this.apiVersion=p,this.clientAdapter=_.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=Dl([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Dl([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Dl([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Kn(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Do}`}defaultIdempotencyKey(){return`stainless-node-retry-${DK()}`}makeStatusError(e,n,r,i){return an.generate(e,n,r,i)}buildURL(e,n,r){const i=!this.baseURLOverridden()&&r||this.baseURL,s=VK(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return FK(o)||(n=Object.assign(Object.assign({},o),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(s.search=this.stringifyQuery(n)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(i=>Object.assign({method:e,path:n},i)))}request(e,n=null){return new oE(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var i,s,o;const a=await e,l=(i=a.maxRetries)!==null&&i!==void 0?i:this.maxRetries;n==null&&(n=l),await this.prepareOptions(a);const{req:u,url:d,timeout:p}=await this.buildRequest(a,{retryCount:l-n});await this.prepareRequest(u,{url:d,options:a});const m="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),_=r===void 0?"":`, retryOf: ${r}`,E=Date.now();if(Yt(this).debug(`[${m}] sending request`,Ts({retryOfRequestLogID:r,method:a.method,url:d,options:a,headers:u.headers})),!((s=a.signal)===null||s===void 0)&&s.aborted)throw new d_;const C=new AbortController,A=await this.fetchWithTimeout(d,u,p,C).catch(c_),w=Date.now();if(A instanceof globalThis.Error){const S=`retrying, ${n} attempts remaining`;if(!((o=a.signal)===null||o===void 0)&&o.aborted)throw new d_;const D=u_(A)||/timed? ?out/i.test(String(A)+("cause"in A?String(A.cause):""));if(n)return Yt(this).info(`[${m}] connection ${D?"timed out":"failed"} - ${S}`),Yt(this).debug(`[${m}] connection ${D?"timed out":"failed"} (${S})`,Ts({retryOfRequestLogID:r,url:d,durationMs:w-E,message:A.message})),this.retryRequest(a,n,r??m);throw Yt(this).info(`[${m}] connection ${D?"timed out":"failed"} - error; no more retries left`),Yt(this).debug(`[${m}] connection ${D?"timed out":"failed"} (error; no more retries left)`,Ts({retryOfRequestLogID:r,url:d,durationMs:w-E,message:A.message})),D?new _k:new Zf({cause:A})}const T=`[${m}${_}] ${u.method} ${d} ${A.ok?"succeeded":"failed"} with status ${A.status} in ${w-E}ms`;if(!A.ok){const S=await this.shouldRetry(A);if(n&&S){const P=`retrying, ${n} attempts remaining`;return await jK(A.body),Yt(this).info(`${T} - ${P}`),Yt(this).debug(`[${m}] response error (${P})`,Ts({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,durationMs:w-E})),this.retryRequest(a,n,r??m,A.headers)}const D=S?"error; no more retries left":"error; not retryable";Yt(this).info(`${T} - ${D}`);const L=await A.text().catch(P=>c_(P).message),M=qK(L),R=M?void 0:L;throw Yt(this).debug(`[${m}] response error (${D})`,Ts({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,message:R,durationMs:Date.now()-E})),this.makeStatusError(A.status,M,R,A.headers)}return Yt(this).info(T),Yt(this).debug(`[${m}] response start`,Ts({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,durationMs:w-E})),{response:A,options:a,controller:C,requestLogID:m,retryOfRequestLogID:r,startTime:E}}async fetchWithTimeout(e,n,r,i){const s=n||{},{signal:o,method:a}=s,l=Bh(s,["signal","method"]);o&&o.addEventListener("abort",()=>i.abort());const u=setTimeout(()=>i.abort(),r),d=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,p=Object.assign(Object.assign(Object.assign({signal:i.signal},d?{duplex:"half"}:{}),{method:"GET"}),l);a&&(p.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,p)}finally{clearTimeout(u)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,i){var s;let o;const a=i==null?void 0:i.get("retry-after-ms");if(a){const u=parseFloat(a);Number.isNaN(u)||(o=u)}const l=i==null?void 0:i.get("retry-after");if(l&&!o){const u=parseFloat(l);Number.isNaN(u)?o=Date.parse(l)-Date.now():o=u*1e3}if(!(o&&0<=o&&o<60*1e3)){const u=(s=e.maxRetries)!==null&&s!==void 0?s:this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,u)}return await GK(o),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,o=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return o*a*1e3}async buildRequest(e,{retryCount:n=0}={}){var r,i,s;const o=Object.assign({},e),{method:a,path:l,query:u,defaultBaseURL:d}=o,p=this.buildURL(l,u,d);"timeout"in o&&BK("timeout",o.timeout),o.timeout=(r=o.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:m,body:_}=this.buildBody({options:o}),E=await this.buildHeaders({options:e,method:a,bodyHeaders:m,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:E},o.signal&&{signal:o.signal}),globalThis.ReadableStream&&_ instanceof globalThis.ReadableStream&&{duplex:"half"}),_&&{body:_}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(s=o.fetchOptions)!==null&&s!==void 0?s:{}),url:p,timeout:o.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:i}){let s={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const o=await this.authHeaders(e);let a=Dl([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),WK()),this._options.defaultHeaders,r,e.headers,o]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=Dl([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:JK(e)}:this.encoder({body:e,headers:r})}}tp.DEFAULT_TIMEOUT=6e4;class St extends tp{constructor(){super(...arguments),this.interactions=new Dk(this)}}Vk=St;St.GeminiNextGenAPIClient=Vk;St.GeminiNextGenAPIClientError=Kn;St.APIError=an;St.APIConnectionError=Zf;St.APIConnectionTimeoutError=_k;St.APIUserAbortError=d_;St.NotFoundError=Tk;St.ConflictError=wk;St.RateLimitError=Sk;St.BadRequestError=yk;St.AuthenticationError=vk;St.InternalServerError=Ak;St.PermissionDeniedError=Ek;St.UnprocessableEntityError=Ik;St.toFile=t8;St.Interactions=Dk;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function p8(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function m8(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function g8(t,e){const n={},r=c(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function _8(t,e){const n={},r=c(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function y8(t,e,n){const r={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=c(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&f(e,["displayName"],i),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=c(t,["epochCount"]);e!==void 0&&s!=null&&f(e,["tuningTask","hyperparameters","epochCount"],s);const o=c(t,["learningRateMultiplier"]);if(o!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=c(t,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const l=c(t,["learningRate"]);if(e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","learningRate"],l),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(c(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function v8(t,e,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const _=c(t,["validationDataset"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec"],sA(_))}else if(i==="PREFERENCE_TUNING"){const _=c(t,["validationDataset"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec"],sA(_))}const s=c(t,["tunedModelDisplayName"]);e!==void 0&&s!=null&&f(e,["tunedModelDisplayName"],s);const o=c(t,["description"]);e!==void 0&&o!=null&&f(e,["description"],o);let a=c(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const _=c(t,["epochCount"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],_)}else if(a==="PREFERENCE_TUNING"){const _=c(t,["epochCount"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],_)}let l=c(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const _=c(t,["learningRateMultiplier"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],_)}else if(l==="PREFERENCE_TUNING"){const _=c(t,["learningRateMultiplier"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],_)}let u=c(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const _=c(t,["exportLastCheckpointOnly"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],_)}else if(u==="PREFERENCE_TUNING"){const _=c(t,["exportLastCheckpointOnly"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],_)}let d=c(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const _=c(t,["adapterSize"]);e!==void 0&&_!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],_)}else if(d==="PREFERENCE_TUNING"){const _=c(t,["adapterSize"]);e!==void 0&&_!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],_)}if(c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const p=c(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=c(t,["beta"]);return e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],m),r}function E8(t,e){const n={},r=c(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=c(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=c(t,["trainingDataset"]);s!=null&&b8(s);const o=c(t,["config"]);return o!=null&&y8(o,n),n}function T8(t,e){const n={},r=c(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const i=c(t,["preTunedModel"]);i!=null&&f(n,["preTunedModel"],i);const s=c(t,["trainingDataset"]);s!=null&&k8(s,n,e);const o=c(t,["config"]);return o!=null&&v8(o,n,e),n}function w8(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function I8(t,e){const n={},r=c(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function S8(t,e,n){const r={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=c(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=c(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function A8(t,e,n){const r={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=c(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=c(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),r}function C8(t,e){const n={},r=c(t,["config"]);return r!=null&&S8(r,n),n}function R8(t,e){const n={},r=c(t,["config"]);return r!=null&&A8(r,n),n}function x8(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=c(t,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Lk(a))),f(n,["tuningJobs"],o)}return n}function P8(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(t,["nextPageToken"]);i!=null&&f(n,["nextPageToken"],i);const s=c(t,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>p_(a))),f(n,["tuningJobs"],o)}return n}function N8(t,e){const n={},r=c(t,["name"]);r!=null&&f(n,["model"],r);const i=c(t,["name"]);return i!=null&&f(n,["endpoint"],i),n}function b8(t,e){const n={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=c(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),f(n,["examples","examples"],i)}return n}function k8(t,e,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=c(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=c(t,["gcsUri"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=c(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=c(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=c(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Lk(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&f(n,["name"],i);const s=c(t,["state"]);s!=null&&f(n,["state"],Xb(s));const o=c(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=c(t,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const l=c(t,["tuningTask","completeTime"]);l!=null&&f(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const d=c(t,["description"]);d!=null&&f(n,["description"],d);const p=c(t,["baseModel"]);p!=null&&f(n,["baseModel"],p);const m=c(t,["_self"]);return m!=null&&f(n,["tunedModel"],N8(m)),n}function p_(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&f(n,["name"],i);const s=c(t,["state"]);s!=null&&f(n,["state"],Xb(s));const o=c(t,["createTime"]);o!=null&&f(n,["createTime"],o);const a=c(t,["startTime"]);a!=null&&f(n,["startTime"],a);const l=c(t,["endTime"]);l!=null&&f(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&f(n,["updateTime"],u);const d=c(t,["error"]);d!=null&&f(n,["error"],d);const p=c(t,["description"]);p!=null&&f(n,["description"],p);const m=c(t,["baseModel"]);m!=null&&f(n,["baseModel"],m);const _=c(t,["tunedModel"]);_!=null&&f(n,["tunedModel"],_);const E=c(t,["preTunedModel"]);E!=null&&f(n,["preTunedModel"],E);const C=c(t,["supervisedTuningSpec"]);C!=null&&f(n,["supervisedTuningSpec"],C);const A=c(t,["preferenceOptimizationSpec"]);A!=null&&f(n,["preferenceOptimizationSpec"],A);const w=c(t,["tuningDataStats"]);w!=null&&f(n,["tuningDataStats"],w);const T=c(t,["encryptionSpec"]);T!=null&&f(n,["encryptionSpec"],T);const S=c(t,["partnerModelTuningSpec"]);S!=null&&f(n,["partnerModelTuningSpec"],S);const D=c(t,["customBaseModel"]);D!=null&&f(n,["customBaseModel"],D);const L=c(t,["experiment"]);L!=null&&f(n,["experiment"],L);const M=c(t,["labels"]);M!=null&&f(n,["labels"],M);const R=c(t,["outputUri"]);R!=null&&f(n,["outputUri"],R);const I=c(t,["pipelineJob"]);I!=null&&f(n,["pipelineJob"],I);const P=c(t,["serviceAccount"]);P!=null&&f(n,["serviceAccount"],P);const N=c(t,["tunedModelDisplayName"]);N!=null&&f(n,["tunedModelDisplayName"],N);const k=c(t,["veoTuningSpec"]);return k!=null&&f(n,["veoTuningSpec"],k),n}function D8(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&f(n,["name"],i);const s=c(t,["metadata"]);s!=null&&f(n,["metadata"],s);const o=c(t,["done"]);o!=null&&f(n,["done"],o);const a=c(t,["error"]);return a!=null&&f(n,["error"],a),n}function sA(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return i!=null&&f(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M8 extends li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mo(Xr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),s=await this.tuneMldevInternal(i);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:n_.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=I8(e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>p_(d))}else{const u=w8(e);return a=Y("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>Lk(d))}}async listInternal(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=R8(e);return a=Y("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=P8(d),m=new bS;return Object.assign(m,p),m})}else{const u=C8(e);return a=Y("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=x8(d),m=new bS;return Object.assign(m,p),m})}}async cancel(e){var n,r,i,s;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=m8(e);return a=Y("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=_8(d),m=new kS;return Object.assign(m,p),m})}else{const u=p8(e);return a=Y("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),o.then(d=>{const p=g8(d),m=new kS;return Object.assign(m,p),m})}}async tuneInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const a=T8(e,e);return s=Y("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>p_(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=E8(e);return s=Y("tunedModels",a._url),o=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>D8(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class V8{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const L8=1024*1024*8,U8=3,F8=1e3,O8=2,Gh="x-goog-upload-status";async function B8(t,e,n){var r;const i=await Uk(t,e,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Gh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function q8(t,e,n){var r;const i=await Uk(t,e,n),s=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Gh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=Wb(s),a=new Zv;return Object.assign(a,o),a}async function Uk(t,e,n){var r,i;let s=0,o=0,a=new r_(new Response),l="upload";for(s=t.size;o<s;){const u=Math.min(L8,s-o),d=t.slice(o,o+u);o+u>=s&&(l+=", finalize");let p=0,m=F8;for(;p<U8&&(a=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[Gh]));)p++,await $8(m),m=m*O8;if(o+=u,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[Gh])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function G8(t){return{size:t.size,type:t.type}}function $8(t){return new Promise(e=>setTimeout(e,t))}class H8{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await B8(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await q8(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await G8(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class z8{create(e,n,r){return new W8(e,n,r)}}class W8{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oA="x-goog-api-key";class K8{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(oA)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(oA,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const J8="gl-node/";class j8{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new St({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=$z(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new K8(this.apiKey);this.apiClient=new GW({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:J8+"web",uploader:new H8,downloader:new V8}),this.models=new aK(this.apiClient),this.live=new tK(this.apiClient,i,new z8),this.batches=new y3(this.apiClient),this.chats=new Z3(this.models,this.apiClient),this.caches=new Q3(this.apiClient),this.files=new u5(this.apiClient),this.operations=new lK(this.apiClient),this.authTokens=new SK(this.apiClient),this.tunings=new M8(this.apiClient),this.fileSearchStores=new kK(this.apiClient)}}const np=new j8({apiKey:"AIzaSyAxV1d2uVD629tjT8mT9fX7h6rKVctg0I0"}),Q8=async(t,e,n)=>{var a,l;let r="gemini-3-pro-preview",i={},s;n==="thinking"?(r="gemini-3-pro-preview",i={thinkingConfig:{thinkingBudget:32768}}):n==="search"?(r="gemini-3-flash-preview",s=[{googleSearch:{}}]):r="gemini-3-pro-preview";const o=[...t,{role:"user",parts:[{text:e}]}];try{const u=await np.models.generateContent({model:r,contents:o,config:{...i,tools:s}});return{text:u.text,groundingMetadata:(l=(a=u.candidates)==null?void 0:a[0])==null?void 0:l.groundingMetadata}}catch(u){return console.error("AI Error:",u),{text:"I encountered an error processing your request. Please try again."}}},Y8=async(t,e)=>{try{return(await np.models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{data:t,mimeType:e}},{text:"Transcribe the audio exactly as spoken."}]}})).text||""}catch(n){return console.error("Transcription Error:",n),"Failed to transcribe audio."}},X8=async(t,e,n)=>{try{const r={},i=["comment"];n.forEach(o=>{r[o.id]={type:Zn.INTEGER,description:`Score (1-5) for ${o.name}`},i.push(o.id)});const s=await np.models.generateContent({model:"gemini-3-pro-preview",contents:`You are a strict technical innovation manager evaluating a proposal.
      
      Proposal Title: "${t}"
      Proposal Description: "${e}"
      
      Evaluate this proposal based on the following dimensions (1 = Poor, 5 = Excellent):
      ${n.map(o=>`- ${o.name} (ID: ${o.id}): ${o.description}`).join(`
`)}
      
      Provide an integer score (1-5) for each dimension ID and a constructive summary comment justifying the scores.`,config:{responseMimeType:"application/json",responseSchema:{type:Zn.OBJECT,properties:{comment:{type:Zn.STRING,description:"A professional justification of the scores."},...r},required:i}}});if(s.text){const o=JSON.parse(s.text),a=o.comment,l={};return n.forEach(u=>{o[u.id]&&(l[u.id]=o[u.id])}),{scores:l,comment:a}}return null}catch(r){return console.error("Evaluation Error:",r),null}},Z8=async t=>{try{return(await np.models.generateContent({model:"gemini-3-flash-preview",contents:`Rewrite the following innovation description to be more professional, persuasive, and concise for a corporate environment. Keep the technical details accurate but improve the flow and impact:

${t}`})).text||t}catch(e){return console.error("Enhancement Error:",e),t}},Zi=({children:t,color:e="blue",className:n=""})=>{const r={blue:"bg-blue-100 text-blue-800 border border-blue-200",green:"bg-emerald-100 text-emerald-800 border border-emerald-200",yellow:"bg-yellow-100 text-yellow-800 border border-yellow-200",red:"bg-red-100 text-red-800 border border-red-200",gray:"bg-slate-100 text-slate-700 border border-slate-200",amber:"bg-amber-100 text-amber-800 border border-amber-200"};return y.jsx("span",{className:`px-2.5 py-0.5 rounded-sm text-[10px] uppercase tracking-wider font-bold ${r[e]||r.gray} ${n}`,children:t})},xe=({children:t,variant:e="primary",onClick:n,type:r="button",className:i="",disabled:s=!1})=>{const o="px-5 py-2.5 rounded font-semibold transition-all duration-200 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed text-sm tracking-wide uppercase shadow-sm",a={primary:"bg-eprom-blue text-white hover:bg-blue-700 border border-blue-700 hover:shadow-md",secondary:"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50 hover:border-slate-400 hover:text-slate-900",danger:"bg-white text-red-600 border border-red-200 hover:bg-red-50 hover:border-red-300",ghost:"bg-transparent text-slate-500 hover:text-eprom-blue hover:bg-slate-100 shadow-none"};return y.jsx("button",{type:r,onClick:n,disabled:s,className:`${o} ${a[e]} ${i}`,children:t})},In=({label:t,...e})=>y.jsxs("div",{className:"mb-5",children:[t&&y.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1.5 uppercase tracking-wide",children:t}),y.jsx("input",{...e,className:"w-full px-4 py-2.5 bg-white border border-slate-300 rounded text-slate-900 placeholder-slate-400 focus:outline-none focus:border-eprom-blue focus:ring-1 focus:ring-eprom-blue transition-all input-base"})]}),Fk=({label:t,...e})=>y.jsxs("div",{className:"mb-5",children:[t&&y.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1.5 uppercase tracking-wide",children:t}),y.jsx("textarea",{...e,className:"w-full px-4 py-2.5 bg-white border border-slate-300 rounded text-slate-900 placeholder-slate-400 focus:outline-none focus:border-eprom-blue focus:ring-1 focus:ring-eprom-blue transition-all input-base"})]}),$h=({label:t,options:e,...n})=>y.jsxs("div",{className:"mb-5",children:[t&&y.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1.5 uppercase tracking-wide",children:t}),y.jsxs("select",{...n,className:"w-full px-4 py-2.5 bg-white border border-slate-300 rounded text-slate-900 focus:outline-none focus:border-eprom-blue focus:ring-1 focus:ring-eprom-blue transition-all appearance-none input-base",children:[y.jsx("option",{value:"",className:"text-slate-500",children:"Select an option"}),e.map(r=>y.jsx("option",{value:r,children:r},r))]})]}),ft=({children:t,className:e="",onClick:n})=>y.jsx("div",{onClick:n,className:`bg-white rounded-lg border border-slate-200 shadow-[0_2px_8px_rgba(0,0,0,0.04)] hover:shadow-[0_8px_16px_rgba(0,0,0,0.06)] transition-shadow duration-300 ${e}`,children:t}),Ok=O.createContext(null),ds=()=>{const t=O.useContext(Ok);if(!t)throw new Error("useAppContext must be used within AppProvider");return t},eJ=()=>{const[t,e]=O.useState(!1),n=O.useRef(null),r=O.useRef([]);return{isRecording:t,startRecording:async()=>{try{const o=await navigator.mediaDevices.getUserMedia({audio:!0});n.current=new MediaRecorder(o),r.current=[],n.current.ondataavailable=a=>{r.current.push(a.data)},n.current.start(),e(!0)}catch(o){console.error("Error accessing microphone:",o),alert("Could not access microphone. Please ensure permissions are granted.")}},stopRecording:()=>new Promise(o=>{if(!n.current){o(null);return}n.current.onstop=async()=>{const a=new Blob(r.current,{type:"audio/webm"}),l=new FileReader;l.readAsDataURL(a),l.onloadend=()=>{var p;const d=l.result.split(",")[1];(p=n.current)==null||p.stream.getTracks().forEach(m=>m.stop()),o({base64:d,mimeType:"audio/webm"})}},n.current.stop(),e(!1)})}},tJ=()=>{const{user:t,logout:e,settings:n}=ds(),r=or(),[i,s]=O.useState(""),o=l=>{l.key==="Enter"&&(r(`/search?q=${encodeURIComponent(i)}`),s(""))},a=n==null?void 0:n.logoUrl;return y.jsx("nav",{className:"fixed top-0 w-full z-50 glass-panel border-b border-white/20",children:y.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:y.jsxs("div",{className:"flex justify-between h-16",children:[y.jsxs("div",{className:"flex items-center cursor-pointer group",onClick:()=>r("/"),children:[a?y.jsx("img",{src:a,alt:"EPROM",className:"h-10 w-auto object-contain mr-4 transition-transform duration-300 group-hover:scale-105"}):y.jsx("div",{className:"h-9 w-9 bg-slate-900 rounded-lg flex items-center justify-center font-bold text-white mr-3 shadow-lg shadow-slate-900/20 group-hover:scale-105 transition-transform",children:"E"}),y.jsx("span",{className:"font-bold text-lg tracking-tight text-slate-900 group-hover:text-eprom-accent transition-colors",children:!a&&y.jsxs("span",{children:["EPROM ",y.jsx("span",{className:"text-slate-400 font-light",children:"HUB"})]})})]}),y.jsx("div",{className:"flex-1 max-w-md px-8 flex items-center",children:y.jsxs("div",{className:"relative w-full group",children:[y.jsx("input",{type:"text",placeholder:"Search innovation registry...",className:"w-full bg-slate-100/50 border border-slate-200 rounded-full py-2 px-5 text-sm text-slate-800 focus:ring-2 focus:ring-slate-900 focus:bg-white transition-all placeholder-slate-400",value:i,onChange:l=>s(l.target.value),onKeyDown:o}),y.jsx("div",{className:"absolute right-4 top-2.5 text-slate-400 group-focus-within:text-slate-900 transition-colors",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),y.jsx("div",{className:"flex items-center space-x-6",children:t?y.jsxs(y.Fragment,{children:[t.role!==we.ADMIN&&y.jsxs(y.Fragment,{children:[y.jsx(wi,{to:"/dashboard",className:"text-slate-500 hover:text-slate-900 transition-colors text-xs font-bold uppercase tracking-widest",children:"Dashboard"}),y.jsx(wi,{to:"/collaboration",className:"text-slate-500 hover:text-slate-900 transition-colors text-xs font-bold uppercase tracking-widest",children:"Collab"})]}),t.role===we.EMPLOYEE&&y.jsx(wi,{to:"/submit",className:"bg-slate-900 hover:bg-slate-800 text-white px-5 py-2 rounded text-xs font-bold uppercase tracking-wide transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Submit Idea"}),t.role===we.ADMIN&&y.jsxs(wi,{to:"/admin",className:"text-slate-900 hover:text-red-600 transition-colors text-xs font-bold uppercase tracking-widest flex items-center gap-1",children:[y.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),"Control Room"]}),y.jsx("div",{className:"h-6 w-[1px] bg-slate-200 mx-2"}),y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("div",{className:"text-right hidden md:block leading-tight",children:[y.jsx("div",{className:"text-sm font-bold text-slate-900",children:t.username}),y.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider font-bold",children:t.role})]}),y.jsx(xe,{variant:"ghost",onClick:e,className:"text-xs uppercase font-bold text-slate-400 hover:text-red-500",children:"Logout"})]})]}):y.jsx(wi,{to:"/auth",className:"text-slate-900 hover:text-eprom-accent font-bold transition-colors uppercase text-sm tracking-wide",children:"Login"})})]})})})},nJ=()=>{const[t,e]=O.useState(!1),[n,r]=O.useState([]),[i,s]=O.useState(""),[o,a]=O.useState(!1),[l,u]=O.useState("standard"),d=O.useRef(null),p=()=>{var _;(_=d.current)==null||_.scrollIntoView({behavior:"smooth"})};O.useEffect(p,[n]);const m=async()=>{var w;if(!i.trim())return;const _=i;s(""),r(T=>[...T,{role:"user",text:_}]),a(!0);const E=n.map(T=>({role:T.role,parts:[{text:T.text}]})),C=await Q8(E,_,l);let A=C.text||"I'm having trouble thinking right now.";if((w=C.groundingMetadata)!=null&&w.groundingChunks){const T=C.groundingMetadata.groundingChunks.map(S=>{var D;return(D=S.web)!=null&&D.uri?`[${S.web.title||"Source"}](${S.web.uri})`:null}).filter(Boolean).join(", ");T&&(A+=`

Sources: ${T}`)}r(T=>[...T,{role:"model",text:A}]),a(!1)};return t?y.jsxs("div",{className:"fixed bottom-6 right-6 w-[380px] h-[600px] bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col z-50 overflow-hidden font-sans fade-in",children:[y.jsxs("div",{className:"bg-slate-900 p-4 flex justify-between items-center text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-2 h-2 rounded-full bg-eprom-accent animate-pulse"}),y.jsx("span",{className:"font-bold tracking-wide text-sm",children:"AI Assistant"})]}),y.jsx("button",{onClick:()=>e(!1),className:"text-slate-400 hover:text-white transition-colors",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50/50",children:[n.length===0&&y.jsxs("div",{className:"text-center text-slate-400 text-xs mt-10",children:[y.jsx("p",{className:"mb-2",children:"Hello! I'm Gemini."}),y.jsx("p",{children:"I can help you analyze ideas, refine descriptions, or search the web."})]}),n.map((_,E)=>y.jsx("div",{className:`flex ${_.role==="user"?"justify-end":"justify-start"}`,children:y.jsx("div",{className:`max-w-[85%] rounded-lg p-3 text-sm whitespace-pre-wrap ${_.role==="user"?"bg-slate-900 text-white shadow-md":"bg-white border border-slate-200 text-slate-800 shadow-sm"}`,children:_.text})},E)),o&&y.jsx("div",{className:"flex justify-start",children:y.jsxs("div",{className:"bg-white border border-slate-200 p-3 rounded-lg flex gap-1 shadow-sm",children:[y.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce"}),y.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce delay-100"}),y.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce delay-200"})]})}),y.jsx("div",{ref:d})]}),y.jsxs("div",{className:"p-3 bg-white border-t border-slate-200",children:[y.jsxs("div",{className:"flex gap-2 mb-2 overflow-x-auto pb-1 no-scrollbar",children:[y.jsx("button",{onClick:()=>u("standard"),className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border transition-colors ${l==="standard"?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:"Chat"}),y.jsxs("button",{onClick:()=>u("thinking"),className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border flex items-center gap-1 transition-colors ${l==="thinking"?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[y.jsx("span",{children:"Reasoning"}),y.jsx("span",{className:"text-[8px] opacity-70",children:"(Pro)"})]}),y.jsxs("button",{onClick:()=>u("search"),className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border flex items-center gap-1 transition-colors ${l==="search"?"bg-emerald-600 text-white border-emerald-600":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[y.jsx("span",{children:"Web"}),y.jsx("span",{className:"text-[8px] opacity-70",children:"(Flash)"})]})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{type:"text",value:i,onChange:_=>s(_.target.value),onKeyDown:_=>_.key==="Enter"&&m(),placeholder:l==="search"?"Search Google...":"Ask Gemini...",className:"flex-1 bg-slate-100 border-none rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-slate-900 focus:bg-white transition-all placeholder-slate-400"}),y.jsx("button",{onClick:m,disabled:o||!i.trim(),className:"p-2 bg-slate-900 text-white rounded-md disabled:opacity-50 hover:bg-slate-800 transition-colors shadow-sm",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})]}):y.jsx("button",{onClick:()=>e(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-slate-900 text-white rounded-full shadow-2xl flex items-center justify-center hover:scale-110 transition-transform z-50 group border border-slate-700",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 group-hover:animate-pulse text-eprom-accent",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})})},rJ=({children:t})=>{const[e,n]=O.useState(null),[r,i]=O.useState(null),[s,o]=O.useState(!0);O.useEffect(()=>{const d=Rz(p=>{n(p),o(!1)});return u(),()=>d()},[]);const a=async(d,p)=>{const m=await xz(d,p);return n(m),m.role},l=async()=>{await Nz(),n(null)},u=async()=>{const d=await Vz();i(d)};return s?y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 text-slate-400 uppercase font-bold text-sm tracking-widest animate-pulse",children:"Initializing System..."}):y.jsxs(Ok.Provider,{value:{user:e,settings:r,login:a,logout:l,refreshSettings:u,authLoading:s},children:[t,y.jsx(nJ,{})]})},iJ=()=>{const{id:t}=TV(),{user:e}=ds(),n=or(),[r,i]=O.useState(null),[s,o]=O.useState(null),[a,l]=O.useState(!0),[u,d]=O.useState({}),[p,m]=O.useState(""),[_,E]=O.useState(!1);if(O.useEffect(()=>{(async()=>{if(!t)return;l(!0);const I=(await Ma()).find(P=>P.id===t);if(I){i(I);const N=(await Qv()).find(k=>k.id===I.templateId);if(o(N||null),N!=null&&N.ratingConfig){const k={};N.ratingConfig.forEach(V=>k[V.id]=3),d(k)}}l(!1)})()},[t]),a)return y.jsx("div",{className:"text-center py-20 text-slate-400",children:"Loading Protocol Data..."});if(!r)return y.jsx("div",{className:"text-center py-20 text-slate-400",children:"Idea not found."});const C=(r==null?void 0:r.status)===oe.PUBLISHED;if(r&&!e&&!C)return y.jsx(PR,{to:"/auth"});const A=async()=>{if(!r||!(s!=null&&s.ratingConfig))return;E(!0);const M=await X8(r.title,r.description,s.ratingConfig);M?(d(M.scores),m(M.comment)):alert("AI Evaluation failed. Please try again."),E(!1)},w=()=>{if(!(s!=null&&s.ratingConfig))return 0;let M=0,R=0;return s.ratingConfig.forEach(I=>{const P=u[I.id]||0;M+=P*I.weight,R+=I.weight}),R>0?M/R:0},T=async M=>{if(!r)return;const R={...r,status:M};await e_(R),i(R),alert(`Status updated to: ${M}`)},S=async M=>{if(!r||!e||!s)return;const R=w(),I=R/5*100;let P="F";I>=90?P="A":I>=80?P="B":I>=70?P="C":I>=60&&(P="D");const N={managerId:e.id,managerName:e.username,details:Object.entries(u).map(([Te,Mt])=>({dimensionId:Te,score:Mt})),totalScore:Number(R.toFixed(1)),percentage:Math.round(I),grade:P,comment:p,createdAt:new Date().toISOString()};let k=r.status;M==="APPROVE"&&(k=oe.APPROVED),M==="REVISE"&&(k=oe.NEEDS_REVISION),M==="REJECT"&&(k=oe.REJECTED);const V=[...r.ratings||[],N],b={...r,status:k,ratings:V,managerFeedback:p};await e_(b),i(b),alert(`Protocol ${M}D`),n("/dashboard")},D=(e==null?void 0:e.role)===we.MANAGER||(e==null?void 0:e.role)===we.ADMIN,L=r.status===oe.SUBMITTED;return y.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-24 fade-in",children:[y.jsxs("div",{className:"flex justify-between items-start mb-8",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[y.jsx(Zi,{color:r.status===oe.PUBLISHED?"green":r.status===oe.APPROVED?"blue":r.status===oe.REJECTED?"red":r.status===oe.NEEDS_REVISION?"amber":"gray",children:r.status}),y.jsx("span",{className:"text-xs text-slate-500 font-bold uppercase tracking-wider",children:r.category})]}),y.jsx("h1",{className:"text-4xl font-bold text-slate-900 leading-tight mb-2",children:r.title}),y.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500 font-medium",children:[y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),r.authorName]}),y.jsx("span",{children:""}),y.jsx("span",{children:r.department}),y.jsx("span",{children:""}),y.jsx("span",{children:new Date(r.createdAt).toLocaleDateString()})]})]}),e?e.role!==we.ADMIN?y.jsx(xe,{variant:"ghost",onClick:()=>n(-1),className:"uppercase text-xs font-bold",children:"Back to Dashboard"}):y.jsx(xe,{variant:"ghost",onClick:()=>n("/admin"),className:"uppercase text-xs font-bold",children:"Return to Control Room"}):y.jsx(wi,{to:"/auth",children:y.jsx(xe,{variant:"primary",className:"text-xs uppercase",children:"Login"})})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[y.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[r.coverImage&&y.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg border border-slate-200",children:y.jsx("img",{src:r.coverImage,className:"w-full h-80 object-cover",alt:"Cover"})}),y.jsxs(ft,{className:"p-8 border-none shadow-md",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-100 pb-2",children:"Technical Detail"}),y.jsx("p",{className:"whitespace-pre-wrap text-slate-700 leading-relaxed text-lg",children:r.description})]}),y.jsxs(ft,{className:"p-8 border-none shadow-md",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-100 pb-2",children:"Operational Data"}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-6 gap-x-12",children:Object.entries(r.dynamicData).map(([M,R])=>y.jsxs("div",{children:[y.jsx("span",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:M}),y.jsx("span",{className:"font-medium text-slate-900",children:R.toString()})]},M))})]}),r.attachments&&r.attachments.length>0&&y.jsxs(ft,{className:"p-8 border-none shadow-md",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-100 pb-2",children:"Attachments"}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.attachments.map((M,R)=>y.jsxs("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 p-4 bg-slate-50 border border-slate-200 rounded-lg hover:border-blue-400 hover:shadow-md transition-all group cursor-pointer decoration-none",children:[y.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center text-blue-600 shadow-sm border border-slate-100",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),y.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[y.jsxs("p",{className:"text-sm font-bold text-slate-900 truncate group-hover:text-blue-600",children:["Attachment ",R+1]}),y.jsx("p",{className:"text-[10px] text-slate-500 font-medium uppercase tracking-wide",children:"View Document"})]}),y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-300 group-hover:text-blue-500 transform group-hover:translate-x-1 transition-all",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]},R))})]})]}),y.jsx("div",{className:"space-y-6",children:D&&L&&(s!=null&&s.ratingConfig)?y.jsxs(ft,{className:"p-6 border-l-4 border-l-indigo-600 shadow-xl bg-white sticky top-24",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsx("h3",{className:"text-lg font-bold text-slate-900 uppercase tracking-tight",children:"Evaluation Console"}),y.jsx("button",{onClick:A,disabled:_,className:"text-[10px] font-bold uppercase bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded hover:bg-indigo-100 transition-colors flex items-center gap-2",children:_?y.jsx("span",{className:"animate-spin",children:""}):y.jsx("span",{children:" AI Auto-Grade"})})]}),y.jsx("div",{className:"space-y-5 mb-8",children:s.ratingConfig.map(M=>y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-xs mb-1.5",children:[y.jsx("span",{className:"font-bold text-slate-700",children:M.name}),y.jsxs("span",{className:"font-mono text-slate-500",children:[u[M.id]||"-","/5"]})]}),y.jsx("input",{type:"range",min:"1",max:"5",value:u[M.id]||3,onChange:R=>d({...u,[M.id]:Number(R.target.value)}),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"}),y.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:M.description})]},M.id))}),y.jsxs("div",{className:"mb-6",children:[y.jsx("label",{className:"block text-xs font-bold text-slate-700 mb-2 uppercase",children:"Verdict / Feedback"}),y.jsx("textarea",{value:p,onChange:M=>m(M.target.value),className:"w-full p-3 bg-slate-50 border border-slate-200 rounded text-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 h-32",placeholder:"Provide constructive feedback..."})]}),y.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[y.jsx(xe,{onClick:()=>S("APPROVE"),className:"w-full bg-emerald-600 hover:bg-emerald-700 border-emerald-600 text-white",children:"Approve (Internal)"}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx(xe,{onClick:()=>S("REVISE"),variant:"secondary",className:"text-xs",children:"Request Revision"}),y.jsx(xe,{onClick:()=>S("REJECT"),variant:"danger",className:"text-xs",children:"Reject"})]})]})]}):y.jsxs(ft,{className:"p-6 border-none shadow-md bg-slate-50 sticky top-24",children:[y.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:"Protocol Status"}),y.jsxs("div",{className:"mb-6",children:[y.jsx("div",{className:`text-xl font-bold mb-1 ${r.status===oe.PUBLISHED?"text-green-600":r.status===oe.APPROVED?"text-blue-600":r.status===oe.REJECTED?"text-red-600":r.status===oe.NEEDS_REVISION?"text-amber-600":"text-slate-600"}`,children:r.status.replace("_"," ")}),y.jsxs("div",{className:"text-xs text-slate-500",children:["Last updated ",new Date(r.updatedAt).toLocaleDateString()]})]}),D&&(r.status===oe.APPROVED||r.status===oe.PUBLISHED)&&y.jsxs("div",{className:"p-4 bg-white border border-slate-200 rounded mb-6",children:[y.jsx("h4",{className:"text-xs font-bold text-slate-900 uppercase tracking-wide mb-3",children:"Publishing Controls"}),r.status===oe.APPROVED&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Protocol is approved internally. Publish to make it live?"}),y.jsx(xe,{onClick:()=>T(oe.PUBLISHED),className:"w-full bg-slate-900 text-white",children:"Publish Live"}),y.jsx(xe,{onClick:()=>T(oe.NEEDS_REVISION),variant:"secondary",className:"w-full text-xs",children:"Return for Revision"})]}),r.status===oe.PUBLISHED&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Protocol is live. Unpublish?"}),y.jsx(xe,{onClick:()=>T(oe.APPROVED),variant:"secondary",className:"w-full",children:"Unpublish"})]})]}),r.ratings&&r.ratings.length>0&&y.jsxs("div",{className:"space-y-4 mb-6",children:[y.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Evaluation History"}),r.ratings.slice().reverse().map((M,R)=>y.jsxs("div",{className:"p-4 bg-white rounded border border-slate-200 shadow-sm",children:[y.jsxs("div",{className:"flex justify-between items-start mb-3",children:[y.jsxs("div",{children:[y.jsx("div",{className:"text-xs text-slate-400 font-bold uppercase mb-0.5",children:new Date(M.createdAt).toLocaleDateString()}),y.jsx("div",{className:"font-bold text-slate-900 text-sm",children:M.managerName})]}),y.jsxs("div",{className:"text-right",children:[y.jsx("span",{className:`text-xl font-black ${M.grade>="D"?"text-red-600":"text-slate-900"}`,children:M.grade}),y.jsxs("span",{className:"block text-[10px] font-bold text-slate-500",children:[M.percentage,"%"]})]})]}),y.jsxs("p",{className:"text-sm text-slate-600 italic border-l-2 border-indigo-100 pl-3",children:['"',M.comment,'"']})]},R))]}),(e==null?void 0:e.id)===r.authorId&&(r.status===oe.NEEDS_REVISION||r.status===oe.REJECTED)&&y.jsx(xe,{onClick:()=>n("/submit",{state:{idea:r}}),className:"w-full mt-4",children:"Edit & Resubmit"})]})})]})]})},sJ=()=>{const{user:t}=ds(),e=or(),[n,r]=O.useState([]),[i,s]=O.useState([]),[o,a]=O.useState([]),[l,u]=O.useState(!0);O.useEffect(()=>{(async()=>{if(t){u(!0);const _=await Ma();t.role===we.EMPLOYEE?r(_.filter(E=>E.authorId===t.id)):(s(_.filter(E=>E.status===oe.SUBMITTED)),a(_.filter(E=>E.status!==oe.SUBMITTED&&E.status!==oe.DRAFT))),u(!1)}})()},[t]);const d=async m=>{if(window.confirm("Are you sure you want to delete this protocol?")){await Mz(m);const _=await Ma();(t==null?void 0:t.role)===we.EMPLOYEE?r(_.filter(E=>E.authorId===t.id)):(s(_.filter(E=>E.status===oe.SUBMITTED)),a(_.filter(E=>E.status!==oe.SUBMITTED&&E.status!==oe.DRAFT)))}},p=({ideas:m,emptyMsg:_})=>m.length===0?y.jsx("div",{className:"py-12 text-center bg-white border border-slate-200 rounded-xl text-slate-400 text-sm font-bold uppercase tracking-wide",children:_}):y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(E=>y.jsxs(ft,{className:"flex flex-col h-full relative group hover:border-blue-400 transition-colors cursor-pointer",onClick:()=>e(`/view/${E.id}`),children:[y.jsxs("div",{className:"p-6 flex-1",children:[y.jsxs("div",{className:"flex justify-between items-start mb-4",children:[y.jsx(Zi,{color:E.status===oe.PUBLISHED?"green":E.status===oe.APPROVED?"blue":E.status===oe.REJECTED?"red":E.status===oe.SUBMITTED?"blue":"amber",children:E.status}),y.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:new Date(E.createdAt).toLocaleDateString()})]}),y.jsx("h3",{className:"font-bold text-lg text-slate-900 mb-2 leading-tight",children:E.title}),y.jsx("p",{className:"text-sm text-slate-500 line-clamp-3 mb-4",children:E.description}),y.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400 font-bold uppercase",children:[y.jsx("span",{children:E.authorName}),y.jsx("span",{children:""}),y.jsx("span",{children:E.department})]})]}),((t==null?void 0:t.id)===E.authorId||(t==null?void 0:t.role)===we.ADMIN)&&y.jsxs("div",{className:"px-6 py-3 bg-slate-50 border-t border-slate-100 flex justify-end items-center gap-3 rounded-b-lg",onClick:C=>C.stopPropagation(),children:[y.jsx("button",{onClick:()=>e("/submit",{state:{idea:E}}),className:"text-slate-400 hover:text-blue-600 p-1",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),y.jsx("button",{onClick:()=>d(E.id),className:"text-slate-400 hover:text-red-600 p-1",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},E.id))});return l?y.jsx("div",{className:"max-w-7xl mx-auto px-4 py-24 text-center text-slate-400",children:"Syncing with HQ..."}):y.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-24 fade-in",children:[y.jsxs("div",{className:"flex justify-between items-end mb-10 border-b border-slate-200 pb-6",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-3xl font-bold text-slate-900 uppercase tracking-tight",children:"Mission Control"}),y.jsxs("p",{className:"text-slate-500 font-medium text-sm mt-1",children:["Welcome back, ",y.jsx("span",{className:"text-slate-900 font-bold",children:t==null?void 0:t.username}),"."]})]}),(t==null?void 0:t.role)===we.EMPLOYEE&&y.jsx(wi,{to:"/submit",children:y.jsx(xe,{className:"shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all",children:"+ Initialize Protocol"})})]}),(t==null?void 0:t.role)===we.EMPLOYEE?y.jsxs(y.Fragment,{children:[y.jsx("h2",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6",children:"My Protocols"}),y.jsx(p,{ideas:n,emptyMsg:"No active protocols found. Initialize one to get started."})]}):y.jsxs("div",{className:"space-y-16",children:[y.jsxs("section",{children:[y.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[y.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-pulse"}),y.jsx("h2",{className:"text-sm font-bold text-indigo-900 uppercase tracking-widest",children:"Pending Review Queue"}),y.jsxs(Zi,{color:"blue",children:[i.length," Pending"]})]}),y.jsx(p,{ideas:i,emptyMsg:"Review queue clear. Good job!"})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-200 pb-2",children:"Innovation Registry"}),y.jsx(p,{ideas:o,emptyMsg:"Registry is empty."})]})]})]})},oJ=()=>{const[t,e]=O.useState([]),n=or(),[r,i]=O.useState(!0);return O.useEffect(()=>{(async()=>{const o=await Ma();e(o.filter(a=>(a.status===oe.PUBLISHED||a.status===oe.APPROVED)&&(a.dynamicData.collab===!0||a.collaborationNeeded===!0))),i(!1)})()},[]),r?y.jsx("div",{className:"text-center py-24 text-slate-400",children:"Loading Collab Opportunities..."}):y.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-24",children:[y.jsx("h1",{className:"text-3xl font-bold mb-2 text-slate-900 uppercase tracking-tight",children:"Collaboration Hub"}),y.jsx("p",{className:"text-slate-500 mb-10 font-medium",children:"Join forces on these active initiatives."}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(s=>y.jsxs(ft,{className:"p-6",children:[y.jsx(Zi,{color:"blue",className:"mb-3",children:s.category}),y.jsx("h3",{className:"font-bold text-lg mb-2 text-slate-900",children:s.title}),y.jsx("p",{className:"text-sm text-slate-500 mb-6 line-clamp-3",children:s.description}),y.jsxs("div",{className:"flex justify-between items-center mt-auto pt-4 border-t border-slate-100",children:[y.jsx("span",{className:"text-xs font-bold text-slate-400",children:s.authorName}),y.jsx(xe,{variant:"secondary",className:"text-xs py-1.5 px-4 font-bold border-slate-300",onClick:()=>n("/submit",{state:{parentIdea:s}}),children:"Collaborate"})]})]},s.id))}),t.length===0&&y.jsx("div",{className:"text-center py-20 text-slate-400 bg-white border border-slate-200 rounded-lg",children:"No active collaboration requests."})]})},aJ=()=>{const[t]=jV(),e=t.get("q")||"",[n,r]=O.useState([]),{user:i}=ds(),s=or(),[o,a]=O.useState(!1);return O.useEffect(()=>{(async()=>{if(!e){r([]);return}a(!0);const u=e.toLowerCase(),p=(await Ma()).filter(m=>{var w;const _=(i==null?void 0:i.id)===m.authorId,E=m.status===oe.PUBLISHED,C=m.status===oe.APPROVED&&(m.dynamicData.collab||m.collaborationNeeded);return _||E||C||(i==null?void 0:i.role)===we.ADMIN||(i==null?void 0:i.role)===we.MANAGER||(i==null?void 0:i.role)===we.GUEST?m.title.toLowerCase().includes(u)||m.description.toLowerCase().includes(u)||m.category.toLowerCase().includes(u)||m.authorName.toLowerCase().includes(u)||((w=m.tags)==null?void 0:w.some(T=>T.toLowerCase().includes(u))):!1});r(p),a(!1)})()},[e,i]),y.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-24 min-h-screen fade-in",children:[y.jsxs("div",{className:"mb-8 border-b border-slate-200 pb-4",children:[y.jsx("h1",{className:"text-3xl font-bold text-slate-900 uppercase tracking-tight",children:"Search Results"}),y.jsxs("p",{className:"text-slate-500 text-sm mt-1 font-medium",children:["Found ",n.length,' records for "',e,'"']})]}),o?y.jsx("div",{className:"text-slate-400",children:"Searching..."}):n.length===0?y.jsx("div",{className:"text-center py-20 bg-white rounded-xl border border-slate-200 shadow-sm",children:y.jsx("p",{className:"text-slate-400 uppercase tracking-widest text-sm",children:"No matches found in the registry."})}):y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(l=>y.jsxs(ft,{className:`flex flex-col justify-between hover:border-slate-300 transition-colors cursor-pointer group relative overflow-hidden rounded-xl ${l.coverImage?"bg-slate-900 border-none":"p-6"}`,onClick:()=>s("/dashboard"),children:[l.coverImage&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"absolute inset-0 z-0 bg-slate-950",children:y.jsx("img",{src:l.coverImage,alt:"Cover",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-50"})}),y.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-t from-black via-black/80 to-transparent"})]}),y.jsxs("div",{className:`relative z-10 ${l.coverImage?"p-6":""}`,children:[y.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[y.jsx(Zi,{color:"blue",children:l.category}),y.jsx(Zi,{color:"gray",children:l.status})]}),y.jsx("h3",{className:`text-xl font-bold ${l.coverImage?"text-white drop-shadow-lg":"text-slate-800"}`,children:l.title}),y.jsx("p",{className:`text-sm line-clamp-2 mt-2 font-medium ${l.coverImage?"text-slate-300 drop-shadow-md":"text-slate-500"}`,children:l.description})]}),y.jsxs("div",{className:`mt-4 relative z-10 flex justify-between items-end ${l.coverImage?"px-6 pb-6":""}`,children:[y.jsx("div",{className:`text-xs uppercase font-bold tracking-wide ${l.coverImage,"text-slate-400"}`,children:l.authorName}),y.jsx("div",{className:`text-[10px] font-bold ${l.coverImage?"text-slate-500":"text-slate-400"}`,children:new Date(l.createdAt).toLocaleDateString()})]})]},l.id))})]})},lJ=()=>{const[t,e]=O.useState([]),{user:n}=ds(),r=or();return O.useEffect(()=>{(async()=>{const o=(await Ma()).filter(a=>a.status===oe.PUBLISHED).map(a=>{const l=a.ratings.length>0?a.ratings.reduce((u,d)=>u+d.percentage,0)/a.ratings.length:0;return{...a,avgScore:l}}).sort((a,l)=>l.avgScore-a.avgScore).slice(0,10);e(o)})()},[]),y.jsxs("div",{className:"min-h-screen bg-eprom-bg text-slate-800 pt-16",children:[y.jsxs("div",{className:"relative py-32 px-4 overflow-hidden border-b border-slate-200 bg-white",children:[y.jsx("div",{className:"absolute inset-0 bg-luxury-gradient z-0"}),y.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto text-center",children:[y.jsx(Zi,{color:"gray",className:"mb-8 inline-block bg-white/80 border-slate-200 shadow-sm text-slate-600 backdrop-blur-sm",children:"Enterprise Innovation System"}),y.jsxs("h1",{className:"text-5xl md:text-8xl font-black mb-8 tracking-tighter text-slate-900 leading-[0.9]",children:["EPROM ",y.jsx("span",{className:"text-slate-400 font-light",children:"Idea bank."})]}),y.jsx("p",{className:"text-2xl text-slate-900 max-w-2xl mx-auto mb-4 leading-relaxed font-bold tracking-tight",children:"Innovating Energy. Empowering Ideas."}),y.jsx("p",{className:"text-lg text-slate-500 max-w-3xl mx-auto mb-12 leading-relaxed font-medium",children:"EPROM Idea Bank is the innovation hub for the oil and gas sector."}),!n&&y.jsx(wi,{to:"/auth",children:y.jsx(xe,{variant:"primary",className:"text-lg px-10 py-4 rounded-full bg-slate-900 hover:bg-slate-800 border-none shadow-2xl hover:shadow-xl hover:scale-105 transition-all text-white",children:"Initialize Session"})})]})]}),y.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-20 relative z-10",children:[y.jsx("div",{className:"flex items-center mb-12 border-l-4 border-slate-900 pl-6",children:y.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight uppercase",children:"Top 10 Innovations"})}),t.length===0?y.jsx("div",{className:"text-center py-20 bg-white border border-slate-200 rounded-xl shadow-sm",children:y.jsx("div",{className:"text-slate-400 text-lg",children:"System Idle. Awaiting Innovation Inputs."})}):y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map((i,s)=>y.jsxs(ft,{className:"group relative h-[420px] overflow-hidden rounded-2xl border-none shadow-xl bg-slate-900 hover:shadow-2xl transition-all duration-500 cursor-pointer",onClick:()=>r(`/view/${i.id}`),children:[i.coverImage&&y.jsx("div",{className:"absolute inset-0 z-0 bg-slate-950",children:y.jsx("img",{src:i.coverImage,alt:"Cover",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-60"})}),y.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-t from-black via-black/90 to-transparent"}),y.jsx("div",{className:"absolute top-5 left-5 w-10 h-10 rounded-full bg-white/10 backdrop-blur-md text-white flex items-center justify-center font-bold shadow-lg border border-white/20 z-20 text-lg",children:s+1}),y.jsxs("div",{className:"absolute inset-0 z-10 p-8 flex flex-col justify-end transform transition-transform duration-300",children:[y.jsxs("div",{className:"flex justify-between items-start mb-3 transform translate-y-2 group-hover:translate-y-0 transition-transform",children:[y.jsx(Zi,{color:"blue",className:"bg-blue-500/20 text-blue-100 border-blue-500/30 backdrop-blur-md",children:i.category}),y.jsx("span",{className:"text-[10px] uppercase tracking-widest text-slate-300 font-bold",children:new Date(i.createdAt).toLocaleDateString()})]}),y.jsx("h3",{className:"text-3xl font-bold text-white mb-3 leading-none drop-shadow-xl tracking-tight",children:i.title}),y.jsx("p",{className:"text-slate-200 text-sm line-clamp-2 mb-6 font-medium drop-shadow-md opacity-90",children:i.description})]})]},i.id))})]})]})},uJ=()=>{const{login:t,user:e}=ds(),n=or(),[r,i]=O.useState(!0),[s,o]=O.useState({username:"",password:"",email:"",department:"Engineering"}),[a,l]=O.useState(""),[u,d]=O.useState(!1);O.useEffect(()=>{e&&(e.role===we.ADMIN?n("/admin"):n("/dashboard"))},[e]);const p=async m=>{m.preventDefault(),l(""),d(!0);try{r?await t(s.email,s.password)===we.ADMIN?n("/admin"):n("/dashboard"):(await Pz({username:s.username,password:s.password,email:s.email,department:s.department,role:we.EMPLOYEE}),alert("Registration successful. Please login."),i(!0))}catch(_){let E=_.message;E.includes("auth/invalid-credential")||E.includes("auth/user-not-found")||E.includes("INVALID_LOGIN_CREDENTIALS")?E="Invalid credentials. If you haven't registered yet, please switch to the 'Register' tab to create your account.":E.includes("auth/email-already-in-use")?E="Email already in use. Please login.":E.includes("auth/weak-password")&&(E="Password should be at least 6 characters."),l(E)}finally{d(!1)}};return y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 px-4",children:y.jsxs(ft,{className:"w-full max-w-md p-8",children:[y.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:r?"Login":"Register"}),a&&y.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4 text-sm font-medium",children:a}),y.jsxs("form",{onSubmit:p,children:[!r&&y.jsx(In,{label:"Username",value:s.username,onChange:m=>o({...s,username:m.target.value}),required:!0}),y.jsx(In,{label:"Email",type:"email",value:s.email,onChange:m=>o({...s,email:m.target.value}),required:!0}),y.jsx(In,{label:"Password",type:"password",value:s.password,onChange:m=>o({...s,password:m.target.value}),required:!0}),!r&&y.jsx($h,{label:"Department",options:["Operations","Safety","Engineering","IT","HR"],value:s.department,onChange:m=>o({...s,department:m.target.value}),required:!0}),y.jsx(xe,{type:"submit",disabled:u,className:"w-full mt-4",children:u?"Processing...":r?"Sign In":"Create Account"})]}),y.jsx("p",{className:"mt-4 text-center text-sm text-slate-500 cursor-pointer hover:text-eprom-blue",onClick:()=>{i(!r),l("")},children:r?"Need an account? Register":"Already have an account? Login"})]})})},cJ=()=>{var cn,Kt;const{user:t,settings:e}=ds(),n=or(),r=oo(),i=(cn=r.state)==null?void 0:cn.idea,s=(Kt=r.state)==null?void 0:Kt.parentIdea,[o,a]=O.useState((i==null?void 0:i.title)||(s?`Contribution: ${s.title}`:"")),[l,u]=O.useState((i==null?void 0:i.description)||""),[d,p]=O.useState((i==null?void 0:i.category)||"Innovation"),[m,_]=O.useState((i==null?void 0:i.templateId)||""),[E,C]=O.useState((i==null?void 0:i.dynamicData)||{}),[A,w]=O.useState((i==null?void 0:i.coverImage)||""),[T,S]=O.useState((i==null?void 0:i.attachments)||[]),[D,L]=O.useState(!1),[M,R]=O.useState(!1),[I,P]=O.useState([]),{isRecording:N,startRecording:k,stopRecording:V}=eJ(),[b,Te]=O.useState(!1),[Mt,dt]=O.useState([]);O.useEffect(()=>{(async()=>{const ue=await Qv();P(ue),!i&&ue.length>0&&_(ue[0].id),e&&dt(e.categories)})()},[i,e]);const At=async()=>{if(!l)return;Te(!0);const ee=await Z8(l);u(ee),Te(!1)},Q=async()=>{if(N){const ee=await V();if(ee){u(at=>at+`
[Processing Audio...]`);const ue=await Y8(ee.base64,ee.mimeType);u(at=>at.replace(`
[Processing Audio...]`,"")+" "+ue)}}else k()},ie=async ee=>{var ue;if((ue=ee.target.files)!=null&&ue[0]){R(!0);try{const at=await zb(ee.target.files[0]);w(at)}catch(at){alert("Image Upload Failed: "+at.message)}finally{R(!1)}}},se=async ee=>{var ue;if((ue=ee.target.files)!=null&&ue[0]){const at=ee.target.files[0];L(!0);try{const Dn=await Fz(at);S(H=>[...H,Dn]),alert("File uploaded to Drive successfully!")}catch(Dn){console.error(Dn),alert(`Upload failed: ${Dn.message||"Unknown error"}. Check console for details.`)}finally{L(!1),ee.target.value=""}}},Ce=ee=>{S(ue=>ue.filter((at,Dn)=>Dn!==ee))},Ee=async ee=>{if(ee.preventDefault(),!t)return;L(!0);const ue=I.find(H=>H.id===m);let at=(i==null?void 0:i.status)||oe.SUBMITTED;t.role===we.EMPLOYEE&&(at===oe.NEEDS_REVISION||at===oe.REJECTED||at===oe.DRAFT)&&(at=oe.SUBMITTED);const Dn={id:(i==null?void 0:i.id)||Date.now().toString(),authorId:t.id,authorName:t.username,department:t.department,createdAt:(i==null?void 0:i.createdAt)||new Date().toISOString(),updatedAt:new Date().toISOString(),title:o,description:l,category:d,coverImage:A,templateId:m,templateName:(ue==null?void 0:ue.name)||"Unknown",parentIdeaId:(s==null?void 0:s.id)||(i==null?void 0:i.parentIdeaId),dynamicData:E,tags:[],status:at,ratings:(i==null?void 0:i.ratings)||[],comments:(i==null?void 0:i.comments)||[],attachments:T,managerFeedback:i==null?void 0:i.managerFeedback};await e_(Dn),L(!1),n("/dashboard")},Pe=I.find(ee=>ee.id===m);return y.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-24 fade-in",children:[y.jsxs("div",{className:"mb-8 border-b border-slate-200 pb-4 flex justify-between items-center",children:[y.jsx("div",{children:y.jsx("h1",{className:"text-3xl font-bold text-slate-900 uppercase tracking-tight",children:i?"Refine Protocol":s?"Collaborate on Protocol":"Initialize Protocol"})}),y.jsx(xe,{variant:"ghost",onClick:()=>n(-1),className:"text-xs uppercase",children:"Cancel"})]}),y.jsxs("form",{onSubmit:Ee,className:"space-y-8",children:[y.jsxs(ft,{className:"p-8 border-none shadow-lg",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-100 pb-2",children:"01 // Core Intelligence"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[y.jsx(In,{label:"Protocol Title",value:o,onChange:ee=>a(ee.target.value),required:!0,placeholder:"e.g. Flare Gas Recovery"}),y.jsx($h,{label:"Category",options:Mt,value:d,onChange:ee=>p(ee.target.value),required:!0})]}),y.jsxs("div",{className:"mb-6 relative",children:[y.jsxs("div",{className:"flex justify-between items-end mb-1.5",children:[y.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Technical Description"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("button",{type:"button",onClick:At,disabled:b,className:"text-[10px] font-bold uppercase text-indigo-500 hover:text-indigo-700 disabled:opacity-50 flex items-center gap-1",children:[b?y.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-ping"}):""," AI Enhance"]}),y.jsxs("button",{type:"button",onClick:Q,className:`text-[10px] font-bold uppercase flex items-center gap-1 ${N?"text-red-600 animate-pulse":"text-slate-400 hover:text-slate-900"}`,children:[y.jsx("span",{className:`w-2 h-2 rounded-full ${N?"bg-red-600":"bg-slate-400"}`})," ",N?"Stop Rec":"Dictate"]})]})]}),y.jsx("textarea",{className:"w-full px-4 py-3 bg-slate-50/50 border border-slate-300 rounded text-slate-900 placeholder-slate-400 focus:outline-none focus:border-eprom-blue focus:ring-1 focus:ring-eprom-blue transition-all min-h-[160px] text-sm leading-relaxed",value:l,onChange:ee=>u(ee.target.value),required:!0,placeholder:"Describe the operational challenge and proposed solution..."})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-2 uppercase tracking-wide",children:"Visual Reference (Cover)"}),y.jsxs("div",{className:"flex items-start gap-6",children:[y.jsxs("label",{className:"flex-shrink-0 cursor-pointer bg-slate-100 hover:bg-slate-200 text-slate-600 px-4 py-3 rounded text-xs font-bold uppercase transition-colors border border-slate-200 hover:border-slate-300 flex flex-col items-center justify-center w-32 h-32",children:[y.jsx("span",{children:M?"...":"Select Img"}),y.jsx("input",{type:"file",accept:"image/*",onChange:ie,disabled:M,className:"hidden"})]}),A?y.jsxs("div",{className:"h-32 w-full flex-1 overflow-hidden rounded border border-slate-200 bg-slate-50 relative group",children:[y.jsx("img",{src:A,className:"w-full h-full object-cover",alt:"Cover"}),y.jsx("button",{type:"button",onClick:()=>w(""),className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs uppercase font-bold",children:"Remove"})]}):y.jsx("div",{className:"h-32 w-full flex-1 rounded border border-dashed border-slate-300 bg-slate-50 flex items-center justify-center text-slate-400 text-xs",children:"No Image Selected"})]})]})]}),Pe&&y.jsxs(ft,{className:"p-8 border-none shadow-lg",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-100 pb-2",children:"02 // Specific Data"}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Pe.fields.map(ee=>y.jsx("div",{className:ee.type==="textarea"?"col-span-1 md:col-span-2":"",children:ee.type==="textarea"?y.jsx(Fk,{label:ee.label,required:ee.required,value:E[ee.id]||"",onChange:ue=>C({...E,[ee.id]:ue.target.value})}):ee.type==="select"&&ee.options?y.jsx($h,{label:ee.label,options:ee.options,required:ee.required,value:E[ee.id]||"",onChange:ue=>C({...E,[ee.id]:ue.target.value})}):ee.type==="checkbox"?y.jsx("div",{className:"flex items-center h-full pt-6",children:y.jsxs("label",{className:"flex items-center cursor-pointer",children:[y.jsx("input",{type:"checkbox",checked:!!E[ee.id],onChange:ue=>C({...E,[ee.id]:ue.target.checked}),className:"form-checkbox h-5 w-5 text-eprom-blue rounded border-slate-300"}),y.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:ee.label})]})}):y.jsx(In,{label:ee.label,type:ee.type,required:ee.required,value:E[ee.id]||"",onChange:ue=>C({...E,[ee.id]:ue.target.value})})},ee.id))})]}),y.jsxs(ft,{className:"p-8 border-none shadow-lg",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 border-b border-slate-100 pb-2",children:"03 // Supporting Documents (Drive)"}),y.jsx("div",{className:"mb-4",children:y.jsxs("label",{className:"flex items-center justify-center w-full h-24 px-4 transition bg-white border-2 border-slate-300 border-dashed rounded-md appearance-none cursor-pointer hover:border-slate-400 focus:outline-none bg-slate-50 hover:bg-slate-100",children:[y.jsx("span",{className:"flex items-center space-x-2 text-slate-500",children:D?y.jsx("span",{className:"flex items-center gap-2 text-sm font-bold animate-pulse",children:"Uploading to Drive..."}):y.jsx("span",{className:"text-xs font-bold uppercase",children:"Upload to Google Drive"})}),y.jsx("input",{type:"file",name:"file_upload",className:"hidden",disabled:D,onChange:se})]})}),T.length>0&&y.jsx("div",{className:"grid grid-cols-1 gap-2",children:T.map((ee,ue)=>y.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 border border-blue-100 rounded text-sm text-blue-800",children:[y.jsxs("a",{href:ee,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 hover:underline truncate max-w-[80%]",children:["Attachment ",ue+1]}),y.jsx("button",{type:"button",onClick:()=>Ce(ue),className:"text-red-500 hover:text-red-700 text-xs font-bold uppercase",children:"Remove"})]},ue))})]}),y.jsx("div",{className:"flex justify-end gap-4 pt-4",children:y.jsx(xe,{type:"submit",disabled:D||M,className:"px-12 py-4 shadow-xl bg-slate-900 hover:bg-slate-800 text-white font-bold tracking-widest text-sm",children:D?"Processing...":i&&(i.status===oe.NEEDS_REVISION||i.status===oe.REJECTED)?"Resubmit Protocol":"Launch Protocol"})})]})]})},dJ=({u:t,onApprove:e,onReject:n,onDelete:r})=>{const[i,s]=O.useState(we.EMPLOYEE);return y.jsxs("tr",{className:"hover:bg-amber-50 transition-colors bg-amber-50 border-l-4 border-amber-400",children:[y.jsx("td",{className:"px-6 py-4 font-bold text-slate-800",children:t.username}),y.jsx("td",{className:"px-6 py-4 text-slate-600",children:t.email}),y.jsx("td",{className:"px-6 py-4 text-slate-600",children:t.department}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("select",{value:i,onChange:o=>s(o.target.value),className:"bg-white border border-slate-300 text-slate-800 text-xs rounded p-1",children:[y.jsx("option",{value:we.EMPLOYEE,children:"Employee"}),y.jsx("option",{value:we.MANAGER,children:"Manager"}),y.jsx("option",{value:we.ADMIN,children:"Admin"}),y.jsx("option",{value:we.GUEST,children:"Guest"})]})}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{className:"flex space-x-2",children:[y.jsx(xe,{variant:"ghost",onClick:()=>e(t.id,i),className:"text-green-600 hover:text-green-700 text-xs px-2 py-1 uppercase font-bold",children:"Approve"}),y.jsx(xe,{variant:"ghost",onClick:()=>n(t.id),className:"text-red-600 hover:text-red-700 text-xs px-2 py-1 uppercase font-bold",children:"Reject"}),y.jsx(xe,{variant:"ghost",onClick:()=>r(t.id),className:"text-red-600 hover:text-red-700 text-xs px-2 py-1 uppercase font-bold",children:"Delete"})]})})]})},hJ=()=>{const{settings:t,refreshSettings:e}=ds(),[n,r]=O.useState([]),[i,s]=O.useState([]),[o,a]=O.useState("users"),[l,u]=O.useState(!1),[d,p]=O.useState(""),[m,_]=O.useState(""),[E,C]=O.useState(null),[A,w]=O.useState(""),[T,S]=O.useState(""),[D,L]=O.useState([]),[M,R]=O.useState({}),I=[{id:"impact",name:"Impact on Business Goals",description:"Reduces cost, increases revenue, improves safety.",weight:30},{id:"feasibility",name:"Feasibility",description:"Ease of implementation (resources, time).",weight:20},{id:"roi",name:"Cost vs. Benefit",description:"Estimated cost compared to expected benefits.",weight:20},{id:"innovation",name:"Innovation Level",description:"New approach vs incremental improvement.",weight:15},{id:"risk",name:"Risk Level",description:"Operational, financial, or safety risks (High Score = Low Risk).",weight:15}],[P,N]=O.useState(I),[k,V]=O.useState({});O.useEffect(()=>{b()},[]);const b=async()=>{r(await bz()),s(await Qv())},Te=async(H,Ue)=>{await RI(H,Or.ACTIVE,Ue),b()},Mt=async H=>{await RI(H,Or.REJECTED),b()},dt=async H=>{confirm("Are you sure? This cannot be undone.")&&(await Dz(H),b())},At=async(H,Ue)=>{await kz(H,Ue),b()},Q=async()=>{d&&t&&(await gm({...t,categories:[...t.categories,d]}),e(),p(""))},ie=async()=>{m&&t&&(await gm({...t,departments:[...t.departments,m]}),e(),_(""))},se=async H=>{if(H.target.files&&H.target.files[0]&&t){u(!0);try{const Ue=H.target.files[0],go=await zb(Ue);await gm({...t,logoUrl:go}),e(),alert("Logo updated successfully!")}catch(Ue){alert("Logo upload failed: "+Ue.message)}finally{u(!1)}}},Ce=()=>{if(!M.label||!M.type)return;const H={id:M.label.toLowerCase().replace(/\s+/g,"_")+"_"+Date.now(),label:M.label,type:M.type,required:M.required||!1,options:M.options?M.options.split(","):void 0};L([...D,H]),R({})},Ee=()=>{if(!k.name||!k.weight)return;const H={id:(k.name.toLowerCase().replace(/\s+/g,"_")+"_"+Date.now()).substring(0,15),name:k.name,description:k.description||"",weight:Number(k.weight)};N([...P,H]),V({})},Pe=H=>{N(P.filter(Ue=>Ue.id!==H))},cn=()=>N(I),Kt=P.reduce((H,Ue)=>H+Ue.weight,0),ee=H=>{C(H.id),w(H.name),S(H.description),L(H.fields),N(H.ratingConfig||[]),window.scrollTo({top:0,behavior:"smooth"})},ue=()=>{C(null),w(""),S(""),L([]),N(I)},at=async()=>{if(!A||D.length===0)return;const H={id:E||Date.now().toString(),name:A,description:T,fields:D,ratingConfig:P,isActive:!0};await Lz(H),ue(),b()},Dn=async H=>{confirm("Are you sure?")&&(await Uz(H),b())};return t?y.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-24 fade-in",children:[y.jsxs("div",{className:"flex items-center justify-between mb-8",children:[y.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Control Room"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),y.jsx("span",{className:"text-xs font-bold text-red-500 uppercase tracking-widest",children:"Admin Privileges Active"})]})]}),y.jsxs("div",{className:"flex space-x-8 mb-10 border-b border-slate-200",children:[y.jsxs("button",{onClick:()=>a("users"),className:`pb-4 px-1 font-bold text-sm uppercase tracking-wider transition-all relative ${o==="users"?"text-slate-900":"text-slate-400 hover:text-slate-600"}`,children:["Personnel ",o==="users"&&y.jsx("span",{className:"absolute bottom-0 left-0 w-full h-[3px] bg-slate-900"})]}),y.jsxs("button",{onClick:()=>a("forms"),className:`pb-4 px-1 font-bold text-sm uppercase tracking-wider transition-all relative ${o==="forms"?"text-slate-900":"text-slate-400 hover:text-slate-600"}`,children:["Protocol Builder ",o==="forms"&&y.jsx("span",{className:"absolute bottom-0 left-0 w-full h-[3px] bg-slate-900"})]}),y.jsxs("button",{onClick:()=>a("settings"),className:`pb-4 px-1 font-bold text-sm uppercase tracking-wider transition-all relative ${o==="settings"?"text-slate-900":"text-slate-400 hover:text-slate-600"}`,children:["System Config ",o==="settings"&&y.jsx("span",{className:"absolute bottom-0 left-0 w-full h-[3px] bg-slate-900"})]})]}),o==="users"&&y.jsx(ft,{className:"overflow-hidden border-none shadow-lg",children:y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-left text-sm text-slate-600",children:[y.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 uppercase text-xs font-bold text-slate-500 tracking-wider",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-6 py-4",children:"Username"}),y.jsx("th",{className:"px-6 py-4",children:"Email"}),y.jsx("th",{className:"px-6 py-4",children:"Department"}),y.jsx("th",{className:"px-6 py-4",children:"Role"}),y.jsx("th",{className:"px-6 py-4",children:"Status"})]})}),y.jsxs("tbody",{className:"divide-y divide-slate-100",children:[n.filter(H=>H.status===Or.PENDING).map(H=>y.jsx(dJ,{u:H,onApprove:Te,onReject:Mt,onDelete:dt},H.id)),n.filter(H=>H.status===Or.ACTIVE).map(H=>y.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[y.jsx("td",{className:"px-6 py-4 font-bold text-slate-800",children:H.username}),y.jsx("td",{className:"px-6 py-4",children:H.email}),y.jsx("td",{className:"px-6 py-4",children:H.department}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("select",{value:H.role,onChange:Ue=>At(H.id,Ue.target.value),className:"bg-transparent border border-slate-200 rounded p-1 text-slate-700 focus:bg-white focus:border-slate-900 text-xs uppercase font-bold",children:[y.jsx("option",{value:we.EMPLOYEE,children:"Employee"}),y.jsx("option",{value:we.MANAGER,children:"Manager"}),y.jsx("option",{value:we.ADMIN,children:"Admin"}),y.jsx("option",{value:we.GUEST,children:"Guest"})]})}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),y.jsx("span",{className:"text-xs font-bold text-green-600 uppercase",children:"Active"})]})})]},H.id))]})]})})}),o==="forms"&&y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[y.jsx("div",{className:"lg:col-span-1 space-y-6",children:y.jsxs(ft,{className:"p-6",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest mb-4",children:"Template Manager"}),y.jsxs("div",{className:"space-y-3",children:[i.map(H=>{var Ue;return y.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-50 border border-slate-200 rounded hover:border-slate-300",children:[y.jsxs("div",{children:[y.jsx("div",{className:"text-xs font-bold text-slate-800",children:H.name}),y.jsxs("div",{className:"text-[10px] text-slate-500",children:[H.fields.length," fields  ",((Ue=H.ratingConfig)==null?void 0:Ue.length)||0," KPIs"]})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>ee(H),className:"text-blue-600 text-xs font-bold uppercase",children:"Edit"}),y.jsx("button",{onClick:()=>Dn(H.id),className:"text-red-600 text-xs font-bold uppercase",children:"Del"})]})]},H.id)}),y.jsx(xe,{onClick:()=>{C(null),w(""),S(""),L([]),N(I)},className:"w-full mt-4 text-xs",children:"New Template"})]})]})}),y.jsx("div",{className:"lg:col-span-2 space-y-8",children:y.jsxs(ft,{className:"p-8",children:[y.jsxs("div",{className:"flex justify-between items-start mb-6",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest",children:E?"Edit Protocol Template":"Create Protocol Template"}),E&&y.jsx(xe,{variant:"ghost",onClick:ue,className:"text-xs text-red-500",children:"Cancel Edit"})]}),y.jsxs("div",{className:"space-y-4 mb-8",children:[y.jsx(In,{label:"Template Name",value:A,onChange:H=>w(H.target.value),placeholder:"e.g. Safety Incident Report"}),y.jsx(Fk,{label:"Description",value:T,onChange:H=>S(H.target.value),placeholder:"Purpose of this form..."})]}),y.jsxs("div",{className:"mb-8 border-t border-slate-100 pt-6",children:[y.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:"Form Fields Schema"}),y.jsx("div",{className:"space-y-3 mb-4",children:D.map((H,Ue)=>y.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 border border-slate-200 rounded",children:[y.jsx("span",{className:"text-[10px] font-mono text-slate-400 bg-white border border-slate-200 px-1 rounded",children:H.type}),y.jsx("span",{className:"text-sm font-bold text-slate-700 flex-1",children:H.label}),H.required&&y.jsx("span",{className:"text-[10px] text-red-500 font-bold uppercase",children:"Req"}),y.jsx("button",{onClick:()=>L(D.filter((go,tl)=>tl!==Ue)),className:"text-slate-400 hover:text-red-500",children:""})]},Ue))}),y.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end bg-slate-50 p-4 rounded border border-slate-200",children:[y.jsx("div",{className:"col-span-4",children:y.jsx(In,{label:"Label",value:M.label||"",onChange:H=>R({...M,label:H.target.value}),className:"mb-0"})}),y.jsx("div",{className:"col-span-3",children:y.jsx($h,{label:"Type",options:["text","textarea","number","select","checkbox","date"],value:M.type||"",onChange:H=>R({...M,type:H.target.value}),className:"mb-0"})}),y.jsx("div",{className:"col-span-2 flex items-center h-[42px]",children:y.jsxs("label",{className:"flex items-center",children:[y.jsx("input",{type:"checkbox",checked:M.required||!1,onChange:H=>R({...M,required:H.target.checked}),className:"mr-2"})," ",y.jsx("span",{className:"text-xs font-bold uppercase text-slate-500",children:"Req"})]})}),y.jsx("div",{className:"col-span-3",children:y.jsx(xe,{onClick:Ce,className:"w-full text-xs",children:"Add Field"})}),M.type==="select"&&y.jsx("div",{className:"col-span-12 mt-3",children:y.jsx(In,{label:"Options (comma separated)",value:M.options||"",onChange:H=>R({...M,options:H.target.value}),className:"mb-0"})})]})]}),y.jsxs("div",{className:"mb-8 border-t border-slate-100 pt-6",children:[y.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:"Evaluation KPIs"}),y.jsxs("div",{className:"space-y-3 mb-4",children:[P.map(H=>y.jsxs("div",{className:"flex justify-between items-center p-3 bg-indigo-50 border border-indigo-100 rounded text-indigo-900",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"text-xs font-bold",children:[H.name," ",y.jsxs("span",{className:"opacity-50",children:["(",H.weight,"%)"]})]}),y.jsx("div",{className:"text-[10px] opacity-75",children:H.description})]}),y.jsx("button",{onClick:()=>Pe(H.id),className:"text-indigo-400 hover:text-indigo-700",children:""})]},H.id)),y.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-slate-500 pt-2",children:[y.jsxs("span",{children:["Total Weight: ",Kt,"%"]}),Kt!==100&&y.jsx("span",{className:"text-red-500",children:"Warning: Should equal 100%"})]})]}),y.jsxs("div",{className:"grid grid-cols-12 gap-3 items-end bg-slate-50 p-4 rounded border border-slate-200",children:[y.jsx("div",{className:"col-span-4",children:y.jsx(In,{label:"KPI Name",value:k.name||"",onChange:H=>V({...k,name:H.target.value}),className:"mb-0"})}),y.jsx("div",{className:"col-span-2",children:y.jsx(In,{label:"Weight %",type:"number",value:k.weight||"",onChange:H=>V({...k,weight:Number(H.target.value)}),className:"mb-0"})}),y.jsx("div",{className:"col-span-4",children:y.jsx(In,{label:"Description",value:k.description||"",onChange:H=>V({...k,description:H.target.value}),className:"mb-0"})}),y.jsx("div",{className:"col-span-2",children:y.jsx(xe,{onClick:Ee,className:"w-full text-xs",children:"Add"})})]}),y.jsx("div",{className:"mt-2 text-right",children:y.jsx("button",{onClick:cn,className:"text-[10px] font-bold uppercase text-slate-400 hover:text-slate-600 underline",children:"Reset to Default KPIs"})})]}),y.jsx(xe,{onClick:at,className:"w-full py-4 text-sm tracking-widest",children:"Save Protocol Template"})]})})]}),o==="settings"&&y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs(ft,{className:"p-8",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest mb-6",children:"Departments"}),y.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:t.departments.map(H=>y.jsx("span",{className:"px-3 py-1 bg-slate-100 text-slate-600 rounded-full text-xs font-bold",children:H},H))}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(In,{value:m,onChange:H=>_(H.target.value),placeholder:"New Department",className:"flex-1 mb-0"}),y.jsx(xe,{onClick:ie,children:"Add"})]})]}),y.jsxs(ft,{className:"p-8",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest mb-6",children:"Categories"}),y.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:t.categories.map(H=>y.jsx("span",{className:"px-3 py-1 bg-slate-100 text-slate-600 rounded-full text-xs font-bold",children:H},H))}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(In,{value:d,onChange:H=>p(H.target.value),placeholder:"New Category",className:"flex-1 mb-0"}),y.jsx(xe,{onClick:Q,children:"Add"})]})]}),y.jsxs(ft,{className:"p-8 md:col-span-2",children:[y.jsx("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest mb-6",children:"Branding"}),y.jsxs("div",{className:"flex items-center gap-6",children:[t.logoUrl?y.jsx("img",{src:t.logoUrl,className:"h-16 w-auto",alt:"Logo"}):y.jsx("div",{className:"h-16 w-16 bg-slate-200 rounded flex items-center justify-center text-slate-400 font-bold",children:"LOGO"}),y.jsxs("div",{children:[y.jsx("label",{className:`block text-xs font-bold uppercase mb-2 ${l?"text-blue-500 animate-pulse":"text-slate-500"}`,children:l?"Uploading to Firebase...":"Upload Company Logo"}),y.jsx("input",{type:"file",accept:"image/*",onChange:se,disabled:l,className:"text-sm text-slate-500 disabled:opacity-50"})]})]})]})]})]}):null},fJ=()=>y.jsx(zV,{children:y.jsx(rJ,{children:y.jsxs("div",{className:"min-h-screen bg-eprom-bg text-slate-800 font-sans selection:bg-eprom-blue selection:text-white pb-20",children:[y.jsx(tJ,{}),y.jsxs(UV,{children:[y.jsx(ur,{path:"/",element:y.jsx(lJ,{})}),y.jsx(ur,{path:"/auth",element:y.jsx(uJ,{})}),y.jsx(ur,{path:"/dashboard",element:y.jsx(sJ,{})}),y.jsx(ur,{path:"/submit",element:y.jsx(cJ,{})}),y.jsx(ur,{path:"/view/:id",element:y.jsx(iJ,{})}),y.jsx(ur,{path:"/admin",element:y.jsx(hJ,{})}),y.jsx(ur,{path:"/collaboration",element:y.jsx(oJ,{})}),y.jsx(ur,{path:"/search",element:y.jsx(aJ,{})}),y.jsx(ur,{path:"*",element:y.jsx(PR,{to:"/",replace:!0})})]})]})})}),Bk=document.getElementById("root");if(!Bk)throw new Error("Could not find root element to mount to");const pJ=vm.createRoot(Bk);pJ.render(y.jsx(_A.StrictMode,{children:y.jsx(fJ,{})}));
